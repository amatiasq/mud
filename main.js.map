{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/lib/util/concatRegexes.ts","webpack:///./src/lib/util/wait.ts","webpack:///./src/lib/util/int.ts","webpack:///./src/data/spells.ts","webpack:///./src/data/mobs.ts","webpack:///./src/data/items.ts","webpack:///./src/ui/index.css","webpack:///./src/lib/util/singleExecution.ts","webpack:///./src/lib/triggers/PatternPromise.ts","webpack:///./src/plugins/promptPlugin.ts","webpack:///./src/lib/context/BasicContextCreator.ts","webpack:///./src/data/areas.ts","webpack:///./src/index.ts","webpack:///./src/lib/Mud.ts","webpack:///./src/plugins/index.ts","webpack:///./src/plugins/chatPlugin.ts","webpack:///./src/lib/util/dateTime.ts","webpack:///./src/lib/util/requestNotificationPermission.ts","webpack:///./src/plugins/inventoryPlugin.ts","webpack:///./src/plugins/navigationPlugin.ts","webpack:///./src/plugins/skillsPlugin.ts","webpack:///./src/data/skills.json.ts","webpack:///./src/plugins/statsPlugin.ts","webpack:///./src/plugins/login.ts","webpack:///./src/lib/context/WorkflowContextCreator.ts","webpack:///./src/lib/triggers/TriggerCollection.ts","webpack:///./src/lib/triggers/PatternMatcher.ts","webpack:///./src/lib/util/trimEnd.ts","webpack:///./src/lib/triggers/PatternResult.ts","webpack:///./src/lib/workflow/Workflow.ts","webpack:///./src/lib/util/CancellablePromise.ts","webpack:///./src/lib/RemoteTelnet.ts","webpack:///./src/lib/audio.ts","webpack:///./src/registerWorkflows.ts","webpack:///./src/daemons/code.ts","webpack:///./src/daemons/defend.ts","webpack:///./src/daemons/dope.ts","webpack:///./src/util/uniq.ts","webpack:///./src/daemons/drink.ts","webpack:///./src/daemons/eat.ts","webpack:///./src/daemons/idle.ts","webpack:///./src/daemons/quest.ts","webpack:///./src/daemons/repair.ts","webpack:///./src/daemons/rest.ts","webpack:///./src/daemons/shop.ts","webpack:///./src/workflows/afk.ts","webpack:///./src/workflows/bank.ts","webpack:///./src/workflows/cast.ts","webpack:///./src/workflows/donations.ts","webpack:///./src/workflows/go.ts","webpack:///./src/data/areas.json.ts","webpack:///./src/workflows/kill.ts","webpack:///./src/workflows/recover.ts","webpack:///./src/workflows/train.ts","webpack:///./src/workflows/wear.ts","webpack:///./src/ui/index.ts","webpack:///./src/ui/index.css?3ef0","webpack:///./src/ui/Controls.ts","webpack:///./src/ui/Hamburger.ts","webpack:///./src/ui/Sidebar.ts","webpack:///./src/ui/Terminal.ts","webpack:///./src/util/getPassword.ts","webpack:///./src/util/getQueryParams.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","createConcatenator","escape","regexes","join","map","x","RegExp","toString","replace","flags","filter","Boolean","uniq","Set","escapeRegExp","concatRegexes","concatRegexesUnescaped","String","seconds","Promise","resolve","setTimeout","NUMBER","parseInt","languageList","type","skillList","spellList","weaponList","effectDuration","int","effectProp","prop","metadata","armadura","success","target","end","effect","bendecir","ceguera","flotar","identificar","invisibilidad","polimorfar","refrescar","terremoto","veneno","volar","spells","SPELL_FAILED","SPELL_ALREADY_APPLIED","SPELL_NOT_POSSIBLE","SPELLS_BY_TYPE","food","water","movement","heal","invisibility","massAttack","attack","attackAlternative","dedope","pet","SPELL_LEARN_ORDER","lower","toLowerCase","base","find","startsWith","Error","meta","MOB_ARTICLE","MOB_NAME","ALLIES","MOBS","entries","Kivon","Nejane","adorador","aguila","buitre","calamar","caracol","ciervo","conejo","criatura","cubo","cultista","dragon","empleado","engendro","espiritu","esqueleto","fanatico","gusano","hobgoblin","gnoll","goblin","guardia","guerrero","jefe","ladron","lobo","mago","merodeador","murcielago","ogro","orco","pantera","piranya","rata","sapo","serpiente","troll","zombie","presence","ATTACK_RECEIVED","MOB_ARRIVES","MOB_LEAVES","MOB_DIES","flat","patterns","Array","isArray","some","includes","text","console","warn","ITEM_ARTICLE","WEAR","UNWEAR","ITEM_SUSTANTIVES","item","found","___CSS_LOADER_EXPORT___","fn","running","then","executor","_reject","super","reject","this","forceReject","catch","wait","race","PROMPT","FPROMPT","captureProgress","PROMPT_DETECTOR","Stat","total","current","Math","round","async","when","write","isInvisible","stats","hp","mana","mv","exp","gold","enemy","update","emitter","timeout","finally","groups","g","toInt","hpCurr","hpTotal","mCurr","mTotal","mvCurr","mvTotal","invis","getPercent","stat","percent","getValue","until","whenFresh","log","onUpdate","subscribe","isFighting","predicate","unsubscribe","triggers","send","dispositions","Map","emitInstanceAborted","onInstanceAborted","emitInstanceDisposed","onInstanceDisposed","checkNotAborted","dispose","subscriptions","isPrintingLogs","isAborted","context","onDispose","pattern","handler","options","onResult","rest","original","subscription","add","promise","sleep","abort","command","forEach","set","args","delete","ARENAS","getWithMetadata","area","arena","realm","level","from","to","sort","a","b","areaName","first","candidates","toLocaleLowerCase","serverUri","location","origin","DEFAULT_PORT","host","port","user","pass","server","getQueryParams","split","getPassword","getParams","terminal","controls","sidebar","renderUserInterface","document","body","socket","WebSocket","addEventListener","telnet","RemoteTelnet","connect","mud","Mud","onCommand","onData","onSubmit","onUserInput","onbeforeunload","isConnected","close","registerHandler","workflow","runWorkflow","trigger","action","permanent","trim","run","daemon","printLogs","runOnce","login","connectButtons","registerWorkflows","connectStats","userInput","addMeter","getPlugin","onWorkflowsChange","workflows","setWorkflows","cmd","getWorkflow","execute","message","assign","initializeMud","openSocket","event","error","reason","preventDefault","TriggerCollection","contextCreator","BasicContextCreator","handlers","emitCommand","emitWorkflowsChange","whenLoggedIn","emitLoggedIn","process","stored","match","substr","removeAsciiCodes","createInstance","plugins","initializePlugins","password","repeat","id","identifier","runForever","Workflow","createContextCreator","values","workflowOrName","has","WorkflowContextCreator","chat","chatPlugin","inventory","inventoryPlugin","navigation","navigationPlugin","prompt","promptPlugin","skills","skillsPlugin","statsPlugin","promises","plugin","all","fromEntries","beepAudio","Audio","version","receive","addMessage","notify","sent","content","play","requestNotificationPermission","Notification","partial","datetime","Date","order","ClientStorage","tell","whisper","receiveTell","tokens","re","response","token","test","handleAutoResponses","pad","val","date","getFullYear","getMonth","getDate","getHours","getMinutes","permission","requestPermission","CONTENT","INVENTORY_DETECTOR","ITEM_AMOUNT","ITEM_MATCHER","isInitialized","items","refresh","singleExecution","parseItems","captureLength","search","searchInList","hasIn","hasInBackpack","container","any","captured","list","effects","amount","keys","CLOSED","aliases","e","w","u","k","h","recalls","isNavigating","landingAtRecall","isAtRecall","directions","roomChanged","closed","dir","canGo","go","callback","recall","untilEnd","done","step","path","_","times","toUpperCase","move","getRealm","waitForRecall","PatternPromise","onRoomChange","direction","isClosed","NOT_AVAILABLE","undefined","BUSY","FAILED","CASTED","SKILL","SKILLS_DETECTOR","isSpellRunning","isMeditating","skill","matchAll","can","canLearn","ensureInitiated","castSpell","meditate","waitResponse","reverse","minLevel","ALREADY_APPLIED","hasSync","getSpell","learnt","spell","minPos","SIZE","STATE_DETECTOR","low","DASH","SPACE","PIPE","row","isInitiated","principal","fue","fueBase","des","desBase","vida","vidaBase","vidaRegen","intBase","sab","sabBase","manaBase","manaRegen","con","conBase","car","carBase","mov","movBase","movRegen","sue","sueBase","username","initialize","await","once","register","children","finish","pluginsGetter","isRunning","params","execution","fromExecution","cancel","source","Proxy","queue","isProcessing","arguments","watch","entry","PatternMatcher","sub","splitted","last","pop","lines","line","_isEnabled","max","buffer","clear","trimEnd","matching","testPattern","PatternResult","output","indexOf","maxLength","isRegex","merge","haystack","stringPatterns","reduce","executions","executionCount","emitChange","onChange","size","iteration","CancellablePromise","onCancel","emitCancel","isPending","state","onfulfilled","onrejected","onfinally","_isConnected","emitClose","onClose","emitData","onMessage","proxy","encoder","TextEncoder","invariant","normalize","encode","payload","JSON","stringify","reader","FileReader","onloadend","processor","readAsText","chunk","SOUND","sound","playAudio","storage","invalid","audio","debug","volume","onerror","code","defend","dope","drink","eat","idle","quest","repair","shop","afk","bank","cast","donations","kill","recover","train","wear","things","dict","fullName","mob","getMobIn","RECUPERED","bodies","sus","memory","spellGroups","shouldHeal","defineShould","shouldRefresh","casting","getSpells","min","multiplier","clapped","hypot","getSpellGroup","group","invoke","repeatUntilCasted","canMeditate","clean","isFontAvailable","isBottleFull","getWaterBottle","bottle","createFont","nav","eatSomething","getFoodFromBag","getFoodFromInventory","err","createFood","buyFood","repairEquipment","broken","repairAll","getBrokenEquipment","getItemSustantive","locations","viajar","Calimhar","config","areas","initialExp","floor","random","take","INGRESS","EXTRACT","carring","balance","final","ceil","rooms","getLevel","room","Number","MAX_VALUE","itemsMatch","PATH","TRAVEL","REALM_RECALLS","Earand","Valmorag","Niruk","getAreaMetadata","canTravel","clan","focused","handleBody","invisible","canHeal","canRefresh","canInvisible","needsHeal","needsToMeditate","needsRefresh","hasEnoughMana","getBestArea","getArena","theif","enemies","getMobsPresence","fullMatch","enemySpotted","getMobFromPresence","enemyGone","route","checkEnemies","index","getAreasForLevel","others","wearItem","isMetallic","identified","tirar","other","parent","showControls","initState","Sidebar","Controls","Terminal","hamburger","Hamburger","onControlsToggle","main","dom","render","appendChild","classList","remove","locals","$meters","$el","color","observable","el","style","setProperty","onClick","initialState","$checkbox","toggle","checked","button","icon","$workflows","innerHTML","renderWorkflow","isEnabled","instancesRunning","instances","expand","classes","getWorkflowActions","enabler","disable","enable","actions","stop","convert","history","asciiToHtml","escaped","toHtml","$log","$input","lastChunk","histPos","emitSubmit","onKeyDown","onKeyUp","focus","selection","getSelection","userHasSelectedText","block","before","__html__","submit","loadHistory","unshift","modifier","input","decodeURIComponent"],"mappings":"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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([20,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","const createConcatenator = (escape: (x: string) => string) => (\n  ...regexes: (RegExp | string)[]\n) => {\n  const join = regexes\n    .map(x => (x instanceof RegExp ? regexToString(x) : escape(x)))\n    .join('');\n\n  const flags = regexes\n    .map(x => x instanceof RegExp && x.flags)\n    .filter(Boolean)\n    .join('');\n\n  const uniq = [...new Set(flags)].join('');\n  return new RegExp(join, uniq);\n};\n\nexport const concatRegexes = createConcatenator(escapeRegExp);\nexport const concatRegexesUnescaped = createConcatenator(String);\n\nfunction regexToString(value: RegExp) {\n  return value.toString().replace(/^\\/|\\/[gi]*$/g, '');\n}\n\nfunction stringToRegex(value: string, flags: string) {\n  return new RegExp(escapeRegExp(value));\n}\n\nfunction escapeRegExp(value: string) {\n  // $& means the whole matched string\n  return value.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&').replace(/\\n/g, '\\\\n');\n}\n","export function wait(seconds: number) {\n  return new Promise<void>(resolve => setTimeout(resolve, seconds * 1000));\n}\n","import { concatRegexesUnescaped } from './concatRegexes';\n\nconst NUMBER = /-?\\d+(?:,\\d{3})*/;\n\nexport function toInt(value: string) {\n  return parseInt(value.replace(/,/g, ''), 10);\n}\n\nexport function int(name?: string) {\n  return name ? concatRegexesUnescaped(`(?<${name}>`, NUMBER, ')') : NUMBER;\n}\n","import { Pattern } from '../lib/triggers/Pattern';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { int } from '../lib/util/int';\nimport ALL_SKILLS from './skills.json';\n\ntype Item = typeof ALL_SKILLS[number];\n\n// prettier-ignore-start\nexport const languageList = ALL_SKILLS.filter(\n  x => x.type === 'Idioma',\n) as LanguageBase[];\nexport const skillList = ALL_SKILLS.filter(\n  x => x.type === 'Habilidad',\n) as SkillBase[];\nexport const spellList = ALL_SKILLS.filter(\n  x => x.type === 'Hechizo',\n) as SpellBase[];\nexport const weaponList = ALL_SKILLS.filter(\n  x => x.type === 'Arma',\n) as WeaponBase[];\n// prettier-ignore-end\n\nexport type LanguageBase = Extract<Item, { type: 'Idioma' }>;\nexport type SkillBase = Extract<Item, { type: 'Habilidad' }>;\nexport type SpellBase = Extract<Item, { type: 'Hechizo' }>;\nexport type WeaponBase = Extract<Item, { type: 'Arma' }>;\n\nexport type SkillName = Item['name'];\n\nexport type LanguageName = LanguageBase['name'];\nexport type SpellName = SpellBase['name'];\nexport type WeaponName = WeaponBase['name'];\n\nconst effectDuration = (name: SpellName) =>\n  concatRegexes(\n    /Hechizo  : '/,\n    name,\n    /'  durante /,\n    int('asaltos'),\n    / asaltos./,\n  );\n\nconst effectProp = (prop: string | RegExp) => (name: SpellName) =>\n  concatRegexes(\n    /Hechizo  : '/,\n    name,\n    /' Afecta /,\n    prop,\n    / en /,\n    int('cantidad'),\n    / durante /,\n    int('asaltos'),\n    / asaltos./,\n  );\n\nconst metadata: Partial<Record<SpellName, SpellMetadata>> = {\n  armadura: {\n    success: 'Tu armadura brilla suavemente al ser mejorada por un conjuro.',\n    target: /La armadura de (?<target>(?:\\w+ )+)brilla suavemente al ser mejorada por un conjuro\\./,\n    end: 'Tu armadura vuelve a su valor normal.',\n    effect: effectProp('armor class'),\n  },\n\n  'atravesar puerta': {\n    success: 'Te vuelves translucido.',\n    end: 'Vuelves a tener un cuerpo solido.',\n    effect: effectDuration,\n  },\n\n  bendecir: {\n    success: 'Tu dios te otorga una poderosa bendicion.',\n    end: 'La bendicion desaparece.',\n    effect: effectProp('hit roll'),\n  },\n\n  'causar critica': { target: /Tu conjuro [^\\n]+ a(?<target>(?: \\w+)+)!/ },\n  'causar grave': { target: /Tu conjuro [^\\n]+ a(?<target>(?: \\w+)+)!/ },\n  'causar leve': { target: /Tu conjuro [^\\n]+ a(?<target>(?: \\w+)+)!/ },\n  ceguera: { target: /Lanzas un conjuro de ceguera contra (?<target>[^.]+)./ },\n  'crear agua': { target: ' esta lleno.\\n' },\n\n  'crear baya': {\n    success: 'Una baya brillante y dorada aparece en tus manos!',\n  },\n\n  'crear comida': { success: 'Una seta magica aparece de repente.' },\n\n  'crear fuego': {\n    success: 'Una gran hoguera se enciende en el suelo delante tuyo.',\n  },\n\n  'crear manantial': {\n    success:\n      'Trazas un circulo delante tuyo del cual emerge un manantial de agua cristalina.',\n    end: 'Un manantial magico se seca.',\n  },\n\n  'curar criticas': {\n    success: 'Tus heridas mas graves se cierran y el dolor desaparece.',\n    target: /Curas las heridas mas graves de (?<target>[^\\.]+)\\./,\n  },\n\n  'curar graves': {\n    success: 'Tus heridas graves se cierran y el dolor desaparece.',\n    target: /Curas las heridas graves de (?<target>[^\\.]+)\\./,\n  },\n\n  'curar leves': {\n    success: 'Tus heridas leves se cierran y el dolor desaparece.',\n    target: /Curas las heridas leves de (?<target>[^\\.]+)\\./,\n  },\n\n  'curar veneno': {\n    success: 'Un agradable sensacion recorre tu cuerpo.',\n  },\n\n  'detectar escondido': {\n    success: 'Tus sentidos cobran la viveza de los del mejor predador.',\n    end: 'Te sientes menos consciente de lo que te rodea.',\n    effect: effectDuration,\n  },\n\n  'detectar invisible': {\n    success: 'Tus ojos brillan, siendo capaces ahora de ver lo invisible.',\n    end: 'Ya no ves objetos invisibles.',\n    effect: effectDuration,\n  },\n\n  'detectar magia': {\n    success:\n      'Delgadas lineas azules reseguiran las siluetas de los objetos magicos que te encuentres.',\n    end: 'Las lineas azules desaparecen de tu vision',\n    effect: effectDuration,\n  },\n\n  'detectar maldad': {\n    success:\n      'Delgadas lineas rojas reseguiran las siluetas de los seres malvados que te encuentres.',\n    effect: effectDuration,\n    end: 'Las lineas rojas desaparecen de tu vision.',\n  },\n\n  'detectar trampas': {\n    success: 'De repente te sientes mas alerta de los peligros que te rodean.',\n    end: 'Te sientes menos alerta de los peligros que te rodean.',\n    effect: effectDuration,\n  },\n\n  flotar: {\n    success: 'Empiezas a flotar a unos centimetros del suelo...',\n    target: /\\n(?<target>[^\\n]+) empieza a flotar a unos centimetros del suelo\\.\\.\\./,\n    end: 'Tus pies aterrizan suavemente en el suelo.',\n  },\n\n  'fuerza vampirica': {\n    success: 'La fuerza de los vampiros fluye por tus venas...',\n    end: 'Tu musculos vuelven lentamente a su estado normal...',\n    effect: effectProp('fuerza'),\n  },\n\n  'furia naturaleza': {\n    success: 'Sientes como la furia de la naturaleza te embarga...',\n  },\n\n  identificar: {\n    target: /El objeto '(?<name>[^']+)' es un\\(a\\) (?<type>\\w+), propiedades especiales: (?<properties>[^\\n]+)\\n/,\n  },\n\n  invisibilidad: {\n    success: 'Te desvaneces en el aire.',\n    target: /\\n(?<target>[^\\n]+) se desvanece en el aire./,\n    end: 'Ya no eres invisible.',\n    effect: effectDuration,\n  },\n\n  'invisibilidad grupo': {\n    success:\n      'Tu cuerpo se vuelve traslucido por un momento y luego se desvanece.',\n  },\n\n  'invocar armadillo': {\n    success:\n      'Agitas tus brazos a la vez que te concentras para invocar un pequenyo armadillo.',\n  },\n\n  'luz eterna': {\n    success:\n      'Rayos de luz iridiscente colisionan para formar una bola de luz eterna...',\n  },\n\n  'piel robliza': {\n    success: 'Tu piel se oscurece a la vez que adquiere la dureza del roble.',\n    end: 'Tu piel vuelve a su estado normal...',\n    effect: effectProp('armor class'),\n  },\n\n  polimorfar: {\n    success: /Tu cuerpo empieza a cambiar... hasta transformarte en (?<result>[^!]+)!/,\n    end: 'Recuperas tu forma natural.',\n  },\n\n  refrescar: { success: 'Nueva vitalidad fluye hacia ti.' },\n\n  'respiracion acuatica': {\n    success: 'Tus pulmones ahora son capaces de respirar bajo agua...',\n    target: /Los pulmones de (?<target>[^\\n]+) ahora son capaces de respirar bajo agua\\.\\.\\./,\n    end: 'Tus pulmones vuelven a su estado original.',\n    effect: effectDuration,\n  },\n\n  terremoto: {\n    success: 'La tierra tiembla bajo tus pies!',\n    target: 'La tierra tiembla bajo tus pies!',\n  },\n\n  veneno: {\n    target: /\\n(?<target>[^\\n]+)cobra un aspecto enfermizo cuando tu veneno se esparce por su cuerpo./,\n  },\n\n  'vista distancia': {\n    success: 'Tienes una vision reveladora...',\n    target: /Los ojos de (?<target>[^\\n]+) parecen estar mirando un lugar lejano\\.\\.\\./,\n    end: 'Tu clarividencia te abandona...',\n    effect: effectDuration,\n  },\n\n  volar: {\n    success: 'Te elevas entre las corrientes de aire...',\n    target: /\\n(?<target>[^\\n]+) se eleva entre las corrientes de aire.../,\n    end: 'Aterrizas suavemente en el suelo.',\n    effect: effectDuration,\n  },\n};\n\nconst spells = spellList.map(x => ({\n  ...x,\n  ...(metadata[x.name] || {}),\n})) as Spell[];\n\ninterface SpellMetadata {\n  readonly success?: Pattern;\n  readonly target?: Pattern;\n  readonly end?: Pattern;\n  readonly effect?: (string: SpellName) => Pattern;\n}\n\nexport type Casteable = SpellName | SpellName[];\nexport type Spell = SpellBase & SpellMetadata;\n\nexport const SPELL_FAILED = [\n  'Algo te distrae y pierdes la concentracion.',\n  'Has perdido la concentracion.',\n  'Has tenido una laguna mental mientras invocabas el hechizo.',\n  'Pierdes la concentracion.',\n  'Un picor en la nariz te impide mantener la concentracion.',\n  'Un pinchazo en tu pierna te impide lanzar el conjuro adecuadamente.',\n  'Una mota de polvo en el ojo rompe tu concentracion por un momento.',\n];\n\nexport const SPELL_ALREADY_APPLIED = [\n  'Has fallado.',\n  'Eso no parece tener ningun efecto.',\n];\n\nexport const SPELL_NOT_POSSIBLE = [\n  'No esta aqui.',\n  'Falta algo...',\n  'No tienes suficiente mana.',\n  'Sobre que quieres lanzar este conjuro?',\n  'No puedes encontrar ningun ',\n  'Este estilo de lucha pide demasiado atencion para hacer eso!',\n  'Este asalto del combate es demasiado febril para concentrarte adecuadamente.',\n  'No has tenido suficiente tiempo en este asalto para completar el conjuro.',\n  'Estas demasiado malherido para hacer eso.',\n  'Estas demasiado aturdido para hacer eso.',\n];\n\nexport const SPELLS_BY_TYPE = {\n  food: ['saciar hambre', 'crear comida'] as Casteable,\n  water: ['crear manantial', 'crear agua'] as Casteable,\n  movement: ['volar', 'flotar'] as Casteable,\n  heal: ['curar criticas', 'curar graves', 'curar leves'] as Casteable,\n  invisibility: ['invisibilidad grupo', 'invisibilidad'] as Casteable,\n  massAttack: ['terremoto'] as Casteable,\n  attack: ['causar critica', 'causar grave', 'causar leve'] as Casteable,\n\n  attackAlternative: [\n    'agarron impactante',\n    'relampago',\n    'bola fuego',\n    'misil magico',\n  ] as Casteable,\n\n  dedope: [\n    'ceguera',\n    'veneno',\n    'disipar magia',\n    'disipar maldad',\n    'maldecir',\n    'proteccion',\n    'fuego espectral',\n    'debilitar',\n  ] as Casteable,\n\n  pet: [\n    'invocar oso',\n    'invocar jaguar',\n    'invocar lobo',\n    'invocar aguila',\n    'invocar lince',\n    'invocar armadillo',\n  ] as Casteable,\n};\n\nexport const SPELL_LEARN_ORDER: Casteable[] = [\n  // Survival\n  SPELLS_BY_TYPE.food,\n  SPELLS_BY_TYPE.water,\n  SPELLS_BY_TYPE.dedope,\n  'luz eterna',\n\n  // Love\n  'invisibilidad',\n  'invocar armadillo',\n\n  // Dope\n  'armadura',\n  'bendecir',\n  'detectar escondido',\n  'detectar invisible',\n  'detectar magia',\n  SPELLS_BY_TYPE.movement,\n\n  // Medic\n  'curar ceguera',\n  SPELLS_BY_TYPE.heal,\n  'refrescar',\n\n  // Other\n  SPELLS_BY_TYPE.attack,\n  'crear fuego',\n];\n\nexport function getSpells() {\n  return spells;\n}\n\nexport function getSpell(name: string) {\n  const lower = name.toLowerCase();\n  const base = spellList.find(x => x.name.startsWith(lower));\n\n  if (!base) {\n    throw new Error(`Unknown spell ${name}`);\n  }\n\n  const meta = base && metadata[base.name];\n  if (!meta) return base;\n\n  return {\n    ...base,\n    ...meta,\n    effect:\n      typeof meta.effect === 'function' ? meta.effect(base.name) : meta.effect,\n  };\n}\n","import { Pattern, SinglePattern } from '../lib/triggers/Pattern';\nimport { concatRegexes } from '../lib/util/concatRegexes';\n\nconst MOB_GENERIC = {\n  adorador: [\n    'Un adorador mira con clera a su alrededor.',\n    'Un devoto adorador mira con clera a su alrededor.',\n  ],\n  aguila: [\n    'Una enorme aguila esta aqui profundamente dormido.',\n    'Una gigantesca aguila vuela a tu alrededor.',\n  ],\n  buitre: 'Un buitre carronyero esta aqui.',\n  calamar: 'Un calamar gigante esta aqui nadando.',\n  caracol: 'Un pequenyo caracol esta aqui haciendo trompos.',\n  ciervo: null,\n  conejo: null,\n  criatura: [\n    'Una poderosa criatura del pantano esta aqui profundamente dormido.',\n  ],\n  cubo: 'Un enorme cubo transparente de materia gelatinosa rezuma ante ti.',\n  cultista: [\n    'Una joven cultista parece bastante serena, mientras no vea a nadie m',\n  ],\n  dragon: null,\n  empleado: null,\n  engendro:\n    'Un deforme humano, un engendro de la magia, quiere descargar su agresividad.',\n  espiritu: 'Un espritu se desliza por el aire.',\n  esqueleto: [\n    'El esqueleto hace castanyetear sus dientes amenazadoramente y se acerca!',\n    'Un esqueleto con armadura avanza torpemente a traves de los arboles.',\n    'Un esqueleto huesudo esta aqui profundamente dormido.',\n    'Un esqueleto polvoriento esta aqui.',\n  ],\n  fanatico: \"Un humano posedo por el fanatismo busca 'herejes'.\",\n  gusano: [\n    'Un gusano de roca esta aqui profundamente dormido.',\n    /Un monstruoso gusano de hielo excava a traves del hielo y la nieve aqui\\. Se yergue y\\s+ataca!/,\n  ],\n  hobgoblin: [\n    'un guardia hobgoblin de elite esta aqui profundamente dormido.',\n    'Un hobgoblin armado esta aqui, interrogando a un prisionero.',\n    'Un macizo hobgoblin esta de guardia cerca del hueco de la escalera.',\n    'Un guardian de la montaa esta aqu, echando espuma por la boca.',\n  ],\n  gnoll: 'un gnoll feo esta aqui profundamente dormido.',\n  goblin: [\n    'un goblin negrero esta aqui profundamente dormido.',\n    'Un habitante del bosque merodea por aqui, protegiendo su montanya.',\n    'Un macizo chaman goblin esta aqui rugiendo a sus lacayos.',\n  ],\n  guardia: 'Un Guardia Real est aqu velando por la seguridad del estadio',\n  guerrero: 'Un guerrero asqueroso grunye al verte.',\n  jefe: [\n    'Un jefe esta aqui descansando.',\n    'Un jefe orco esta aqui mirandote desconfiado.',\n    'Un macizo chaman goblin esta aqui rugiendo a sus lacayos.',\n  ],\n  ladron: [\n    'Un ladron esta aqui profundamente dormido.',\n    /Tu ataque causa .* a un ladron!/,\n  ],\n  lobo: [\n    'Un gran lobo negro, te muestra los colmillos hambriento.',\n    'Un lobo feroz esta aqui y grunye muy enojado.',\n    'Un lobo hambriento te esta mirando',\n  ],\n  mago: 'Un mago viejo esta aqui profundamente dormido.',\n  merodeador: null,\n  murcielago: null,\n  ogro: [\n    'el capitan ogro esta aqui profundamente dormido.',\n    'Un gigantesco ogro juega con una enorme roca lanzandola al aire.',\n  ],\n  orco: [\n    'El arquero orco esta aqui profundamente dormido.',\n    'El capitan orco te observa con sus ojos llenos de furia.',\n    'El chaman esta sentado detras de un escritorio, escribiendo una misiva.',\n    'El desagradable y malioliente espadachin orco esta aqui.',\n    'el jefe orco minero esta aqui profundamente dormido.',\n    'El orco espadachin llega desde el este.',\n    'Un asqueroso arquero orco esta aqui.',\n    'Un corpulento orco esta aqui de guardia.',\n    'un guardia orco esta aqui profundamente dormido.',\n    'Un jefe orco esta aqui profundamente dormido.',\n    'Un ogro centinela esta de guardia delante de la puerta norte.',\n    'un orco centinela esta aqui profundamente dormido.',\n    'Un orco esta de pie al lado de la ballesta.',\n    'Un orco fuera de servicio esta sentado aqui jugando a las cartas.',\n    'Un orco fuera de servicio esta sentado aqui jugando a los dados.',\n    'un orco minero esta aqui profundamente dormido.',\n    'Un pequenyo orco se sienta en una de las sillas roncando.',\n    'Un sargento orco mantiene vigilada la chusma a la que comanda.',\n    'Un voluminoso cocinero orco sopesa un cuchillo de carnicero manchado de sangre.',\n    /El orco espadachin esta aqui profundamente dormido\\./i,\n  ],\n  pantera: null,\n  piranya: [\n    'Una piranya te mira con su enorme boca.',\n    /Una piranya esta aqui profundamente dormido\\./i,\n  ],\n  rata: 'Una rata gigante esta aqui profundamente dormido.',\n  sapo: 'un sapo gigante esta aqui profundamente dormido.',\n  serpiente: 'Una serpiente que parece venenosa te mira fijamente.',\n  'uruk-hai': [\n    'Un asqueroso arquero uruk-hai tensa su arco al verte.',\n    'Un superior uruk-hai esta aqui vigilando.',\n  ],\n  troll: 'Un troll de mas de 3 metros de alto esta destrozando el mobiliario.',\n  zombie: 'Un zombie se acerca hacia ti con los brazos extendidos.',\n};\n\nconst MOB_CHARACTERS = {\n  Kivon: 'Kivon, el lder del culto, no est nada contento con intromisiones.',\n  Nejane: 'Nejane, la lder, parece estar en trance.',\n} as const;\n\nconst MOB_ARTICLE = /(?:(?:un|una|el|la|los|las|unos|unas) )?/;\nconst MOB_NAME = /(?<mob>(?: |\\w|-)+)/;\nconst ALLIES = ['armadillo', 'lince'];\n\nconst MOBS: Mob[] = Object.entries({\n  ...MOB_CHARACTERS,\n  ...MOB_GENERIC,\n}).map(([name, presence]) => ({\n  name: name as MobName,\n  presence,\n}));\n\ntype GenericMobName = keyof typeof MOB_GENERIC;\ntype CharacterMobName = keyof typeof MOB_CHARACTERS;\n\n// PUBLIC\n\nexport type MobName = GenericMobName | CharacterMobName;\n\nexport interface Mob {\n  name: MobName;\n  presence?: Pattern | null;\n}\n\nexport const ATTACK_RECEIVED = [\n  /Tu ataque \\w+ a un (?<mob>ladron)./,\n  concatRegexes(/El \\w+ de /, MOB_ARTICLE, MOB_NAME, / te /),\n];\n\nexport const MOB_ARRIVES = concatRegexes(\n  MOB_ARTICLE,\n  MOB_NAME,\n  / llega desde el (?<direction>\\w+)/,\n);\n\nexport const MOB_LEAVES = concatRegexes(\n  MOB_ARTICLE,\n  MOB_NAME,\n  / (?:se va)|(?:vuela) hacia (?:el )?(?<direction>\\w+)/,\n);\n\nexport const MOB_DIES = concatRegexes(MOB_ARTICLE, MOB_NAME, / ha MUERTO!!/);\n\nexport function getMobsPresence() {\n  return MOBS.map(x => x.presence)\n    .flat()\n    .filter(Boolean) as Pattern;\n}\n\nexport function getMobFromPresence(patterns: SinglePattern[]) {\n  return MOBS.filter(x => x.presence).find(({ presence }) =>\n    Array.isArray(presence)\n      ? patterns.some(x => presence.includes(x))\n      : patterns.includes(presence!),\n  );\n}\n\nexport function getMobIn(text: string) {\n  const lower = text.toLowerCase();\n\n  if (ALLIES.some(x => lower.includes(x))) {\n    return null;\n  }\n\n  const result = MOBS.find(x => lower.includes(x.name));\n\n  if (!result) {\n    console.warn(`Unknown sustantive for \"${text}\"`);\n  }\n\n  return result;\n}\n","import { concatRegexes } from '../lib/util/concatRegexes';\n\nexport type ItemName = typeof ITEM_SUSTANTIVES[number];\n\nexport const ITEM_ARTICLE = /(?: (?:un|una|el|la|los|las|unos|unas))?/;\n\nexport const WEAR = [\n  'Te colocas ',\n  'Te pones ',\n  'Metes las piernas ',\n  'Vistes ',\n];\nexport const UNWEAR = concatRegexes(\n  /Dejas de usar/,\n  ITEM_ARTICLE,\n  / (?<item>[^.]+?)\\./,\n);\n\nexport const ITEM_SUSTANTIVES = [\n  'amuleto',\n  'anillo',\n  'anteojos',\n  'armadura',\n  'baculo',\n  'baston',\n  'bola',\n  'botas',\n  'brazal',\n  'brazalete',\n  'brazaletes',\n  'brigandina',\n  'capa',\n  'capote',\n  'casco',\n  'cetro',\n  'cinto',\n  'cinturon',\n  'cinturn',\n  'coderas',\n  'colgante',\n  'collar',\n  'coraza',\n  'cota',\n  'cubrepiernas',\n  'daga',\n  'escudo',\n  'espada',\n  'faja',\n  'faldones',\n  'grebas',\n  'guanteletes',\n  'guantes',\n  'hacha',\n  // 'joya',\n  'lanza',\n  'luz',\n  'mangas',\n  'manoplas',\n  'martillo',\n  'maza',\n  'mocasines',\n  'pendiente',\n  'perneras',\n  'peto',\n  'pica',\n  'placa',\n  'polainas',\n  'pulsera',\n  'ropaje',\n  'sentido',\n  'sombrero',\n  'tobillera',\n  'vara',\n  'varita',\n  'visera',\n  'yelmo',\n] as const;\n\nexport function getItemSustantive(item: string): ItemName | null {\n  const lower = item.toLowerCase();\n  const found = ITEM_SUSTANTIVES.find(x => lower.includes(x));\n\n  if (!found) {\n    console.warn('Unknown item sustantive:', item);\n    return null;\n  }\n\n  return found;\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"body {\\n  --background-color: #1c1c1c;\\n  --border-color: #484848;\\n  --control-color: white;\\n  --color: white;\\n  background-color: black;\\n  color: white;\\n}\\n\\n.container {\\n  height: 100%;\\n  display: grid;\\n  grid-template-rows: 1fr;\\n  grid-template-columns: 1fr;\\n  grid-template-areas: 'terminal';\\n}\\n\\n.container.show-controls {\\n  grid-template-columns: 9fr 3fr;\\n}\\n\\n.container.show-controls:not(.top) {\\n  grid-template-areas:\\n    'terminal sidebar'\\n    'controls sidebar';\\n}\\n\\n.container.show-controls.top {\\n  grid-template-areas:\\n    'controls sidebar'\\n    'terminal sidebar';\\n}\\n\\n.container:not(.show-controls) .sidebar,\\n.container:not(.show-controls) .controls {\\n  display: none;\\n}\\n\\n.container.show-controls:not(.top) .controls:empty {\\n  border-top: 1px solid var(--border-color);\\n}\\n\\n.container.show-controls.top .controls:empty {\\n  border-bottom: 1px solid var(--border-color);\\n}\\n\\n/* TERMINAL */\\n\\n.terminal {\\n  grid-area: terminal;\\n  overflow-x: hidden;\\n  overflow-y: auto;\\n  -ms-overflow-style: none; /* IE and Edge */\\n  scrollbar-width: none; /* Firefox */\\n  display: flex;\\n  flex-direction: column-reverse;\\n  padding: 0.5em;\\n}\\n\\n.terminal::-webkit-scrollbar {\\n  display: none;\\n}\\n\\n.terminal p {\\n  margin: 1em 0;\\n}\\n\\n.terminal input {\\n  background-color: transparent;\\n  border: none;\\n  color: white;\\n  display: inline-block;\\n  font-family: monospace;\\n  outline: none;\\n}\\n\\n/* CONTROLS */\\n\\n.controls {\\n  grid-area: controls;\\n  background-color: var(--background-color);\\n  display: flex;\\n  align-items: stretch;\\n  height: 30px;\\n}\\n\\n.controls .meters {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: stretch;\\n  flex: 1;\\n}\\n\\n.controls .meters .meter {\\n  flex: 1;\\n  --color: white;\\n  --value: 100%;\\n}\\n\\n.controls .meter .bar {\\n  height: 100%;\\n  width: var(--value);\\n  background-color: var(--color);\\n}\\n\\n/* SIDEBAR */\\n\\n.sidebar {\\n  grid-area: sidebar;\\n  background-color: var(--background-color);\\n  border-left: 1px solid var(--border-color);\\n  display: flex;\\n  flex-direction: column-reverse;\\n  align-items: stretch;\\n}\\n\\n.sidebar .title {\\n  text-align: center;\\n  text-transform: uppercase;\\n}\\n\\n.sidebar .workflow-list {\\n  list-style: none;\\n  margin-bottom: 0;\\n  padding: 0;\\n}\\n\\n.sidebar .workflow {\\n  border-top: 1px solid var(--border-color);\\n}\\n.sidebar .workflow.running {\\n  color: gray;\\n}\\n.sidebar .workflow.disabled .workflow-content {\\n  opacity: 0.5;\\n}\\n\\n.sidebar .workflow header {\\n  display: flex;\\n  align-items: center;\\n  padding: 1rem;\\n}\\n\\n.sidebar .workflow .name {\\n  flex: 1;\\n  margin: 0 0.5rem;\\n  font-size: 1.4rem;\\n  font-family: monospace;\\n  text-transform: uppercase;\\n  font-weight: normal;\\n}\\n\\n.sidebar .action {\\n  appearance: none;\\n  background: none;\\n  border: none;\\n  outline: none;\\n  margin: 0;\\n  padding: 3px;\\n  color: var(--control-color);\\n  font-size: 0.9rem;\\n  transition: opacity 0.1s ease-in-out;\\n  text-align: center;\\n  opacity: 0.8;\\n}\\n.sidebar .action:hover {\\n  opacity: 1;\\n}\\n.sidebar .action:active {\\n  opacity: 0.5;\\n}\\n\\n.sidebar .action.enable-control:hover i:first-child,\\n.sidebar .action.enable-control:not(:hover) i:last-child,\\n.sidebar .workflow.running .run,\\n.sidebar .workflow:not(.running) .stop,\\n.sidebar .workflow:not(.expanded) .triggers {\\n  display: none;\\n}\\n\\n/* HAMBURGER */\\n\\n.hamburger {\\n  display: inline-block;\\n  position: absolute;\\n  top: 24px;\\n  right: 40px;\\n  z-index: 1;\\n  -webkit-user-select: none;\\n  user-select: none;\\n}\\n\\n.hamburger input {\\n  display: block;\\n  width: 40px;\\n  height: 32px;\\n  position: absolute;\\n  top: -7px;\\n  left: -5px;\\n  cursor: pointer;\\n  opacity: 0; /* hide this */\\n  z-index: 2; /* and place it over the hamburger */\\n  -webkit-touch-callout: none;\\n}\\n\\n.hamburger span {\\n  display: block;\\n  width: 33px;\\n  height: 4px;\\n  margin-bottom: 5px;\\n  position: relative;\\n  background: #cdcdcd;\\n  border-radius: 3px;\\n  z-index: 1;\\n  transform-origin: center right;\\n  transition: transform 0.5s cubic-bezier(0.77, 0.2, 0.05, 1),\\n    background 0.5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity 0.55s ease;\\n}\\n\\n/*\\n * Transform all the slices of hamburger\\n * into a crossmark.\\n */\\n.hamburger input:checked ~ span:nth-of-type(2) {\\n  opacity: 0;\\n  transform: rotate(0deg) scale(0.2, 0.2);\\n}\\n\\n.hamburger input:checked ~ span:first-of-type {\\n  transform: rotate(-45deg) translate(0, -4px);\\n}\\n\\n.hamburger input:checked ~ span:last-of-type {\\n  transform: rotate(45deg) translate(0, 4px);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/ui/index.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,2BAA2B;EAC3B,uBAAuB;EACvB,sBAAsB;EACtB,cAAc;EACd,uBAAuB;EACvB,YAAY;AACd;;AAEA;EACE,YAAY;EACZ,aAAa;EACb,uBAAuB;EACvB,0BAA0B;EAC1B,+BAA+B;AACjC;;AAEA;EACE,8BAA8B;AAChC;;AAEA;EACE;;sBAEoB;AACtB;;AAEA;EACE;;sBAEoB;AACtB;;AAEA;;EAEE,aAAa;AACf;;AAEA;EACE,yCAAyC;AAC3C;;AAEA;EACE,4CAA4C;AAC9C;;AAEA,aAAa;;AAEb;EACE,mBAAmB;EACnB,kBAAkB;EAClB,gBAAgB;EAChB,wBAAwB,EAAE,gBAAgB;EAC1C,qBAAqB,EAAE,YAAY;EACnC,aAAa;EACb,8BAA8B;EAC9B,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,6BAA6B;EAC7B,YAAY;EACZ,YAAY;EACZ,qBAAqB;EACrB,sBAAsB;EACtB,aAAa;AACf;;AAEA,aAAa;;AAEb;EACE,mBAAmB;EACnB,yCAAyC;EACzC,aAAa;EACb,oBAAoB;EACpB,YAAY;AACd;;AAEA;EACE,aAAa;EACb,sBAAsB;EACtB,oBAAoB;EACpB,OAAO;AACT;;AAEA;EACE,OAAO;EACP,cAAc;EACd,aAAa;AACf;;AAEA;EACE,YAAY;EACZ,mBAAmB;EACnB,8BAA8B;AAChC;;AAEA,YAAY;;AAEZ;EACE,kBAAkB;EAClB,yCAAyC;EACzC,0CAA0C;EAC1C,aAAa;EACb,8BAA8B;EAC9B,oBAAoB;AACtB;;AAEA;EACE,kBAAkB;EAClB,yBAAyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,gBAAgB;EAChB,UAAU;AACZ;;AAEA;EACE,yCAAyC;AAC3C;AACA;EACE,WAAW;AACb;AACA;EACE,YAAY;AACd;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,aAAa;AACf;;AAEA;EACE,OAAO;EACP,gBAAgB;EAChB,iBAAiB;EACjB,sBAAsB;EACtB,yBAAyB;EACzB,mBAAmB;AACrB;;AAEA;EACE,gBAAgB;EAChB,gBAAgB;EAChB,YAAY;EACZ,aAAa;EACb,SAAS;EACT,YAAY;EACZ,2BAA2B;EAC3B,iBAAiB;EACjB,oCAAoC;EACpC,kBAAkB;EAClB,YAAY;AACd;AACA;EACE,UAAU;AACZ;AACA;EACE,YAAY;AACd;;AAEA;;;;;EAKE,aAAa;AACf;;AAEA,cAAc;;AAEd;EACE,qBAAqB;EACrB,kBAAkB;EAClB,SAAS;EACT,WAAW;EACX,UAAU;EACV,yBAAyB;EACzB,iBAAiB;AACnB;;AAEA;EACE,cAAc;EACd,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,SAAS;EACT,UAAU;EACV,eAAe;EACf,UAAU,EAAE,cAAc;EAC1B,UAAU,EAAE,oCAAoC;EAChD,2BAA2B;AAC7B;;AAEA;EACE,cAAc;EACd,WAAW;EACX,WAAW;EACX,kBAAkB;EAClB,kBAAkB;EAClB,mBAAmB;EACnB,kBAAkB;EAClB,UAAU;EACV,8BAA8B;EAC9B;wEACsE;AACxE;;AAEA;;;EAGE;AACF;EACE,UAAU;EACV,uCAAuC;AACzC;;AAEA;EACE,4CAA4C;AAC9C;;AAEA;EACE,0CAA0C;AAC5C\",\"sourcesContent\":[\"body {\\n  --background-color: #1c1c1c;\\n  --border-color: #484848;\\n  --control-color: white;\\n  --color: white;\\n  background-color: black;\\n  color: white;\\n}\\n\\n.container {\\n  height: 100%;\\n  display: grid;\\n  grid-template-rows: 1fr;\\n  grid-template-columns: 1fr;\\n  grid-template-areas: 'terminal';\\n}\\n\\n.container.show-controls {\\n  grid-template-columns: 9fr 3fr;\\n}\\n\\n.container.show-controls:not(.top) {\\n  grid-template-areas:\\n    'terminal sidebar'\\n    'controls sidebar';\\n}\\n\\n.container.show-controls.top {\\n  grid-template-areas:\\n    'controls sidebar'\\n    'terminal sidebar';\\n}\\n\\n.container:not(.show-controls) .sidebar,\\n.container:not(.show-controls) .controls {\\n  display: none;\\n}\\n\\n.container.show-controls:not(.top) .controls:empty {\\n  border-top: 1px solid var(--border-color);\\n}\\n\\n.container.show-controls.top .controls:empty {\\n  border-bottom: 1px solid var(--border-color);\\n}\\n\\n/* TERMINAL */\\n\\n.terminal {\\n  grid-area: terminal;\\n  overflow-x: hidden;\\n  overflow-y: auto;\\n  -ms-overflow-style: none; /* IE and Edge */\\n  scrollbar-width: none; /* Firefox */\\n  display: flex;\\n  flex-direction: column-reverse;\\n  padding: 0.5em;\\n}\\n\\n.terminal::-webkit-scrollbar {\\n  display: none;\\n}\\n\\n.terminal p {\\n  margin: 1em 0;\\n}\\n\\n.terminal input {\\n  background-color: transparent;\\n  border: none;\\n  color: white;\\n  display: inline-block;\\n  font-family: monospace;\\n  outline: none;\\n}\\n\\n/* CONTROLS */\\n\\n.controls {\\n  grid-area: controls;\\n  background-color: var(--background-color);\\n  display: flex;\\n  align-items: stretch;\\n  height: 30px;\\n}\\n\\n.controls .meters {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: stretch;\\n  flex: 1;\\n}\\n\\n.controls .meters .meter {\\n  flex: 1;\\n  --color: white;\\n  --value: 100%;\\n}\\n\\n.controls .meter .bar {\\n  height: 100%;\\n  width: var(--value);\\n  background-color: var(--color);\\n}\\n\\n/* SIDEBAR */\\n\\n.sidebar {\\n  grid-area: sidebar;\\n  background-color: var(--background-color);\\n  border-left: 1px solid var(--border-color);\\n  display: flex;\\n  flex-direction: column-reverse;\\n  align-items: stretch;\\n}\\n\\n.sidebar .title {\\n  text-align: center;\\n  text-transform: uppercase;\\n}\\n\\n.sidebar .workflow-list {\\n  list-style: none;\\n  margin-bottom: 0;\\n  padding: 0;\\n}\\n\\n.sidebar .workflow {\\n  border-top: 1px solid var(--border-color);\\n}\\n.sidebar .workflow.running {\\n  color: gray;\\n}\\n.sidebar .workflow.disabled .workflow-content {\\n  opacity: 0.5;\\n}\\n\\n.sidebar .workflow header {\\n  display: flex;\\n  align-items: center;\\n  padding: 1rem;\\n}\\n\\n.sidebar .workflow .name {\\n  flex: 1;\\n  margin: 0 0.5rem;\\n  font-size: 1.4rem;\\n  font-family: monospace;\\n  text-transform: uppercase;\\n  font-weight: normal;\\n}\\n\\n.sidebar .action {\\n  appearance: none;\\n  background: none;\\n  border: none;\\n  outline: none;\\n  margin: 0;\\n  padding: 3px;\\n  color: var(--control-color);\\n  font-size: 0.9rem;\\n  transition: opacity 0.1s ease-in-out;\\n  text-align: center;\\n  opacity: 0.8;\\n}\\n.sidebar .action:hover {\\n  opacity: 1;\\n}\\n.sidebar .action:active {\\n  opacity: 0.5;\\n}\\n\\n.sidebar .action.enable-control:hover i:first-child,\\n.sidebar .action.enable-control:not(:hover) i:last-child,\\n.sidebar .workflow.running .run,\\n.sidebar .workflow:not(.running) .stop,\\n.sidebar .workflow:not(.expanded) .triggers {\\n  display: none;\\n}\\n\\n/* HAMBURGER */\\n\\n.hamburger {\\n  display: inline-block;\\n  position: absolute;\\n  top: 24px;\\n  right: 40px;\\n  z-index: 1;\\n  -webkit-user-select: none;\\n  user-select: none;\\n}\\n\\n.hamburger input {\\n  display: block;\\n  width: 40px;\\n  height: 32px;\\n  position: absolute;\\n  top: -7px;\\n  left: -5px;\\n  cursor: pointer;\\n  opacity: 0; /* hide this */\\n  z-index: 2; /* and place it over the hamburger */\\n  -webkit-touch-callout: none;\\n}\\n\\n.hamburger span {\\n  display: block;\\n  width: 33px;\\n  height: 4px;\\n  margin-bottom: 5px;\\n  position: relative;\\n  background: #cdcdcd;\\n  border-radius: 3px;\\n  z-index: 1;\\n  transform-origin: center right;\\n  transition: transform 0.5s cubic-bezier(0.77, 0.2, 0.05, 1),\\n    background 0.5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity 0.55s ease;\\n}\\n\\n/*\\n * Transform all the slices of hamburger\\n * into a crossmark.\\n */\\n.hamburger input:checked ~ span:nth-of-type(2) {\\n  opacity: 0;\\n  transform: rotate(0deg) scale(0.2, 0.2);\\n}\\n\\n.hamburger input:checked ~ span:first-of-type {\\n  transform: rotate(-45deg) translate(0, -4px);\\n}\\n\\n.hamburger input:checked ~ span:last-of-type {\\n  transform: rotate(45deg) translate(0, 4px);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","export function singleExecution<Return>(fn: () => Promise<Return>) {\n  let running: Promise<Return> | null = null;\n\n  return () => {\n    if (running) {\n      return running;\n    }\n\n    running = fn().then(x => {\n      running = null;\n      return x;\n    });\n\n    return running;\n  };\n}\n","import { wait } from '../util/wait';\nimport { PatternMatchSubscription } from './PatternMatchSubscription';\nimport { PatternResult } from './PatternResult';\n\nexport class PatternPromise\n  extends Promise<PatternResult>\n  implements PatternMatchSubscription {\n  private forceReject!: (reason?: any) => void;\n\n  constructor(\n    executor: (\n      resolve: (value?: PatternResult | PromiseLike<PatternResult>) => void,\n      reject: (reason?: any) => void,\n    ) => void,\n  ) {\n    let _reject!: (reason?: any) => void;\n\n    super((resolve, reject) => {\n      _reject = reject;\n      executor(resolve, reject);\n    });\n\n    this.forceReject = _reject;\n  }\n\n  timeout(seconds: number) {\n    super.catch(() => {});\n    wait(seconds).then(() =>\n      this.forceReject(new Error(`Timeout: ${seconds}`)),\n    );\n    return this as Promise<PatternResult>;\n  }\n\n  wait(seconds: number) {\n    return Promise.race([this, wait(seconds)]);\n  }\n\n  unsubscribe(): void {\n    this.forceReject('aborted');\n  }\n\n  once() {\n    return this;\n  }\n}\n","import { emitter } from '@amatiasq/emitter';\nimport { BasicContext } from '../lib/context/BasicContextCreator';\n\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { int, toInt } from '../lib/util/int';\n\nconst PROMPT = [\n  '&W<',\n  '&R%h/%Hhp ',\n  '&C%m/%Mm ',\n  '&G%v/%Vmv ',\n  '&P%Xxp ',\n  '&Y%gg ',\n  '&W&0%d',\n  '&W> ',\n  '&W%A ',\n  '\\n',\n].join('');\n\nconst FPROMPT = PROMPT.replace('&W>', ' &R%E&W>');\n\nconst captureProgress = (name: string) =>\n  concatRegexes(int(`${name}Curr`), '/', int(`${name}Total`), `${name} `);\n\n// prettier-ignore\nexport const PROMPT_DETECTOR = concatRegexes(\n  /</,\n  captureProgress('hp'),\n  captureProgress('m'),\n  captureProgress('mv'),\n  int('exp'), /xp /,\n  int('gold'), /g /,\n  int('favor'),\n  /( \\((?<enemy>\\d+)%\\))?/,\n  /> (?<invis>I)?/,\n);\n\nclass Stat {\n  total = 0;\n  current = 0;\n\n  get percent() {\n    const result = this.total ? (1 / this.total) * this.current : 0;\n    return Math.round(result * 100) / 100;\n  }\n}\n\nexport async function promptPlugin({ when, write }: BasicContext) {\n  let isInvisible = false;\n\n  const stats = {\n    hp: new Stat(),\n    mana: new Stat(),\n    mv: new Stat(),\n    exp: 0,\n    gold: 0,\n    enemy: null as number | null,\n\n    get isFighting() {\n      return stats.enemy !== null;\n    },\n  };\n\n  type Stats = typeof stats;\n\n  const update = emitter<typeof stats>();\n\n  when(PROMPT_DETECTOR)\n    .timeout(1)\n    .catch(setPrompt)\n    .finally(() => {\n      when(PROMPT_DETECTOR, ({ groups: g }) => {\n        stats.hp.current = toInt(g.hpCurr);\n        stats.hp.total = toInt(g.hpTotal);\n        stats.mana.current = toInt(g.mCurr);\n        stats.mana.total = toInt(g.mTotal);\n        stats.mv.current = toInt(g.mvCurr);\n        stats.mv.total = toInt(g.mvTotal);\n        stats.exp = toInt(g.exp);\n        stats.gold = toInt(g.gold);\n        stats.enemy = g.enemy ? toInt(g.enemy) : null;\n        isInvisible = Boolean(g.invis);\n        update(stats);\n      });\n    });\n\n  return {\n    getPercent,\n    getValue,\n    until,\n    whenFresh,\n    onUpdate: update.subscribe,\n\n    get isFighting() {\n      return stats.isFighting;\n    },\n\n    get isInvisible() {\n      return isInvisible;\n    },\n  };\n\n  function whenFresh() {\n    return until(stats => {\n      console.log(\n        stats.hp.percent,\n        stats.mana.percent,\n        stats.mv.percent,\n        stats.hp.percent === 1 &&\n          stats.mana.percent === 1 &&\n          stats.mv.percent === 1,\n      );\n      return (\n        stats.hp.percent === 1 &&\n        stats.mana.percent === 1 &&\n        stats.mv.percent === 1\n      );\n    });\n  }\n\n  function setPrompt() {\n    write(`prompt ${PROMPT}`);\n    write(`fprompt ${FPROMPT}`);\n  }\n\n  function getPercent(stat: 'hp' | 'mana' | 'mv') {\n    return stats[stat].percent;\n  }\n\n  function getValue(stat: 'gold' | 'exp'): number;\n  function getValue(stat: 'enemy'): number | null;\n  function getValue(stat: 'gold' | 'exp' | 'enemy') {\n    return stats[stat];\n  }\n\n  function until(predicate?: (stats: Stats) => boolean) {\n    if (!predicate) {\n      return when(PROMPT_DETECTOR);\n    }\n\n    if (predicate(stats)) {\n      return true;\n    }\n\n    return new Promise(resolve => {\n      const unsubscribe = update.subscribe((stats: Stats) => {\n        if (predicate(stats)) {\n          unsubscribe();\n          resolve(stats);\n        }\n      });\n    });\n  }\n}\n","import { TriggerCollection } from './../triggers/TriggerCollection';\nimport { emitter } from '@amatiasq/emitter';\nimport { PatternMatchSubscription as Subscription } from '../triggers/PatternMatchSubscription';\nimport { Mud } from './../Mud';\nimport { wait } from '../util/wait';\nimport { WriteOptions } from '../WriteOptions';\nimport { Pattern } from '../triggers/Pattern';\nimport { PatternOptions } from '../triggers/PatternOptions';\nimport { PatternPromise } from '../triggers/PatternPromise';\nimport { PatternResult } from '../triggers/PatternResult';\n\nexport type BasicContext = ReturnType<BasicContextCreator['createInstance']>;\n\nexport class BasicContextCreator {\n  private readonly dispositions = new Map<\n    BasicContext,\n    (data: void) => boolean\n  >();\n\n  private readonly emitInstanceAborted = emitter<BasicContext>();\n  readonly onInstanceAborted = this.emitInstanceAborted.subscribe;\n\n  private readonly emitInstanceDisposed = emitter<BasicContext>();\n  readonly onInstanceDisposed = this.emitInstanceDisposed.subscribe;\n\n  constructor(\n    private readonly triggers: TriggerCollection,\n    private readonly send: Mud['send'],\n  ) {}\n\n  createInstance(name: string) {\n    const { checkNotAborted, send, triggers } = this;\n    const dispose = emitter<void>();\n    const subscriptions: Subscription[] = [];\n    let isPrintingLogs = false;\n    let isAborted = false;\n\n    const context = {\n      get name() {\n        return name;\n      },\n      get isAborted() {\n        return isAborted;\n      },\n      get isPrintingLogs() {\n        return isPrintingLogs;\n      },\n      get printLogs() {\n        return (isPrintingLogs = true);\n      },\n\n      onDispose: dispose.subscribe,\n      send,\n      log,\n      when,\n\n      sleep: (seconds: number) => {\n        checkNotAborted(context);\n        log('[SLEEP]', seconds);\n        return wait(seconds);\n      },\n\n      abort: () => {\n        if (isAborted) return;\n        isAborted = true;\n        this.emitInstanceAborted(context);\n      },\n\n      write: (command: string, options?: WriteOptions) => {\n        this.checkNotAborted(context);\n        log(`[WRITE]`, command);\n        send(command, options);\n      },\n    };\n\n    dispose.subscribe(() => subscriptions.forEach(x => x.unsubscribe()));\n    this.dispositions.set(context, dispose);\n    return context;\n\n    function log(...args: Parameters<Console['log']>) {\n      checkNotAborted(context);\n\n      if (isPrintingLogs) {\n        console.log(`[${name}]`, ...args);\n      }\n    }\n\n    function when(pattern: Pattern, options?: PatternOptions): PatternPromise;\n    function when(\n      pattern: Pattern,\n      handler: (result: PatternResult) => void,\n      options?: PatternOptions,\n    ): Subscription;\n    function when(\n      pattern: Pattern,\n      handler?: ((result: PatternResult) => void) | PatternOptions,\n      options?: PatternOptions,\n    ) {\n      checkNotAborted(context);\n      log('[WATCH]', pattern, options);\n\n      const onResult = isPrintingLogs\n        ? ({ patterns, ...rest }: PatternResult) =>\n            log('[TRIGGERED]', ...patterns, rest)\n        : null;\n\n      if (typeof handler === 'function') {\n        if (onResult) {\n          const original = handler;\n          handler = result => {\n            onResult(result);\n            original(result);\n          };\n        }\n\n        const subscription = triggers.add(pattern, handler, options);\n        subscriptions.push(subscription);\n        return subscription;\n      }\n\n      options = handler;\n      const promise = triggers.add(pattern, options);\n\n      if (onResult) {\n        promise.then(onResult);\n      }\n\n      subscriptions.push(promise);\n      return promise;\n    }\n  }\n\n  dispose(context: BasicContext) {\n    const dispose = this.dispositions.get(context);\n\n    if (!dispose) {\n      throw new Error(`Can't dispose context: ${context.name}`);\n    }\n\n    this.dispositions.delete(context);\n    dispose();\n    this.emitInstanceDisposed(context);\n  }\n\n  protected checkNotAborted(context: BasicContext) {\n    if (context.isAborted) {\n      throw new Error(`[${context.name}] Workflow aborted.`);\n    }\n  }\n}\n","import ALL_AREAS from './areas.json';\n\ntype AreaBase = typeof ALL_AREAS[number];\ntype Arena = string | string[];\n\nexport type Realm = AreaBase['realm'];\nexport type AreaName = AreaBase['name'];\nexport type Area = AreaBase & { path?: string; arena?: Arena };\n\nconst sides = 'e2we';\n\nconst ARENAS: Partial<Record<AreaName, Arena>> = {\n  // cadaver: { path: 'ru2sw'},\n  'Academia de Darkhaven': ['Xse', 'Xne', 'Xse', 'Xne', 'Xs'],\n  'El Gran Estadio': 'j',\n  'El Imperio Orco': [\n    `4n${sides}n`, // planta principal\n    `ds${sides}s${sides}s${sides}s${sides}Xnu`, // sotano\n    'uXs', // primer piso\n    `un${sides}n${sides}Xs`, // segundo piso\n    `un${sides}n${sides}nXsejk2whlen`, // tercer piso\n    `u3n${sides}2nXs`, // cuarto piso\n    `Xnu2s${sides}2ndXs`, // `Xnu2s${x}s3ndXs`, // cuarto piso parte 2 - we skip El Jefe\n    `un${sides}n${sides}n${sides}n${sides}Xs`, // quinto piso\n    `un${sides}n${sides}Xs`, // sexto piso\n    'uns', // uXnXs', // septimo piso // cerrado con llave\n    `un${sides}n${sides}2n`, // octavo piso\n    'u', // techo\n  ],\n  'El Pantano Orco': [\n    'wn2w',\n    'n3esje4n4sw',\n    '4nw3sw3nw3sw3nd',\n    '3es3w3es3w',\n    // 'Xs' // cerrado\n  ],\n  'La Mansion de Marmol': [\n    'e2n', // entrada\n    'n2d', // sotano\n    [\n      '3n3s',\n      '3e3w', // prisionera\n      '3w3e', // engendro\n      '3s3n',\n      '2us', // salir sotano\n    ].join(''),\n    '2e2w',\n    '4w4e',\n    '2unu', // Kivon & Nejane\n  ],\n  'La tumba de Damara': [\n    'nnwes', // despensa\n    'esn', // la prision\n    '2ln',\n  ],\n};\n\nexport function getAreasForLevel(realm: Realm, level: number) {\n  return (\n    ALL_AREAS.filter(x => x.realm === realm && x.from <= level && x.to >= level)\n      .sort((a, b) => a.to - b.to)\n      // .sort((a, b) => avg(a, level) - avg(b, level))\n      .map(getWithMetadata)\n  );\n\n  // function avg(area: AreaBase, level: number) {\n  //   return Math.abs(level - area.from + (level - area.to));\n  // }\n}\n\nexport function getAreaMetadata(areaName: string) {\n  const lower = areaName.toLowerCase();\n  const [first, ...candidates] = ALL_AREAS.filter(x =>\n    x.name.toLocaleLowerCase().includes(lower),\n  );\n\n  if (candidates.length) {\n    console.warn(\n      `Many areas detected for ${areaName}:\\n- ${[first, ...candidates]\n        .map(x => x.name)\n        .join('\\n- ')}`,\n    );\n  }\n\n  return first && getWithMetadata(first);\n}\n\nfunction getWithMetadata(area: AreaBase): Area {\n  if (area.name in ARENAS) {\n    return { ...area, arena: ARENAS[area.name] };\n  }\n\n  return area;\n}\n","import { emitter } from '@amatiasq/emitter';\n\nimport { Mud } from './lib/Mud';\nimport { RemoteTelnet } from './lib/RemoteTelnet';\nimport { registerWorkflows } from './registerWorkflows';\nimport { renderUserInterface } from './ui';\nimport { getPassword } from './util/getPassword';\nimport { getQueryParams } from './util/getQueryParams';\nimport { DEFAULT_PORT } from '../../config.json';\n\nlet FORCE_PROD_SERVER = false;\n// FORCE_PROD_SERVER = true;\n\nconst serverUri = getSocketUri();\nconst { host, port, user, pass } = getParams();\nconst { terminal, controls, sidebar } = renderUserInterface(document.body);\n\nopenSocket();\n\nwindow.addEventListener('unhandledrejection', event => {\n  const error = event.reason as Error;\n\n  if ((error as any) === 'aborted') {\n    event.preventDefault();\n  }\n\n  if (error && error.message && error.message.startsWith('Timeout: ')) {\n    event.preventDefault();\n    console.warn(error.message);\n  }\n});\n\nfunction openSocket() {\n  const socket = new WebSocket(serverUri);\n\n  // socket.addEventListener('close', openSocket);\n  socket.addEventListener('open', () => {\n    const telnet = new RemoteTelnet(socket);\n\n    telnet.connect(host, port);\n    terminal.write(`Connecting to ${host}:${port} as ${user}\\n`);\n\n    initializeMud(telnet);\n  });\n}\n\nasync function initializeMud(telnet: RemoteTelnet) {\n  const mud = new Mud(telnet);\n\n  mud.onCommand(x => terminal.write(`${x}\\n`));\n  telnet.onData(data => terminal.write(data));\n  terminal.onSubmit(onUserInput);\n\n  window.onbeforeunload = () => {\n    if (telnet.isConnected) {\n      telnet.send('abandonar');\n    }\n\n    telnet.close();\n  };\n\n  mud.registerHandler('!', command => {\n    const [workflow, ...args] = command.split(/\\s+/);\n    runWorkflow(workflow, args);\n  });\n\n  mud.registerHandler('#', command => {\n    const [trigger, action, permanent] = command.split(/#/).map(x => x.trim());\n    const name = `#${trigger}${permanent}`;\n    const run = () => onUserInput(action);\n\n    if (permanent != null) {\n      mud.daemon(name, ({ when, printLogs }) => when(trigger, run));\n    } else {\n      mud.runOnce(name, ({ when, printLogs }) => when(trigger).then(run));\n    }\n\n    terminal.write(`WHEN: ${trigger}\\nRUN: ${action}\\n`);\n  });\n\n  await mud.login(user, pass);\n  connectButtons();\n\n  if (user === 'may') {\n    registerWorkflows(mud);\n    await connectStats();\n  }\n\n  Object.assign(window, { mud });\n\n  function onUserInput(command: string) {\n    terminal.write(`${command}\\n`);\n\n    if (mud.userInput(command)) {\n      telnet.send(command);\n    }\n  }\n\n  async function connectStats() {\n    const hp = emitter<number>();\n    controls.addMeter('#550000', hp.subscribe);\n\n    const mana = emitter<number>();\n    controls.addMeter('#000055', mana.subscribe);\n\n    const mv = emitter<number>();\n    controls.addMeter('#005500', mv.subscribe);\n\n    mud.getPlugin('prompt').onUpdate(x => {\n      hp(x.hp.percent);\n      mana(x.mana.percent);\n      mv(x.mv.percent);\n    });\n  }\n\n  function connectButtons() {\n    mud.onWorkflowsChange(workflows => {\n      sidebar.setWorkflows(\n        workflows.sort((a, b) => (a.name < b.name ? -1 : 1)),\n        mud,\n      );\n    });\n  }\n\n  function runWorkflow(name: string, args: string[]) {\n    const cmd = `\"${name}\" with \"${args.join(' ')}\"`;\n    terminal.write(`-> Running ${cmd}\\n`);\n\n    mud\n      .getWorkflow(name)\n      .execute(...args)\n      .then(\n        x => terminal.write(`\\n<- Done ${cmd}: ${x}\\n`),\n        x => terminal.write(`\\n\\n<! FAILED ${cmd}: ${x.message}\\n\\n`),\n      );\n  }\n}\n\nfunction getSocketUri() {\n  return location.origin === 'https://amatiasq.github.io' || FORCE_PROD_SERVER\n    ? 'wss://mudOS.amatiasq.com'\n    : `ws://localhost:${DEFAULT_PORT}`;\n}\n\nfunction getParams() {\n  const { user, server } = getQueryParams();\n  const [host, port] = (server || 'mud.balzhur.org:5400').split(':');\n  const pass = getPassword(user);\n  return { host, port: parseInt(port, 10), user, pass };\n}\n","import { emitter } from '@amatiasq/emitter';\n\nimport { initializePlugins, PluginMap } from '../plugins/index';\nimport { login } from '../plugins/login';\nimport { BasicContextCreator } from './context/BasicContextCreator';\nimport {\n  WorkflowContext,\n  WorkflowContextCreator,\n} from './context/WorkflowContextCreator';\nimport { RemoteTelnet } from './RemoteTelnet';\nimport { TriggerCollection } from './triggers/TriggerCollection';\nimport { Workflow } from './workflow/Workflow';\nimport { WorkflowFn } from './workflow/WorkflowFn';\nimport { WriteOptions } from './WriteOptions';\n\nexport class Mud {\n  private readonly triggers = new TriggerCollection();\n  private readonly workflows = new Map<string, Workflow>();\n  private readonly contextCreator = new BasicContextCreator(\n    this.triggers,\n    this.send.bind(this),\n  );\n\n  private readonly handlers: {\n    id: string;\n    handler: (command: string) => void | true;\n  }[] = [];\n\n  private plugins!: PluginMap;\n  // private username!: string;\n\n  private readonly emitCommand = emitter<string>();\n  readonly onCommand = this.emitCommand.subscribe;\n\n  private readonly emitWorkflowsChange = emitter<Workflow[]>();\n  readonly onWorkflowsChange = this.emitWorkflowsChange.subscribe;\n\n  private emitLoggedIn!: (usernamne: string) => void;\n  readonly whenLoggedIn = new Promise(resolve => (this.emitLoggedIn = resolve));\n\n  constructor(private readonly telnet: RemoteTelnet) {\n    this.telnet.onData(x => this.triggers.process(removeNoise(x)));\n  }\n\n  async login(user: string, pass: string) {\n    const context = this.contextCreator.createInstance('login');\n\n    await login(context, user, pass, async () => {\n      this.plugins = await initializePlugins(\n        this.contextCreator.createInstance.bind(this.contextCreator),\n      );\n    });\n\n    this.contextCreator.dispose(context);\n    // this.username = user;\n    this.emitLoggedIn(user);\n  }\n\n  send(text: string, options: WriteOptions = {}) {\n    this.emitCommand(options.password ? '*'.repeat(text.length) : text);\n    this.telnet.send(text);\n  }\n\n  // User input\n\n  userInput(command: string): boolean {\n    const x = this.handlers.find(x => command.startsWith(x.id));\n    return Boolean(!x || x.handler(command.substr(x.id.length)));\n  }\n\n  registerHandler(\n    identifier: string,\n    handler: (command: string) => void | true,\n  ) {\n    this.handlers.push({ id: identifier, handler });\n  }\n\n  // Plugins\n\n  getPlugin<Name extends keyof PluginMap>(name: Name): PluginMap[Name] {\n    return this.plugins[name];\n  }\n\n  // Daemons\n\n  daemon(name: string, run: WorkflowFn<[]>) {\n    this.runOnce(name, async (context: WorkflowContext) => {\n      await run(context);\n      return context.runForever();\n    });\n  }\n\n  // Workflows\n\n  workflow(name: string, run: WorkflowFn<any[]>) {\n    const workflow = new Workflow(name, run, this.createContextCreator());\n    this.workflows.set(workflow.name, workflow);\n    this.emitWorkflowsChange([...this.workflows.values()]);\n    return workflow;\n  }\n\n  runOnce(name: string, run: WorkflowFn<[]>) {\n    return new Workflow(name, run, this.createContextCreator()).execute();\n  }\n\n  getWorkflow(workflowOrName: Workflow | string) {\n    if (workflowOrName instanceof Workflow) {\n      return workflowOrName;\n    }\n\n    if (!this.workflows.has(workflowOrName)) {\n      throw new Error(`Workflow \"${workflowOrName}\" is not registered.`);\n    }\n\n    return this.workflows.get(workflowOrName)!;\n  }\n\n  private createContextCreator() {\n    return new WorkflowContextCreator(this, this.triggers, this.plugins);\n  }\n}\n\nfunction removeNoise(text: string) {\n  return removeAsciiCodes(text).replace(/\\r/g, '');\n}\n\nlet stored = '';\n\nfunction removeAsciiCodes(text: string) {\n  if (stored) {\n    text = `${stored}${text}`;\n    stored = '';\n  }\n\n  const match = text.match(/\\u001b[^m]*?$/);\n\n  if (match) {\n    stored = match[0];\n    text = text.substr(0, text.length - stored.length);\n  }\n\n  return text.replace(/\\u001b\\[[^m]*?m/g, '');\n}\n","import { BasicContext } from '../lib/context/BasicContextCreator';\nimport { chatPlugin } from './chatPlugin';\nimport { inventoryPlugin } from './inventoryPlugin';\nimport { navigationPlugin } from './navigationPlugin';\nimport { promptPlugin } from './promptPlugin';\nimport { skillsPlugin } from './skillsPlugin';\nimport { statsPlugin } from './statsPlugin';\n\nconst plugins = {\n  chat: chatPlugin,\n  inventory: inventoryPlugin,\n  navigation: navigationPlugin,\n  prompt: promptPlugin,\n  skills: skillsPlugin,\n  stats: statsPlugin,\n};\n\n// -- Dirty implementation\n\ntype plugins = typeof plugins;\ntype UnPromisify<T> = T extends Promise<infer U> ? U : T;\n\nexport type PluginMap = {\n  [name in keyof plugins]: UnPromisify<ReturnType<plugins[name]>>;\n};\n\nexport async function initializePlugins(\n  context: (name: string) => BasicContext,\n) {\n  const promises = Object.entries(plugins).map(async ([name, plugin]) => [\n    name,\n    await plugin(context(name)),\n  ]);\n\n  const entries = await Promise.all(promises);\n  return Object.fromEntries(entries) as PluginMap;\n}\n","import { ClientStorage } from '@amatiasq/client-storage';\n\nimport { BasicContext } from '../lib/context/BasicContextCreator';\nimport { PatternResult } from '../lib/triggers/PatternResult';\nimport { datetime, DateTime } from '../lib/util/dateTime';\nimport { requestNotificationPermission } from '../lib/util/requestNotificationPermission';\n\ntype Message = [DateTime, string, string, string];\ntype History = ClientStorage<Message[]>;\n\nconst beepAudio = new Audio(\n  'data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=',\n);\n\nconst version = { version: 2 };\n\nconst receive = (log: History) => ({\n  groups: { name, message },\n}: PatternResult) => {\n  console.log(`MESSAGE => ${name} =>`, message);\n  addMessage(log, { from: name, message });\n\n  if (!name.startsWith('[Orden')) {\n    notify(`${name}: ${message}`);\n  }\n};\n\nconst sent = (log: History) => ({ groups: { name, message } }: PatternResult) =>\n  addMessage(log, { to: name, message });\n\nexport function chatPlugin({ when, write }: BasicContext) {\n  // const say = new ClientStorage<Record<string, Message[]>>('chat:say');\n  const order = new ClientStorage<Message[]>('chat:order', version);\n  const tell = new ClientStorage<Message[]>('chat:tell', version);\n  const whisper = new ClientStorage<Message[]>('chat:whisper', version);\n\n  (window as any).chat = () => ({\n    tell: tell.get(),\n    order: order.get(),\n    whisper: whisper.get(),\n  });\n\n  when(/(?<name>\\[Orden: [^\\]]+\\]): '(?<message>[^']+)'/, receive(order));\n  when(/(?<name>\\[Orden\\]): '(?<message>[^']+)'/, sent(order));\n\n  when(/(?<name>.+) te susurra '(?<message>[^']+)'/, receive(whisper));\n  when(/Susurras a (?<name>.+) '(?<message>[^']+)'/, sent(whisper));\n\n  const receiveTell = receive(tell);\n\n  when(\n    [\n      /(?<name>.+) te cuenta '(?<message>[^']+)'/,\n      /(?<name>.+) te responde '(?<message>[^']+)'/,\n    ],\n    result => {\n      receiveTell(result);\n      handleAutoResponses(result.groups);\n    },\n  );\n\n  when(\n    [\n      /Cuentas a (?<name>.+) '(?<message>[^']+)'/,\n      /Respondes a (?<name>.+) '(?<message>[^']+)'/,\n    ],\n    sent(tell),\n  );\n\n  when(/(?<name>\\w+) te ha desafiado a un combate en la arena!/, ({ groups }) =>\n    notify(`[ARENA] w/ ${groups.name}`),\n  );\n\n  function handleAutoResponses({ name, message }: Record<string, string>) {\n    const tokens = {\n      re: /^porfa re(sponde(me)?)? /,\n      [`tell ${name}`]: /^porfa di(me)? /,\n      [`susurrar ${name}`]: /^porfa susurra(me)? /,\n    };\n\n    for (const [response, token] of Object.entries(tokens)) {\n      if (token.test(message)) {\n        write(`${response} ${message.replace(token, '')}`);\n      }\n    }\n  }\n}\n\ntype msg = { message: string };\n\nasync function notify(content: string) {\n  beepAudio.play();\n  await requestNotificationPermission();\n  return new Notification(content);\n}\n\nfunction addMessage(log: History, partial: { from: string } & msg): Message;\nfunction addMessage(log: History, partial: { to: string } & msg): Message;\nfunction addMessage(\n  log: History,\n  partial: { from?: string; to?: string } & msg,\n): Message {\n  const message: Message = [\n    datetime(new Date()),\n    partial.from || 'me',\n    partial.to || 'me',\n    partial.message,\n  ];\n\n  log.set([...(log.get() || []), message]);\n  return message;\n}\n","const pad = (val: number) => (val < 10 ? `0${val}` : val);\n\nexport type DateTime = '[string DateTime]';\n\nexport function datetime(date: Date) {\n  const yyyy = date.getFullYear();\n  const MM = pad(date.getMonth() + 1);\n  const dd = pad(date.getDate());\n  const hh = pad(date.getHours());\n  const mm = pad(date.getMinutes());\n\n  return `${yyyy}-${MM}-${dd} ${hh}:${mm}` as DateTime;\n}\n","export function requestNotificationPermission() {\n  if (!('Notification' in window)) {\n    console.warn('This browser does not support desktop notification');\n    return;\n  }\n\n  if (Notification.permission === 'granted') {\n    return Promise.resolve(true);\n  }\n\n  if (Notification.permission === 'denied') {\n    return;\n  }\n\n  return Notification.requestPermission().then(x => x === 'granted');\n}\n","import { BasicContext } from '../lib/context/BasicContextCreator';\nimport {\n  concatRegexes,\n  concatRegexesUnescaped,\n} from '../lib/util/concatRegexes';\nimport { int, toInt } from '../lib/util/int';\nimport { singleExecution } from '../lib/util/singleExecution';\n\ninterface ItemData {\n  amount: number;\n  effects: string[];\n}\n\ntype ItemList = Record<string, ItemData>;\ntype ItemSearch = string | string[] | Record<string, string>;\n\nconst CONTENT = /\\n(?<content>(?:.|\\n)*)\\n[^ ]/;\nconst INVENTORY_DETECTOR = concatRegexes(/Estas llevando:/, CONTENT);\nconst ITEM_EFECTS = /(?<effects>(?:\\(\\w[^\\)]+\\w\\) )*)/;\nconst ITEM_AMOUNT = concatRegexesUnescaped('(?: \\\\(', int('amount'), '\\\\))?');\nconst ITEM_MATCHER = concatRegexes(\n  /^/,\n  ITEM_EFECTS,\n  /(?<name>\\w[^\\(\\)]*\\w)/,\n  ITEM_AMOUNT,\n  /$/,\n);\n\nexport function inventoryPlugin({ when, write }: BasicContext) {\n  let isInitialized = false;\n  let items: ItemList = {};\n\n  const refresh = singleExecution(async () => {\n    write('inventario');\n    await when(INVENTORY_DETECTOR);\n  });\n\n  when('No tienes ese objeto.', refresh);\n\n  when(\n    INVENTORY_DETECTOR,\n    ({ groups }) => {\n      isInitialized = true;\n      items = parseItems(groups.content);\n    },\n    { captureLength: 1000 },\n  );\n\n  return { refresh, has, hasIn, hasInBackpack: hasIn.bind(null, 'mochila') };\n\n  async function has(search: ItemSearch) {\n    if (!isInitialized) {\n      await refresh();\n    }\n\n    return searchInList(items, search);\n  }\n\n  async function hasIn(container: string, search: ItemSearch) {\n    write(`examinar ${container}`);\n\n    const match = await Promise.any([\n      when('No ves eso aqui.').then(() => null),\n      when(concatRegexes(/Cuando miras dentro ves:\\n.+ contiene:/, CONTENT), {\n        captureLength: 1000,\n      }),\n    ]);\n\n    if (!match) {\n      return false;\n    }\n\n    const items = parseItems(match.groups.content);\n    console.log('IN', container, items);\n    return searchInList(items, search);\n  }\n\n  function parseItems(captured: string) {\n    const list = captured\n      .split('\\n')\n      .map(x => x.trim())\n      .filter(Boolean);\n\n    const result: ItemList = {};\n\n    for (const item of list) {\n      if (item === 'Nada.') {\n        return {};\n      }\n\n      const match = item.match(ITEM_MATCHER);\n\n      if (!match) {\n        console.error(`Can't match item \"${item}\"`);\n        continue;\n      }\n\n      const { effects, name, amount } = match.groups!;\n\n      result[name] = {\n        amount: amount ? toInt(amount) : 1,\n        effects: effects\n          .replace(/^\\s*\\(|\\)\\s*$/g, '')\n          .split(') (')\n          .filter(Boolean),\n      };\n    }\n\n    return result;\n  }\n\n  function searchInList(items: ItemList, search: ItemSearch) {\n    if (typeof search === 'string') {\n      return items[search] ? search : null;\n    }\n\n    if (Array.isArray(search)) {\n      return search.find(x => items[x]) || null;\n    }\n\n    const key = Object.keys(search).find(x => items[x]);\n    return key ? search[key] : null;\n  }\n}\n","import { emitter } from '@amatiasq/emitter';\n\nimport { Realm } from '../data/areas';\nimport { BasicContext } from '../lib/context/BasicContextCreator';\nimport { PatternPromise } from '../lib/triggers/PatternPromise';\nimport { PROMPT_DETECTOR } from './promptPlugin';\n\nconst CLOSED = '(cerrada)';\nconst aliases = {\n  s: 'sur',\n  n: 'norte',\n  e: 'este',\n  w: 'oeste',\n  o: 'oeste',\n  u: 'arriba',\n  d: 'abajo',\n  l: 'sureste',\n  k: 'suroeste',\n  j: 'noreste',\n  h: 'noroeste',\n};\n\nconst recalls = [\n  /Plaza de Darkhaven\\s+/,\n  /Templo de la Justicia\\s+/,\n  /Templo de las Tinieblas\\s+/,\n];\n\nexport function navigationPlugin({ log, when, write }: BasicContext) {\n  let isNavigating = false;\n  let landingAtRecall = false;\n  let isAtRecall = false;\n  let directions: string[] = [];\n\n  const prompt = () => when(PROMPT_DETECTOR);\n  const roomChanged = emitter<string[]>();\n\n  when(recalls, () => (landingAtRecall = true));\n\n  when([/Puerta \\w+ esta cerrada./, /Puertas? esta cerrada\\./], async () => {\n    const closed = directions.find(x => x.includes(CLOSED));\n\n    if (closed) {\n      const dir = closed.replace(CLOSED, '');\n      write(`abrir ${dir}`);\n\n      const result = await Promise.any([\n        when('Esta cerrada con llave.').then(() => false),\n        when('Abres ').then(() => true),\n      ]);\n\n      if (result) {\n        write(dir);\n      }\n    }\n  });\n\n  when(/\\nSalidas: ([^\\.]+)/, async ({ captured }) => {\n    directions = captured[1].split(' ');\n    isNavigating = false;\n    isAtRecall = landingAtRecall;\n    landingAtRecall = false;\n    await prompt();\n    roomChanged(directions);\n  });\n\n  return {\n    canGo,\n    go,\n    execute,\n    getRealm,\n    recall,\n    waitForRecall,\n    onRoomChange: roomChanged.subscribe,\n\n    get isNavigating() {\n      return isNavigating;\n    },\n\n    get isAtRecall() {\n      return isAtRecall;\n    },\n  };\n\n  async function recall() {\n    if (isAtRecall) {\n      return true;\n    }\n\n    write('recall');\n    await when(recalls);\n    await prompt();\n  }\n\n  function waitForRecall() {\n    if (isAtRecall) {\n      return new PatternPromise(resolve => resolve());\n    }\n\n    return when(recalls);\n  }\n\n  function canGo(direction: string) {\n    return Boolean(get(direction));\n  }\n\n  function isClosed(direction: string) {\n    const dir = get(direction);\n    return dir && dir.includes(CLOSED);\n  }\n\n  async function execute(pattern: string, callback?: () => Promise<any>) {\n    if (pattern[0] === 'r') {\n      await recall();\n      pattern = pattern.substr(1);\n    }\n\n    let untilEnd = false;\n    let done = '';\n\n    for (const step of parsePath(pattern)) {\n      if (step.toUpperCase() === 'X') {\n        untilEnd = true;\n        done += '(X)';\n        continue;\n      }\n\n      if (untilEnd) {\n        while (canGo(step)) {\n          if (await move(step)) {\n            return false;\n          }\n        }\n\n        untilEnd = false;\n      } else {\n        if (await move(step)) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n\n    async function move(step: string) {\n      try {\n        if (!(await go(step))) {\n          return true;\n        }\n        done += step;\n      } catch (error) {\n        throw new Error(`${error.message} - on ${pattern} - ${done}`);\n      }\n\n      if (typeof callback === 'function') {\n        const result = await callback();\n        return result === false;\n      }\n    }\n  }\n\n  async function go(direction: string) {\n    if (isNavigating) {\n      throw new Error('WTF DUDE');\n    }\n\n    const dir = get(direction);\n\n    if (!dir) {\n      throw new Error(`Unknown direction '${direction}'`);\n    }\n\n    if (isClosed(direction)) {\n      write(`abrir ${direction}`);\n\n      const success = await Promise.any([\n        when([/Abres la puertas?\\./, /Abres la puerta \\w+\\./]).then(() => true),\n        when('Esta cerrada con llave.').then(() => false),\n      ]);\n\n      if (!success) {\n        log('Can\\t open door');\n        return false;\n      }\n    }\n\n    write(dir.replace(CLOSED, '').trim());\n    isNavigating = true;\n\n    await when('\\nSalidas:');\n    await prompt();\n\n    isNavigating = false;\n    return true;\n  }\n\n  async function getRealm() {\n    write('donde');\n    const result = await when(\n      /Jugadores cerca de ti en [^,]+, Reino de (?<realm>\\w+):/,\n    );\n    return result.groups.realm as Realm;\n  }\n\n  function get(direction: string) {\n    if (direction in aliases) {\n      direction = aliases[direction as keyof typeof aliases];\n    }\n\n    return directions.find(x => x.startsWith(direction));\n  }\n}\n\nfunction parsePath(path: string) {\n  return path.replace(/(\\d+)(\\w)/g, (_, times, dir) => dir.repeat(times));\n}\n","import {\n  Casteable,\n  getSpell,\n  SkillName,\n  Spell,\n  SPELL_ALREADY_APPLIED,\n  SPELL_FAILED,\n  SPELL_NOT_POSSIBLE,\n} from '../data/spells';\nimport { BasicContext } from '../lib/context/BasicContextCreator';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { singleExecution } from '../lib/util/singleExecution';\n\n// Skill cast results\n// const TIMEOUT = 0;\nconst NOT_AVAILABLE = undefined;\nconst BUSY = null;\nconst FAILED = false;\nconst CASTED = true;\nconst ALREADY_APPLIED = 1;\n\nexport type CastSpellResult =\n  | typeof NOT_AVAILABLE\n  | typeof BUSY\n  | typeof FAILED\n  | typeof CASTED\n  | typeof ALREADY_APPLIED;\n\nexport type MeditationResult =\n  | typeof NOT_AVAILABLE\n  | typeof BUSY\n  | typeof FAILED\n  | typeof CASTED;\n\nconst SKILL = /((?:\\w+ )+)\\s+(\\d+)%/g;\nconst SKILLS_DETECTOR = concatRegexes(\n  /-+\\[(\\w+)\\]-+\\n/,\n  /(.|\\n)+/,\n  /Te quedan \\d+ practicas.\\n/,\n  /Tienes \\d+ entrenamientos.\\n/,\n);\n\nexport function skillsPlugin({ when, write }: BasicContext) {\n  let isInitialized = false;\n  let isSpellRunning = false;\n  let isMeditating = false;\n  let skills: Record<string, number> = {};\n\n  const refresh = singleExecution(() => {\n    write('practicar');\n    return when(SKILLS_DETECTOR);\n  });\n\n  when(\n    SKILLS_DETECTOR,\n    ({ captured: [content] }) => {\n      for (const skill of content.matchAll(SKILL)!) {\n        skills[skill[1].trim()] = parseInt(skill[2], 10);\n      }\n\n      isInitialized = true;\n    },\n    { captureLength: 5000 },\n  );\n\n  return {\n    can,\n    canLearn,\n    castSpell,\n    meditate,\n    polimorfar,\n    NOT_AVAILABLE,\n    BUSY,\n    FAILED,\n    CASTED,\n    ALREADY_APPLIED,\n  };\n\n  async function can(search: SkillName | SkillName[]) {\n    await ensureInitiated();\n\n    if (typeof search === 'string') {\n      return hasSync(search) ? search : null;\n    } else {\n      return search.find(hasSync) || null;\n    }\n  }\n\n  function hasSync(name: string) {\n    return skills[name];\n  }\n\n  async function canLearn(name: string) {\n    await ensureInitiated();\n    return name in skills;\n  }\n\n  function ensureInitiated() {\n    if (!isInitialized) {\n      return refresh();\n    }\n  }\n\n  async function meditate() {\n    if (!(await can('meditar'))) return NOT_AVAILABLE;\n    if (isSpellRunning) return BUSY;\n    if (isMeditating) return waitResponse();\n\n    isMeditating = true;\n    write('meditar');\n    return waitResponse().finally(() => (isMeditating = false));\n\n    function waitResponse() {\n      return Promise.any([\n        when(\n          'Meditas con total paz interior, recolectando mana del cosmos.',\n        ).then(() => CASTED),\n        when(\n          'Te pasas varios minutos en profunda concentracion, pero fallas en el intento de recolectar mana.',\n        ).then(() => FAILED),\n      ]).finally();\n    }\n  }\n\n  async function castSpell(name: Casteable, args = '') {\n    const aliases = Array.isArray(name) ? name : [name];\n    const candidates = aliases.map(getSpell).filter(Boolean) as Spell[];\n\n    const learnt = await can(candidates.map(x => x.name));\n    if (!learnt) return NOT_AVAILABLE;\n\n    const spell = candidates.find(x => x.name === learnt)!;\n    const success = args ? spell.target : spell.success;\n\n    if (!success) {\n      throw new Error(\n        `Unknown response for spell \"${name}\" (${spell.name}).` +\n          (args ? ` With target \"${args}\"` : ''),\n      );\n    }\n\n    if (isSpellRunning || isMeditating) {\n      return BUSY;\n    }\n\n    const canCreateBerry = await can('crear baya');\n    isSpellRunning = true;\n    write(`conjurar \"${spell.name}\" ${args}`);\n\n    const promises: Promise<CastSpellResult>[] = [\n      when(success).then(() => CASTED),\n      // when('Falta algo...').then(() => )\n      when(SPELL_NOT_POSSIBLE).then(() => NOT_AVAILABLE),\n      when(SPELL_ALREADY_APPLIED).then(() => ALREADY_APPLIED),\n      when(SPELL_FAILED)\n        .wait(4)\n        .then(() => FAILED),\n    ];\n\n    if (spell.target) {\n      promises.push(when(spell.target).then(() => CASTED));\n    }\n\n    const result = await Promise.any(promises);\n    isSpellRunning = false;\n    return result;\n  }\n\n  async function polimorfar(level: number) {\n    const options: [number, string][] = [\n      [20, 'Gato'],\n      [23, 'Aguila'],\n      [25, 'Serpiente'],\n      [30, 'Lobo'],\n      [35, 'Tortuga'],\n      [40, 'Cocodrilo'],\n      [45, 'Oso'],\n      [50, 'Pegaso'],\n      [55, 'Elem aire'],\n      [60, 'Elem tierra'],\n      [65, 'Ent'],\n    ];\n\n    const target = options.reverse().find(([minLevel]) => level >= minLevel);\n    return target && castSpell('polimorfar', target[1]);\n  }\n}\n","export default [\n  {\n    level: 1,\n    type: 'Hechizo',\n    name: 'armadura',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 1,\n    type: 'Hechizo',\n    name: 'causar leve',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'carpinteria',\n    minPos: 'de pie',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'cocinar',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'despellejar',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'estilo estandar',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'estilo evasivo',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'forjar',\n    minPos: 'de pie',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'minar',\n    minPos: 'de pie',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'pescar',\n    minPos: 'de pie',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'talar',\n    minPos: 'de pie',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'tallar',\n    minPos: 'de pie',\n  },\n  {\n    level: 1,\n    type: 'Habilidad',\n    name: 'tejer',\n    minPos: 'de pie',\n  },\n  {\n    level: 1,\n    type: 'Arma',\n    name: 'armas cortas',\n  },\n  {\n    level: 1,\n    type: 'Arma',\n    name: 'armas flexibles',\n  },\n  {\n    level: 1,\n    type: 'Arma',\n    name: 'armas impacto',\n  },\n  {\n    level: 1,\n    type: 'Arma',\n    name: 'armas largas',\n  },\n  {\n    level: 1,\n    type: 'Arma',\n    name: 'garras',\n  },\n  {\n    level: 1,\n    type: 'Arma',\n    name: 'pugilismo',\n  },\n  { level: 1, type: 'Idioma', name: 'comun' },\n  { level: 1, type: 'Idioma', name: 'elfico' },\n  {\n    level: 1,\n    type: 'Idioma',\n    name: 'enano',\n  },\n  {\n    level: 1,\n    type: 'Idioma',\n    name: 'goblin',\n  },\n  {\n    level: 1,\n    type: 'Idioma',\n    name: 'ogro',\n  },\n  {\n    level: 1,\n    type: 'Idioma',\n    name: 'orco',\n  },\n  {\n    level: 1,\n    type: 'Idioma',\n    name: 'troll',\n  },\n  {\n    level: 2,\n    type: 'Hechizo',\n    name: 'crear agua',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 2,\n    type: 'Hechizo',\n    name: 'curar leves',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 2,\n    type: 'Hechizo',\n    name: 'luz eterna',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 2,\n    type: 'Habilidad',\n    name: 'cartografia',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 2,\n    type: 'Habilidad',\n    name: 'cavar',\n    minPos: 'de pie',\n  },\n  {\n    level: 3,\n    type: 'Hechizo',\n    name: 'crear comida',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 3,\n    type: 'Hechizo',\n    name: 'detectar magia',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 4,\n    type: 'Hechizo',\n    name: 'detectar invisible',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 4,\n    type: 'Hechizo',\n    name: 'fuego espectral',\n    minPos: 'luchando',\n  },\n  {\n    level: 4,\n    type: 'Habilidad',\n    name: 'montar',\n    minPos: 'de pie',\n  },\n  {\n    level: 5,\n    type: 'Hechizo',\n    name: 'bendecir',\n    minPos: 'luchando',\n  },\n  {\n    level: 5,\n    type: 'Hechizo',\n    name: 'causar grave',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 5,\n    type: 'Hechizo',\n    name: 'ceguera',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 5,\n    type: 'Hechizo',\n    name: 'curar ceguera',\n    minPos: 'luchando',\n  },\n  {\n    level: 5,\n    type: 'Hechizo',\n    name: 'detectar maldad',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 6,\n    type: 'Hechizo',\n    name: 'crear fuego',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 6,\n    type: 'Hechizo',\n    name: 'flotar',\n    minPos: 'luchando',\n  },\n  {\n    level: 6,\n    type: 'Habilidad',\n    name: 'buscar',\n    minPos: 'de pie',\n  },\n  {\n    level: 6,\n    type: 'Habilidad',\n    name: 'escalar',\n    minPos: 'de pie',\n  },\n  {\n    level: 6,\n    type: 'Habilidad',\n    name: 'patada',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 6,\n    type: 'Habilidad',\n    name: 'primeros auxilios',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 7,\n    type: 'Hechizo',\n    name: 'refrescar',\n    minPos: 'luchando',\n  },\n  {\n    level: 7,\n    type: 'Habilidad',\n    name: 'danyo incrementado',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 7,\n    type: 'Habilidad',\n    name: 'estilo agresivo',\n  },\n  {\n    level: 8,\n    type: 'Hechizo',\n    name: 'curar veneno',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 8,\n    type: 'Hechizo',\n    name: 'detectar escondido',\n    minPos: 'de pie',\n  },\n  {\n    level: 8,\n    type: 'Hechizo',\n    name: 'detectar trampas',\n    minPos: 'de pie',\n  },\n  {\n    level: 8,\n    type: 'Hechizo',\n    name: 'terremoto',\n    minPos: 'luchando',\n  },\n  {\n    level: 9,\n    type: 'Hechizo',\n    name: 'causar critica',\n    minPos: 'luchando',\n  },\n  {\n    level: 9,\n    type: 'Hechizo',\n    name: 'conocer alineamiento',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 9,\n    type: 'Hechizo',\n    name: 'misil magico',\n    minPos: 'luchando',\n  },\n  {\n    level: 9,\n    type: 'Hechizo',\n    name: 'volar',\n    minPos: 'luchando',\n  },\n  {\n    level: 10,\n    type: 'Hechizo',\n    name: 'crear baya',\n    minPos: 'ninguna',\n  },\n  {\n    level: 10,\n    type: 'Hechizo',\n    name: 'crear manantial',\n    minPos: 'luchando',\n  },\n  {\n    level: 10,\n    type: 'Hechizo',\n    name: 'curar graves',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 10,\n    type: 'Hechizo',\n    name: 'invisibilidad',\n    minPos: 'de pie',\n  },\n  {\n    level: 10,\n    type: 'Hechizo',\n    name: 'invocar armadillo',\n    minPos: 'de pie',\n  },\n  {\n    level: 10,\n    type: 'Hechizo',\n    name: 'veneno',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 11,\n    type: 'Hechizo',\n    name: 'niebla espectral',\n    minPos: 'de pie',\n  },\n  {\n    level: 11,\n    type: 'Hechizo',\n    name: 'proteccion',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 12,\n    type: 'Hechizo',\n    name: 'curar criticas',\n    minPos: 'luchando',\n  },\n  {\n    level: 12,\n    type: 'Hechizo',\n    name: 'disipar maldad',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 12,\n    type: 'Hechizo',\n    name: 'llamar rayo',\n    minPos: 'luchando',\n  },\n  {\n    level: 12,\n    type: 'Hechizo',\n    name: 'maldecir',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 13,\n    type: 'Hechizo',\n    name: 'bola fuego',\n    minPos: 'luchando',\n  },\n  {\n    level: 13,\n    type: 'Hechizo',\n    name: 'control climatico',\n    minPos: 'de pie',\n  },\n  {\n    level: 13,\n    type: 'Hechizo',\n    name: 'detectar veneno',\n    minPos: 'de pie',\n  },\n  {\n    level: 13,\n    type: 'Hechizo',\n    name: 'identificar',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 13,\n    type: 'Hechizo',\n    name: 'localizar objeto',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 14,\n    type: 'Hechizo',\n    name: 'disipar magia',\n    minPos: 'luchando',\n  },\n  {\n    level: 14,\n    type: 'Hechizo',\n    name: 'piel robliza',\n    minPos: 'de pie',\n  },\n  {\n    level: 14,\n    type: 'Hechizo',\n    name: 'retirar invisibilidad',\n    minPos: 'de pie',\n  },\n  {\n    level: 14,\n    type: 'Hechizo',\n    name: 'saciar hambre',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 15,\n    type: 'Hechizo',\n    name: 'debilitar',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 15,\n    type: 'Hechizo',\n    name: 'relampago',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 15,\n    type: 'Habilidad',\n    name: 'manotazo',\n    minPos: 'luchando',\n  },\n  {\n    level: 15,\n    type: 'Habilidad',\n    name: 'otear',\n    minPos: 'de pie',\n  },\n  {\n    level: 15,\n    type: 'Habilidad',\n    name: 'pisoton',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 15,\n    type: 'Habilidad',\n    name: 'segundo ataque',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 16,\n    type: 'Hechizo',\n    name: 'golpe flamigero',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 16,\n    type: 'Habilidad',\n    name: 'meditar',\n    minPos: 'descansando',\n  },\n  {\n    level: 17,\n    type: 'Hechizo',\n    name: 'causar fatales',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 17,\n    type: 'Hechizo',\n    name: 'retirar maldicion',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 17,\n    type: 'Hechizo',\n    name: 'sonyar',\n    minPos: 'de pie',\n  },\n  {\n    level: 17,\n    type: 'Hechizo',\n    name: 'vista distancia',\n    minPos: 'luchando',\n  },\n  {\n    level: 17,\n    type: 'Habilidad',\n    name: 'estilo defensivo',\n  },\n  {\n    level: 17,\n    type: 'Habilidad',\n    name: 'sigilo',\n    minPos: 'de pie',\n  },\n  {\n    level: 18,\n    type: 'Hechizo',\n    name: 'agarron impactante',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 18,\n    type: 'Hechizo',\n    name: 'respiracion acuatica',\n    minPos: 'de pie',\n  },\n  {\n    level: 18,\n    type: 'Hechizo',\n    name: 'retirar trampa',\n    minPos: 'de pie',\n  },\n  {\n    level: 19,\n    type: 'Hechizo',\n    name: 'sanar',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 20,\n    type: 'Hechizo',\n    name: 'fuerza vampirica',\n    minPos: 'luchando',\n  },\n  {\n    level: 20,\n    type: 'Hechizo',\n    name: 'invisibilidad grupo',\n    minPos: 'de pie',\n  },\n  {\n    level: 20,\n    type: 'Hechizo',\n    name: 'invocar lince',\n    minPos: 'de pie',\n  },\n  {\n    level: 20,\n    type: 'Hechizo',\n    name: 'invocar regreso',\n    minPos: 'descansando',\n  },\n  {\n    level: 20,\n    type: 'Hechizo',\n    name: 'polimorfar',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 20,\n    type: 'Habilidad',\n    name: 'rescatar',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 21,\n    type: 'Habilidad',\n    name: 'desarmar',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 22,\n    type: 'Hechizo',\n    name: 'rayo solar',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 24,\n    type: 'Hechizo',\n    name: 'atravesar puerta',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 24,\n    type: 'Hechizo',\n    name: 'furia naturaleza',\n    minPos: 'ninguna',\n  },\n  {\n    level: 25,\n    type: 'Hechizo',\n    name: 'escudo hielo',\n    minPos: 'de pie',\n  },\n  {\n    level: 26,\n    type: 'Habilidad',\n    name: 'esquivar',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 28,\n    type: 'Habilidad',\n    name: 'estilo berserk',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 30,\n    type: 'Hechizo',\n    name: 'encantar arma',\n    minPos: 'de pie',\n  },\n  {\n    level: 30,\n    type: 'Hechizo',\n    name: 'invocar aguila',\n    minPos: 'de pie',\n  },\n  {\n    level: 30,\n    type: 'Hechizo',\n    name: 'santuario',\n    minPos: 'de pie',\n  },\n  {\n    level: 30,\n    type: 'Habilidad',\n    name: 'tercer ataque',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 31,\n    type: 'Hechizo',\n    name: 'viajar',\n    minPos: 'de pie',\n  },\n  {\n    level: 32,\n    type: 'Hechizo',\n    name: 'relentizar',\n    minPos: 'luchando',\n  },\n  {\n    level: 34,\n    type: 'Hechizo',\n    name: 'dormir',\n    minPos: 'de pie',\n  },\n  {\n    level: 35,\n    type: 'Hechizo',\n    name: 'atravesar vegetacion',\n    minPos: 'de pie',\n  },\n  {\n    level: 35,\n    type: 'Hechizo',\n    name: 'drenar energia',\n    minPos: 'luchando',\n  },\n  {\n    level: 35,\n    type: 'Hechizo',\n    name: 'escudo flamigero',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 35,\n    type: 'Hechizo',\n    name: 'metal ardiente',\n    minPos: 'luchando',\n  },\n  {\n    level: 35,\n    type: 'Hechizo',\n    name: 'piel petrea',\n    minPos: 'luchando',\n  },\n  {\n    level: 35,\n    type: 'Habilidad',\n    name: 'rastrear',\n    minPos: 'de pie',\n  },\n  {\n    level: 40,\n    type: 'Hechizo',\n    name: 'escudo',\n    minPos: 'luchando',\n  },\n  {\n    level: 40,\n    type: 'Hechizo',\n    name: 'invocar lobo',\n    minPos: 'de pie',\n  },\n  {\n    level: 40,\n    type: 'Habilidad',\n    name: 'parada',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 42,\n    type: 'Hechizo',\n    name: 'enredo vegetal',\n    minPos: 'ninguna',\n  },\n  {\n    level: 43,\n    type: 'Hechizo',\n    name: 'transporte arboreo',\n    minPos: 'ninguna',\n  },\n  {\n    level: 45,\n    type: 'Hechizo',\n    name: 'escudo electrico',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 45,\n    type: 'Hechizo',\n    name: 'nube aturdidora',\n    minPos: 'de pie',\n  },\n  {\n    level: 45,\n    type: 'Habilidad',\n    name: 'cuarto ataque',\n    minPos: 'luchando (berserk)',\n  },\n  {\n    level: 45,\n    type: 'Habilidad',\n    name: 'esconderse',\n    minPos: 'de pie',\n  },\n  {\n    level: 48,\n    type: 'Hechizo',\n    name: 'vision verdadera',\n    minPos: 'de pie',\n  },\n  {\n    level: 50,\n    type: 'Hechizo',\n    name: 'invocar jaguar',\n    minPos: 'de pie',\n  },\n  {\n    level: 50,\n    type: 'Hechizo',\n    name: 'teleportar',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 51,\n    type: 'Hechizo',\n    name: 'cantico',\n    minPos: 'luchando (evasivo)',\n  },\n  {\n    level: 51,\n    type: 'Habilidad',\n    name: 'punyo_helado',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 52,\n    type: 'Hechizo',\n    name: 'crear arbol',\n    minPos: 'ninguna',\n  },\n  {\n    level: 52,\n    type: 'Hechizo',\n    name: 'destruir maldad',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 52,\n    type: 'Habilidad',\n    name: 'punyo_electrico',\n    minPos: 'luchando (agresivo)',\n  },\n  {\n    level: 54,\n    type: 'Hechizo',\n    name: 'maremoto',\n    minPos: 'luchando',\n  },\n  {\n    level: 57,\n    type: 'Hechizo',\n    name: 'vara robliza',\n    minPos: 'ninguna',\n  },\n  {\n    level: 60,\n    type: 'Hechizo',\n    name: 'delirio caotico',\n    minPos: 'luchando',\n  },\n  {\n    level: 60,\n    type: 'Hechizo',\n    name: 'invocar oso',\n    minPos: 'de pie',\n  },\n  {\n    level: 60,\n    type: 'Hechizo',\n    name: 'rafaga viento',\n    minPos: 'luchando',\n  },\n  {\n    level: 62,\n    type: 'Hechizo',\n    name: 'relampago helado',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 63,\n    type: 'Hechizo',\n    name: 'clonacion',\n    minPos: 'luchando (defensivo)',\n  },\n  {\n    level: 67,\n    type: 'Hechizo',\n    name: 'tormenta hielo',\n    minPos: 'luchando (berserk)',\n  },\n] as const;\n","import { BasicContext } from '../lib/context/BasicContextCreator';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { int, toInt } from '../lib/util/int';\n\nconst SIZE = 3000;\n\nconst STATE_DETECTOR = (() => {\n  type Args = Parameters<typeof concatRegexes>;\n  const r = concatRegexes;\n  const low = (x: string) => x.toLowerCase();\n\n  const ANY = /(?:.|\\n)+?/;\n  const DASH = /\\-{78}/;\n  const SPACE = /\\s+/;\n  const PIPE = /\\s+\\|\\s+/;\n  const SPACER = /\\|\\|-{36}\\+-{41}\\|\\|\\n/;\n\n  const row = (...content: Args) => r(/\\|\\|\\s*/, ...content, /\\s*\\|\\|\\n/);\n  const stat = (key: string) =>\n    r(key, /\\s+: /, int(low(key)), /\\(/, int(`${low(key)}Base`), /\\)/);\n\n  const percent = (key: string) =>\n    r(\n      key,\n      /\\s+: /,\n      int(low(key)),\n      /\\s+\\//,\n      int(`${low(key)}Base`),\n      /\\s+\\(\\s*/,\n      int(`${low(key)}Regen`),\n      /%\\) (?:Regen)?/,\n    );\n\n  return r(\n    DASH,\n    /\\n ?\\/\\s{78}\\\\\\n/,\n    row(/Ficha de (?<name>\\w+)(?<principal> \\(Personaje Principal\\))\\./),\n    row(DASH),\n    row(stat('FUE'), SPACE, stat('DES'), PIPE, percent('Vida')),\n    row(stat('INT'), SPACE, stat('SAB'), PIPE, percent('Mana')),\n    row(stat('CON'), SPACE, stat('CAR'), PIPE, percent('Mov')),\n    row(stat('SUE'), SPACE, PIPE, SPACE),\n    SPACER,\n    r(/\\|\\|\\s*Nivel\\s+: /, int('level'), ANY),\n    // ANY,\n    // / \\|\\|\\n\\\\\\s{78}\\/\\n  /,\n    // DASH,\n  );\n\n  /*\n    ------------------------------------------------------------------------------\n  /                                                                              \\\n  ||  Ficha de May (Personaje Principal).                                         ||\n  ||------------------------------------------------------------------------------||\n  || FUE      : 17(16)   DES   : 17(15) | Vida      : 362  /362   ( 0%) Regen     ||\n  || INT      : 20(18)   SAB   : 17(16) | Mana      : 359  /359   ( 0%)           ||\n  || CON      : 15(15)   CAR   : 15(15) | Mov       : 250  /250   ( 0%)           ||\n  || SUE      : 14(14)                  |                                         ||\n  ||------------------------------------+-----------------------------------------||\n  || Nivel    : 15      Edad   : 68     | Profesion : Druida   Raza: Medio-Elfo   ||\n  || Hitroll  : 19      Damroll: 18     | Objetos   : 1    /8                     ||\n  || Armadura : -13     Alin   : 40     | Peso      : 36   /220                   ||\n  || Impacto  : 22 %    Dao   : 11     | Posicion  : de pie                      ||\n  || Esquivar : 12 %    Parada : 12 %   | Estilo    : estandar                    ||\n  || Huida    : 0       Horas  : 102    | Mision    : 0 /15   Quest: 0    (0 /50) ||\n  ||------------------------------------+-----------------------------------------||\n  || FISIC Dao/Res/Crit:   0%/  0%/ 3% |            Salvaciones                  ||\n  || MAGIA Dao/Res/Crit:   0%/  0%/ 3% | Veneno       : 5        Fuego    : -3   ||\n  || CURAS Dar / Recibir:   0%/  0%     | Acido/Paral  : 0        Frio     : 0    ||\n  || EXP : 4,202,269     Pract : 12     | Energia/Elec : 0                        ||\n  || ORO : 63,593        Entr  : 26     |                                         ||\n  || Deidad   : Mittarna                | Favor        : amado        (2500 )     ||\n  ||------------------------------------------------------------------------------||\n  || Te sientes muy bien.                                                         ||\n  ||------------------------------------------------------------------------------||\n  ||                        -= Datos de Guerras =-                                ||\n  || Rango           : Plebeya                     Gloria         : 0    /0       ||\n  || Asesinatos      : 0                           Muertes        : 0             ||\n  ||------------------------------------------------------------------------------||\n  || Conclave:                                                                    ||\n  ||  Avatar Matados : 336                         Otros Matados  : 136           ||\n  ||  Avatar Muertos : 557                         Otros Muertos  : 366           ||\n  \\                                                                              /\n    ------------------------------------------------------------------------------\n  */\n})();\n\nexport function statsPlugin({ when, write }: BasicContext) {\n  let isInitiated = false;\n  let name = '';\n  let principal = false;\n\n  const stats = {\n    fue: 0,\n    fueBase: 0,\n    des: 0,\n    desBase: 0,\n    vida: 0,\n    vidaBase: 0,\n    vidaRegen: 0,\n    int: 0,\n    intBase: 0,\n    sab: 0,\n    sabBase: 0,\n    mana: 0,\n    manaBase: 0,\n    manaRegen: 0,\n    con: 0,\n    conBase: 0,\n    car: 0,\n    carBase: 0,\n    mov: 0,\n    movBase: 0,\n    movRegen: 0,\n    sue: 0,\n    sueBase: 0,\n    level: 0,\n  };\n\n  when(\n    STATE_DETECTOR,\n    ({ groups }) => {\n      for (const key of Object.keys(stats) as (keyof typeof stats)[]) {\n        stats[key] = toInt(groups[key]) as any;\n      }\n\n      name = groups.name;\n      principal = Boolean(groups.principal);\n      isInitiated = true;\n    },\n    { captureLength: SIZE },\n  );\n\n  return {\n    async getLevel() {\n      await ensureInitiated();\n      return stats.level;\n    },\n  };\n\n  async function ensureInitiated() {\n    if (!isInitiated) {\n      write('estado');\n      await when(STATE_DETECTOR, { captureLength: SIZE });\n    }\n  }\n}\n","import { BasicContext } from '../lib/context/BasicContextCreator';\n\nexport async function login(\n  { when, write, log }: BasicContext,\n  username: string,\n  password: string,\n  initialize: () => Promise<any>,\n) {\n  await when('Entra el nombre de tu personaje o escribe Nuevo:');\n  write(username);\n  log('Username sent, waiting for password request');\n\n  await when('Password:');\n  write(password, { password: true });\n  log(`Logged in as ${username}`);\n\n  await Promise.any([\n    (async () => {\n      await when('Reconectando.');\n      await initialize();\n    })(),\n    (async () => {\n      await when('Pulsa [ENTER]');\n      write('');\n      await when('Pulsa [ENTER]');\n      write('');\n      await when('Bienvenido a Balzhur...', initialize, { await: true }).once();\n    })(),\n  ]);\n}\n","import { TriggerCollection } from './../triggers/TriggerCollection';\nimport { CancellablePromise } from './../util/CancellablePromise';\nimport { PluginMap } from '../../plugins';\nimport { Mud } from './../Mud';\nimport { BasicContext, BasicContextCreator } from './BasicContextCreator';\n\nexport type WorkflowContext = ReturnType<\n  WorkflowContextCreator['createInstance']\n>;\n\nexport class WorkflowContextCreator extends BasicContextCreator {\n  private readonly register: Mud['workflow'];\n  private readonly getWorkflow: Mud['getWorkflow'];\n\n  constructor(\n    mud: Mud,\n    triggers: TriggerCollection,\n    private readonly plugins: PluginMap,\n  ) {\n    super(triggers, mud.send.bind(mud));\n    this.register = mud.workflow.bind(mud);\n    this.getWorkflow = mud.getWorkflow.bind(mud);\n  }\n\n  createInstance(name: string) {\n    const context = super.createInstance(name);\n    const { log, abort } = context;\n    const { checkNotAborted, register, getWorkflow } = this;\n\n    const children: CancellablePromise<any>[] = [];\n    let finish: (value: string) => void;\n\n    return Object.assign(context, {\n      plugins: pluginsGetter(this.plugins, context),\n\n      register,\n\n      isRunning: (name: string) => getWorkflow(name).isRunning,\n\n      run(name: string, params: any[] = []) {\n        checkNotAborted(context);\n        log(`Invoke workflow \"${name}\" with`, ...params);\n\n        const workflow = getWorkflow(name);\n        const execution = workflow.execute(...params);\n\n        children.push(execution);\n\n        execution.then(\n          result => log(`Invocation \"${name}\" returned `, result),\n          error => log(`Invocation \"${name}\" failed `, error),\n        );\n\n        return execution;\n      },\n\n      runForever() {\n        checkNotAborted(context);\n        return new Promise(resolve => (finish = resolve));\n      },\n\n      abort(fromExecution?: boolean) {\n        if (context.isAborted) return;\n\n        abort();\n\n        children.forEach(x => x.cancel());\n\n        if (finish) {\n          finish(\n            `Workflow aborted from ${fromExecution ? 'execution' : 'context'}`,\n          );\n        }\n      },\n    });\n\n    // const createChild = (childName?: string) => {\n    //   const child = this.createInstance(\n    //     `${name}->${childName || children.length}`,\n    //   );\n\n    //   if (context.isPrintingLogs) {\n    //     child.printLogs;\n    //   }\n\n    //   return child;\n    // };\n  }\n}\n\nfunction pluginsGetter(source: PluginMap, context: BasicContext) {\n  return new Proxy(source, {\n    get(target, key: string) {\n      if (!(key in target)) {\n        context.log(`Failed to get plugin ${key}`);\n        throw new Error(`Plugin ${key} is not registered.`);\n      }\n\n      context.log(`Requires plugin ${key}`);\n      // TODO: bind plugin to context\n      return target[key as keyof typeof target];\n    },\n  });\n}\n","import { Pattern } from './Pattern';\nimport { PatternMatcher } from './PatternMatcher';\nimport { PatternMatchSubscription } from './PatternMatchSubscription';\nimport { PatternOptions } from './PatternOptions';\nimport { PatternPromise } from './PatternPromise';\nimport { PatternResult } from './PatternResult';\n\ntype Handler = (result: PatternResult) => void;\n\nexport class TriggerCollection {\n  private readonly patterns = new Set<PatternMatcher>();\n  private readonly queue: string[] = [];\n  private isProcessing = false;\n\n  add(pattern: Pattern, options?: PatternOptions): PatternPromise;\n  add(\n    pattern: Pattern,\n    handler: (result: PatternResult) => void,\n    options?: PatternOptions,\n  ): PatternMatchSubscription;\n  add(\n    pattern: Pattern,\n    handler?: Handler | PatternOptions,\n    options?: PatternOptions,\n  ): any {\n    if (arguments.length === 1) return this.once(pattern);\n\n    if (arguments.length === 3)\n      return this.watch(pattern, handler as Handler, options);\n\n    if (typeof handler === 'function')\n      return this.watch(pattern, handler as Handler);\n\n    return this.once(pattern, handler as PatternOptions);\n  }\n\n  private watch(pattern: Pattern, handler: Handler, options?: PatternOptions) {\n    const entry = new PatternMatcher(pattern, x => handler(x), options);\n\n    this.patterns.add(entry);\n\n    const unsubscribe = () => this.patterns.delete(entry);\n\n    const once = () =>\n      new PatternPromise(resolve => {\n        const original = handler;\n\n        handler = async x => {\n          unsubscribe();\n\n          if (original) {\n            if (options && options.await) {\n              await original(x);\n            } else {\n              original(x);\n            }\n          }\n\n          resolve(x);\n        };\n      });\n\n    return { unsubscribe, once } as PatternMatchSubscription;\n  }\n\n  private once(pattern: Pattern, options?: PatternOptions) {\n    return new PatternPromise(resolve => {\n      const sub = this.add(pattern, handler, options);\n\n      function handler(result: PatternResult) {\n        sub.unsubscribe();\n        resolve(result);\n      }\n    });\n  }\n\n  async process(text: string): Promise<void> {\n    if (this.isProcessing) {\n      this.queue.push(text);\n      return;\n    }\n\n    this.isProcessing = true;\n\n    const splitted = text.split('\\n');\n    const last = splitted.pop() as string;\n    const lines = [...splitted.map(x => `${x}\\n`), last];\n\n    for (const line of lines) {\n      // console.log('PROCESS', line);\n      for (const pattern of this.patterns) {\n        await pattern.process(line);\n      }\n    }\n\n    this.isProcessing = false;\n\n    if (this.queue.length) {\n      return this.process(this.queue.pop()!);\n    }\n  }\n}\n","import { trimEnd } from '../util/trimEnd';\nimport { Pattern, SinglePattern } from './Pattern';\nimport { PatternOptions } from './PatternOptions';\nimport { PatternResult } from './PatternResult';\n\nexport class PatternMatcher {\n  private readonly patterns: SinglePattern[];\n  private readonly buffer;\n  readonly length;\n  private _isEnabled = true;\n\n  get isEnabled() {\n    return this._isEnabled;\n  }\n\n  constructor(\n    pattern: Pattern,\n    private readonly handler: (result: PatternResult) => void,\n    private readonly options: PatternOptions = {},\n  ) {\n    this.patterns = Array.isArray(pattern) ? pattern : [pattern];\n    this.length =\n      options.captureLength ||\n      Math.max(...this.patterns.map(x => String(x).length)) * 10;\n\n    this.buffer = buffer(this.length);\n  }\n\n  enable() {\n    this._isEnabled = true;\n  }\n\n  disable() {\n    this._isEnabled = false;\n    this.buffer.clear();\n  }\n\n  process(text: string) {\n    if (!this._isEnabled) return;\n\n    const value = this.buffer(text);\n    const matching = this.patterns.filter(pattern =>\n      this.testPattern(value, pattern),\n    );\n\n    if (!matching.length) return;\n\n    this.buffer.clear();\n    const result = new PatternResult(matching, value);\n    const output = this.handler(result);\n    return this.options.await ? output : null;\n  }\n\n  private testPattern(text: string, pattern: SinglePattern) {\n    if (typeof pattern === 'string') {\n      return text.indexOf(pattern) > -1;\n    }\n\n    return pattern.test(text);\n  }\n}\n\nfunction buffer(length: number) {\n  let value = '';\n  const clear = () => (value = '');\n  const add = (text: string) => (value = trimEnd(`${value}${text}`, length));\n  return Object.assign(add, { clear });\n}\n","export function trimEnd(value: string, maxLength: number) {\n  return value.length > maxLength\n    ? value.substr(value.length - maxLength)\n    : value;\n}\n","import { SinglePattern } from './Pattern';\n\nexport class PatternResult {\n  private get regexes() {\n    return this.patterns.filter(isRegex);\n  }\n\n  private get stringPatterns() {\n    return this.patterns.filter(x => !isRegex(x)) as string[];\n  }\n\n  get fullMatch() {\n    return this.stringPatterns[0];\n  }\n\n  get captured() {\n    const regexMatches = this.regexes\n      .map(x => this.haystack.match(x)!)\n      .filter(Boolean)\n      .map(x => Array.from(x));\n\n    // TODO: maybe return the one with more captures?\n    return regexMatches[0];\n  }\n\n  get groups(): Record<string, string> {\n    return this.regexes\n      .map(x => this.haystack.match(x)!)\n      .filter(Boolean)\n      .map(x => x.groups!)\n      .filter(Boolean)\n      .reduce(merge, {});\n  }\n\n  constructor(\n    readonly patterns: SinglePattern[],\n    private readonly haystack: string,\n  ) {}\n}\n\nfunction isRegex(value: SinglePattern) {\n  return value instanceof RegExp;\n}\n\nfunction merge(a: object, b: object) {\n  return { ...a, ...b };\n}\n","import { emitter } from '@amatiasq/emitter';\nimport { WorkflowContextCreator } from '../context/WorkflowContextCreator';\nimport { CancellablePromise } from '../util/CancellablePromise';\nimport { WorkflowFn } from './WorkflowFn';\n\nexport class Workflow<Result = any, Args extends any[] = any[]> {\n  private executions = new Set<CancellablePromise<Result>>();\n  private executionCount = 0;\n  private _isEnabled = true;\n\n  private readonly emitChange = emitter<this>();\n  readonly onChange = this.emitChange.subscribe;\n\n  get isRunning() {\n    return Boolean(this.executions.size);\n  }\n\n  get instancesRunning() {\n    return this.executions.size;\n  }\n\n  get timesExecuted() {\n    return this.executionCount;\n  }\n\n  get isEnabled() {\n    return this._isEnabled;\n  }\n\n  constructor(\n    readonly name: string,\n    private readonly run: WorkflowFn<Args>,\n    private readonly contextCreator: WorkflowContextCreator,\n  ) {}\n\n  owns(execution: CancellablePromise<any>) {\n    return this.executions.has(execution);\n  }\n\n  execute(...args: Args) {\n    if (!this._isEnabled) {\n      throw new Error(`Workflow \"${this.name}\" is disabled`);\n    }\n\n    const iteration = this.executionCount++;\n    const context = this.contextCreator.createInstance(this.name);\n\n    context.log(`[Exe(${iteration})]`, ...args);\n\n    const promise = new CancellablePromise<Result>(\n      (resolve, reject, onCancel) => {\n        onCancel(() => context.abort());\n        Promise.resolve(this.run(context, ...args)).then(resolve, reject);\n      },\n    );\n\n    this.executions.add(promise);\n\n    const result = promise\n      .then(\n        result => {\n          context.log(`[Res(${iteration})]`, result);\n          return result;\n        },\n        error => {\n          context.log(`[ERR(${iteration})]`, error);\n          throw error;\n        },\n      )\n      .finally(() => {\n        this.executions.delete(promise);\n        this.contextCreator.dispose(context);\n        this.emitChange(this);\n      });\n\n    this.emitChange(this);\n    return result;\n  }\n\n  stop() {\n    this.executions.forEach(x => x.cancel());\n    this.emitChange(this);\n  }\n\n  enable() {\n    this._isEnabled = true;\n    this.emitChange(this);\n  }\n\n  disable() {\n    this._isEnabled = false;\n    this.emitChange(this);\n  }\n}\n","import { emitter } from '@amatiasq/emitter';\n\ntype PromiseResolver<T> = (value?: T | PromiseLike<T>) => void;\ntype PromiseRejector<T> = (reason?: T) => void;\n\nexport type PromiseExecutor<T> = (\n  resolve: PromiseResolver<T>,\n  reject: PromiseRejector<any>,\n) => void;\n\nexport type PromiseOnFulfilled<Input, Result> =\n  | ((value: Input) => Result | PromiseLike<Result>)\n  | undefined\n  | null;\nexport type PromiseOnRejected<Reason, Result> =\n  | ((reason: Reason) => Result | PromiseLike<Result>)\n  | undefined\n  | null;\n\n// Tell typescript how this works now\nexport interface CancellablePromise<T> {\n  // then<Result1 = T, Result2 = never>(\n  //   onfulfilled?: PromiseOnFulfilled<T, Result1>,\n  //   onrejected?: PromiseOnRejected<any, Result2>,\n  // ): CancellablePromise<Result1 | Result2>;\n  catch<Result = T>(\n    onrejected?: PromiseOnRejected<any, Result>,\n  ): CancellablePromise<Result>;\n  // finally(onfinally?: (() => void) | undefined | null): CancellablePromise<T>;\n}\n\nexport class CancellablePromise<T> extends Promise<T> {\n  private readonly emitCancel;\n  readonly onCancel;\n\n  private state!: 'resolved' | 'rejected' | 'pending' | 'cancelled';\n\n  get isCancelled() {\n    return this.state === 'cancelled';\n  }\n\n  get isPending() {\n    return this.state === 'pending';\n  }\n\n  get isResolved() {\n    return this.state === 'resolved';\n  }\n\n  get isRejected() {\n    return this.state === 'rejected';\n  }\n\n  constructor(\n    executor: (\n      resolve: PromiseResolver<T>,\n      reject: PromiseRejector<any>,\n      onCancel: (listener: () => void) => void,\n    ) => void,\n  ) {\n    const emitCancel = emitter<void>();\n    const onCancel = emitCancel.subscribe;\n\n    super((resolve, reject) => {\n      executor(\n        value => {\n          if (this.isPending) {\n            this.state = 'resolved';\n            resolve(value);\n          }\n        },\n        reason => {\n          if (this.isPending) {\n            this.state = 'rejected';\n            reject(reason);\n          }\n        },\n        onCancel,\n      );\n    });\n\n    this.state = 'pending';\n    this.emitCancel = emitCancel;\n    this.onCancel = onCancel;\n  }\n\n  then<Result1 = T, Result2 = never>(\n    onfulfilled?: PromiseOnFulfilled<T, Result1>,\n    onrejected?: PromiseOnRejected<any, Result2>,\n  ) {\n    const result = super.then(onfulfilled, onrejected) as CancellablePromise<\n      Result1 | Result2\n    >;\n    result.onCancel(() => this.cancel());\n    this.onCancel(() => result.cancel());\n    return result;\n  }\n\n  finally(onfinally?: (() => void) | undefined | null) {\n    if (onfinally) {\n      this.onCancel(onfinally);\n    }\n\n    super.finally(onfinally);\n    return this;\n  }\n\n  cancel() {\n    if (this.isPending) {\n      this.state = 'cancelled';\n      this.emitCancel();\n    }\n  }\n}\n","import { emitter } from '@amatiasq/emitter';\nimport { playAudio } from './audio';\n\nexport class RemoteTelnet {\n  private _isConnected = false;\n\n  get isConnected() {\n    return this._isConnected;\n  }\n\n  private readonly emitClose = emitter();\n  readonly onClose = this.emitClose.subscribe;\n\n  private readonly emitData = emitter<string>();\n  readonly onData = this.emitData.subscribe;\n\n  constructor(private readonly socket: WebSocket) {\n    socket.addEventListener('close', this.emitClose);\n    socket.addEventListener('message', this.onMessage.bind(this));\n\n    this.onData(() => (this._isConnected = true));\n    this.onClose(() => (this._isConnected = false));\n  }\n\n  connect(host: string, port: number) {\n    this.proxy('OPEN', { host, port });\n  }\n\n  send(value: string) {\n    this.socket.send(encode(value));\n  }\n\n  close() {\n    this.socket.close();\n  }\n\n  private proxy(type: string, payload: any) {\n    this.socket.send(JSON.stringify({ type, payload }));\n  }\n\n  private async onMessage(event: MessageEvent<Blob>) {\n    const reader = new FileReader();\n    reader.onloadend = () => this.processor(reader.result as string);\n    reader.readAsText(event.data, 'ISO-8859-1');\n\n    // .replace(/z<Ex>/g, '')\n    // .replace(/\\[1z<\\/Ex>/g, '')\n    // .replace(/&lt;/g, '<')\n    // .replace(/&gt;/g, '>')\n    // .replace(/&amp;/g, '&');\n  }\n\n  private processor(chunk: string) {\n    const SOUND = /!!SOUND\\((?<path>[\\w\\/\\.]+) U=http:\\/\\/(?<host>[\\w\\/\\.]+)\\)/g;\n\n    if (chunk.match(SOUND)) {\n      for (const sound of chunk.matchAll(SOUND)) {\n        playAudio('/assets/' + sound.groups!.path);\n      }\n\n      chunk = chunk.replace(SOUND, '');\n    }\n\n    this.emitData(chunk);\n  }\n}\n\nfunction encode(text: string) {\n  const encoder = new TextEncoder();\n  const invariant = text.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '');\n  return encoder.encode(invariant);\n}\n","import { ClientStorage } from '@amatiasq/client-storage';\n\nconst storage = new ClientStorage<string[]>('invalid-audio');\nconst invalid = new Set<string>(storage.get() || []);\n\nexport function playAudio(path: string) {\n  if (invalid.has(path)) {\n    return;\n  }\n\n  const audio = new Audio(path);\n  console.debug('AUDIO', path);\n  audio.volume = 0.05;\n  audio.play();\n\n  audio.onerror = () => {\n    invalid.add(path);\n    storage.set([...invalid]);\n  };\n}\n","import { code } from './daemons/code';\nimport { defend } from './daemons/defend';\nimport { dope } from './daemons/dope';\nimport { drink } from './daemons/drink';\nimport { eat } from './daemons/eat';\nimport { idle } from './daemons/idle';\nimport { quest } from './daemons/quest';\nimport { repair } from './daemons/repair';\nimport { rest } from './daemons/rest';\nimport { shop } from './daemons/shop';\nimport { Mud } from './lib/Mud';\nimport { afk } from './workflows/afk';\nimport { bank } from './workflows/bank';\nimport { cast } from './workflows/cast';\nimport { donations } from './workflows/donations';\nimport { go } from './workflows/go';\nimport { kill } from './workflows/kill';\nimport { recover } from './workflows/recover';\nimport { train } from './workflows/train';\nimport { wear } from './workflows/wear';\n\nexport function registerWorkflows(mud: Mud) {\n  mud.daemon('code', code);\n  mud.daemon('defend', defend);\n  mud.daemon('dope', dope);\n  mud.daemon('drink', drink);\n  mud.daemon('eat', eat);\n  mud.daemon('idle', idle);\n  mud.daemon('quest', quest);\n  mud.daemon('repair', repair);\n  mud.daemon('rest', rest);\n  mud.daemon('shop', shop);\n\n  mud.workflow('afk', afk);\n  mud.workflow('bank', bank);\n  mud.workflow('cast', cast);\n  mud.workflow('donations', donations);\n  mud.workflow('kill', kill);\n  mud.workflow('go', go);\n  mud.workflow('recover', recover);\n  mud.workflow('train', train);\n  mud.workflow('wear', wear);\n}\n","import { ClientStorage } from '@amatiasq/client-storage';\n\nimport { Context } from '../lib';\n\nconst storage = new ClientStorage<Record<string, number>>('things-in-rooms');\n\nexport function code({ when }: Context) {\n  when(\n    /Salidas: [^\\.]+\\.\\n\\n([^<]+)\\n<\\d+/,\n    ({ captured }) => {\n      if (captured[1].includes('Solo puedes leer mails de ese buzon.')) {\n        return;\n      }\n\n      const things = captured[1].split(/\\n/).map(x => x.trim());\n      const dict = storage.get() || {};\n      things.forEach(x => (dict[x] = (dict[x] || 0) + 1));\n      storage.set(dict);\n    },\n    { captureLength: 5000 },\n  );\n}\n","import { ATTACK_RECEIVED, getMobIn } from '../data/mobs';\nimport { Casteable, SPELLS_BY_TYPE } from '../data/spells';\nimport { Context } from '../lib';\n\nexport async function defend({\n  isRunning,\n  run,\n  when,\n  write,\n  plugins: { prompt, skills, navigation },\n}: Context) {\n  when('Estas demasiado exhausto para huir del combate!', () =>\n    navigation.recall(),\n  );\n\n  when(ATTACK_RECEIVED, async ({ groups }) => {\n    if (isRunning('kill')) {\n      return;\n    }\n\n    const mana = prompt.getPercent('mana');\n    const fullName = groups.mob;\n\n    if (!fullName || mana <= 0.1) {\n      return;\n    }\n\n    const mob = getMobIn(fullName);\n    const hp = prompt.getPercent('hp');\n    const attack =\n      hp < 0.5\n        ? <Casteable>[...SPELLS_BY_TYPE.massAttack, ...SPELLS_BY_TYPE.attack]\n        : SPELLS_BY_TYPE.attack;\n\n    await skills.castSpell(attack, mob ? mob.name : fullName);\n  });\n\n  when('.. Todo empieza a volverse negro.\\n', async () => {\n    const RECUPERED =\n      'Tu cuerpo aparece de repente, rodeado por una divina presencia...';\n\n    let bodies = 0;\n\n    const sus = when(RECUPERED, () => bodies++);\n\n    await write('suplicar cuerpo');\n    await when(RECUPERED).timeout(5);\n\n    sus.unsubscribe();\n\n    when('El cadaver de May pasa a convertirse en polvo', () => bodies--);\n\n    while (bodies) {\n      write('coger todo may');\n      await prompt.until();\n      write('vestir todo');\n      await prompt.until();\n      await prompt.until();\n    }\n  });\n\n  when('Esta completamente oscuro ...', async () => {\n    if (await skills.can('luz eterna')) {\n      await run('cast', ['luz eterna']);\n      write('vestir luz');\n      write('mirar');\n    }\n  });\n\n  when('Estas maldito y no puedes usar el regresar!', async () => {\n    if (await skills.can('retirar maldicion')) {\n      await run('cast', ['retirar maldicion']);\n    }\n  });\n\n  when(/El cadaver de.* contiene:(?<items>(?:.|\\n)+)\\n[^ ]/, ({ groups }) => {\n    const items = groups.items\n      .toLowerCase()\n      .split(/\\n/)\n      .map(x => x.trim())\n      .filter(x => x && x !== 'nada.');\n\n    // Use if looking for a specific item\n    // if (items.some(x => x.includes('yelmo de orco'))) {\n    //   write('coger yelmo cuerpo');\n    // }\n\n    if (items.some(x => x.includes('llave'))) {\n      write('coger llave cuerpo');\n    }\n  });\n\n  when('Tragas agua al intentar respirar!', async () => {\n    if (await skills.can('respiracion acuatica')) {\n      skills.castSpell('respiracion acuatica');\n    }\n  });\n}\n","import { ClientStorage } from '@amatiasq/client-storage';\n\nimport { getSpells, Spell, SpellName, SPELLS_BY_TYPE } from '../data/spells';\nimport { Context } from '../lib';\nimport { uniq } from '../util/uniq';\n\nconst memory = new ClientStorage<(string | string[])[]>('dope:casting');\nconst spellGroups = Object.values(SPELLS_BY_TYPE) as SpellName[][];\n\nexport async function dope({\n  when,\n  register,\n  run,\n  plugins: { prompt, skills },\n}: Context) {\n  const shouldHeal = defineShould(0.2);\n  const shouldRefresh = defineShould(0.1, 0.8);\n  const repeatUntilCasted = (\n    name: string | string[],\n    ...args: (string | undefined)[]\n  ) => run('cast', [name, ...args]).catch(() => null);\n\n  const casting = new Set(memory.get());\n  const spells = getSpells();\n\n  spells.filter(x => x.end).forEach(watchDope);\n\n  prompt.onUpdate(\n    async ({\n      isFighting,\n      mana: { percent: mana },\n      hp: { percent: hp },\n      mv: { percent: mv },\n    }) => {\n      if (isFighting) {\n        return;\n      }\n\n      const canMeditate = await skills.can('meditar');\n\n      if (mana < 0.1 && !canMeditate) {\n        return;\n      }\n\n      if (mana < 0.7 && canMeditate) {\n        return skills.meditate();\n      }\n\n      if (hp > 0 && shouldHeal(mana, hp)) {\n        return skills.castSpell(SPELLS_BY_TYPE.heal);\n      }\n\n      if (hp > 0 && shouldRefresh(mana, mv)) {\n        return skills.castSpell('refrescar');\n      }\n    },\n  );\n\n  when('No puedes mantener un pensamiento fijo.', () => {\n    if (skills.can('curar veneno')) {\n      // cast curar veneno\n    }\n  });\n\n  register('dope', async ({ run }: Context, target?: string) => {\n    const list = spells\n      .filter(spell => spell.effect && (target ? spell.target : true))\n      .map(spell => getSpellGroup(spell.name));\n\n    const clean = uniq(list.map(x => x.join('|'))).map(x => x.split('|'));\n\n    for (const spell of clean) {\n      await run('cast', [spell, target]);\n    }\n  });\n\n  async function watchDope(spell: Spell) {\n    const invoke = getSpellGroup(spell.name);\n\n    when(spell.end!, async () => {\n      casting.add(invoke);\n      memory.set([...casting]);\n\n      const success = await repeatUntilCasted(invoke);\n\n      if (success) {\n        casting.delete(invoke);\n        memory.set([...casting]);\n      }\n    });\n  }\n\n  function defineShould(min: number, max = 1) {\n    const multiplier = 1 / (max - min);\n\n    return (mana: number, stat: number) => {\n      if (mana === 0 || stat > max) return false;\n      if (stat < min) return true;\n\n      const clapped = (stat - min) * multiplier;\n      return Math.hypot(mana, 1 - clapped) > 1;\n    };\n  }\n\n  function getSpellGroup(name: SpellName) {\n    const group = spellGroups.find(x => x.includes(name));\n    return group ? group : [name];\n  }\n}\n","export function uniq<T>(list: T[]) {\n  return [...new Set(list)];\n}\n","import { Context } from '../lib';\n\nexport async function drink({\n  run,\n  when,\n  write,\n  plugins: { inventory, navigation, skills },\n}: Context) {\n  let isFontAvailable = false;\n  let isBottleFull = false;\n\n  navigation.onRoomChange(() => (isFontAvailable = false));\n\n  when(\n    [\n      'Un manantial magico esta aqui.',\n      'Una hermosa fuente de marmol blanco esta aqui.',\n      'Trazas un circulo delante tuyo del cual emerge un manantial de agua cristalina.',\n    ],\n    async () => {\n      isFontAvailable = true;\n\n      if (!isBottleFull) {\n        const bottle = await getWaterBottle();\n\n        if (bottle) {\n          write(`llenar ${bottle}`);\n          isBottleFull = true;\n        }\n      }\n    },\n  );\n\n  when(\n    [\n      'Te apetece dar un sorbo a algo refrescante.',\n      'Tienes sed.',\n      // 'Estas sediento.',\n      'Estas realmente sediento.',\n      'Estas MUERTO de SED!',\n      'Estas en peligro de deshidratacion.',\n    ],\n    async () => {\n      if (isFontAvailable || (await createFont())) {\n        write('beber');\n        return;\n      }\n\n      const bottle = await getWaterBottle();\n\n      if (!bottle) {\n        console.log('No hay fuente de agua');\n        return;\n      }\n\n      write(`beber ${bottle}`);\n      await skills.castSpell('crear agua', bottle);\n    },\n  );\n\n  async function createFont() {\n    if (await skills.can('crear manantial')) {\n      return run('cast', ['crear manantial']);\n    }\n  }\n\n  async function getWaterBottle() {\n    return inventory.has({\n      'un odre de cuero': 'odre',\n      'una cantimplora': 'cantimplora',\n    });\n  }\n}\n","import { Context } from '../lib';\n\nexport async function eat({\n  run,\n  when,\n  write,\n  plugins: { inventory, navigation: nav, skills },\n}: Context) {\n  const EXPECTED_FOOD = 1;\n  const DEFAULT_FOOD_NAME = 'chuleta';\n\n  when(['Tienes hambre.', 'Estas realmente hambriento.'], eatSomething);\n\n  when(['Estas terriblemente hambriento.', 'Estas HAMBRIENTO!'], async () => {\n    if (await eatSomething()) {\n      return;\n    }\n\n    if (nav.isAtRecall) {\n      await buyFood();\n      await eatSomething();\n    }\n  });\n\n  async function eatSomething() {\n    const food = await getFoodFromInventory();\n\n    if (food) {\n      write(`comer ${food}`);\n      inventory.refresh();\n      return true;\n    }\n\n    return await createFood();\n  }\n\n  async function createFood() {\n    if (\n      !(await skills.can('crear comida')) ||\n      !(await run('cast', ['crear comida']))\n    ) {\n      return false;\n    }\n\n    write('coger seta');\n\n    try {\n      await when('Coges una seta magica.').timeout(3);\n      write('comer seta');\n      return true;\n    } catch (err) {\n      return false;\n    }\n  }\n\n  async function buyFood() {\n    await nav.execute('2sen');\n\n    write(`comprar ${EXPECTED_FOOD} ${DEFAULT_FOOD_NAME}`);\n\n    await Promise.any([\n      when('Compras una chuleta de cordero.'),\n      when('El carnicero pone todo en una bolsa y te la da.').then(\n        getFoodFromBag,\n      ),\n    ]);\n\n    await nav.execute('sw2n');\n  }\n\n  async function getFoodFromInventory() {\n    await getFoodFromBag();\n\n    return await inventory.has({\n      'un chorizo': 'chorizo',\n      'pavo cocinado': 'pavo',\n      'una chuleta de cordero': 'chuleta',\n      'loncha de salami': 'salami',\n      'pierna de cordero': 'pierna',\n      'ricas longanizas': 'longanizas',\n      'un extranyo hongo': 'hongo',\n    });\n  }\n\n  async function getFoodFromBag() {\n    if (await inventory.has('una bolsa')) {\n      write('coger todo bolsa');\n      write('examinar bolsa');\n\n      const { captured } = await when(/Una bolsa contiene:\\n\\s+(Nada)?/);\n      if (captured[1]) {\n        write('tirar bolsa');\n      }\n    }\n  }\n}\n","import { Context } from '../lib';\n\nexport async function idle({\n  when,\n  write,\n  run,\n  plugins: { navigation, skills },\n}: Context) {\n  when('Desapareces en la nada.', async () => {\n    console.log('IDLE');\n\n    if (!navigation.isAtRecall) {\n      write('estado');\n      return;\n    }\n\n    await run('train');\n\n    if (skills.can('invisibilidad')) {\n      await run('cast', ['invisibilidad']);\n    }\n  });\n}\n","import { Context } from '../lib';\n\nexport async function quest({ when, write, plugins: { navigation } }: Context) {\n  when(\n    /El tesoro parece estar(?: al) (?<dir>\\w+) de aqui.../,\n    async ({ groups }) => {\n      await navigation.go(groups.dir);\n      write('carto mapa');\n    },\n  );\n\n  when('No has desenterrado nada a pesar de haber cavado bien hondo.', () =>\n    write('cavar'),\n  );\n}\n","import { getItemSustantive, ItemName, UNWEAR } from '../data/items';\nimport { Context } from '../lib';\nimport { wait } from '../lib/util/wait';\n\nexport async function repair({\n  when,\n  write,\n  register,\n  plugins: { navigation, prompt },\n}: Context) {\n  register('repair', async () => {\n    const broken = await getBrokenEquipment();\n\n    if (broken) {\n      await navigation.execute('r2ses');\n      return repairEquipment(broken);\n    }\n  });\n\n  when('No puedes vestir eso, necesita repararse.', async () => {\n    await navigation.execute('r2ses');\n    await repairAll();\n\n    const broken = await getBrokenEquipment();\n\n    if (broken) {\n      return repairEquipment(broken);\n    }\n  });\n\n  async function repairEquipment(broken: ItemName[]) {\n    for (const item of broken) {\n      write(`guardar ${item}`);\n      await when(UNWEAR);\n    }\n\n    await repairAll();\n    return navigation.execute('nw2n');\n  }\n\n  async function getBrokenEquipment() {\n    const broken: ItemName[] = [];\n    write('equipo');\n\n    const sus = when(/>\\s+\\[\\+*[^+]+\\] (?<item>.*)/, ({ groups }) => {\n      const item = getItemSustantive(groups.item);\n      if (item) broken.push(item);\n    });\n\n    await when('Estas usando:');\n    await prompt.until();\n    sus.unsubscribe();\n\n    return broken.length ? broken : null;\n  }\n\n  async function repairAll() {\n    write('reparar todo');\n\n    await Promise.any([\n      when('El herrero te cobra').then(() => true),\n      when('El herrero te cuenta').then(() => false),\n      wait(5).then(() => null),\n    ]);\n\n    write('vestir todo');\n  }\n}\n","import { Context } from '../lib';\n\nexport async function rest({ when, write }: Context) {\n  when(\n    [\n      'Nah... Estas demasiado relajado...',\n      'En tus suenyos o que?',\n      'Estas demasiado relajado para lanzar ese conjuro.',\n      'Estas demasiado relajado para lanzar ese conjuro.',\n    ],\n    () => write('despertar'),\n  );\n}\n","import { Realm } from '../data/areas';\nimport { Context } from '../lib';\n\ninterface Location {\n  path: Partial<Record<Realm, string>>;\n  name?: string;\n  amount?: number;\n}\n\nconst locations: Record<string, Location> = {\n  viajar: {\n    path: { Calimhar: 'r2s3wn' },\n    amount: 5,\n  },\n};\n\nexport async function shop({ when, write, register }: Context) {\n  when(/pone todo en una bolsa y te la da\\./, async () => {\n    write('coger todo bolsa');\n    write('examinar bolsa');\n\n    await when(/Una bolsa contiene:\\n\\s+Nada\\./);\n    write('tirar bolsa');\n  });\n\n  register(\n    'buy',\n    async (\n      { when, write, plugins: { navigation } }: Context,\n      item: string,\n      amount: number,\n    ) => {\n      if (!(item in locations)) {\n        throw new Error(`Unknown item type \"${item}\"`);\n      }\n\n      const realm = await navigation.getRealm();\n      const config = locations[item as keyof typeof locations];\n      const path = config.path[realm];\n      const name = config.name || item;\n\n      if (!amount) {\n        amount = config.amount || 1;\n      }\n\n      if (!path) {\n        throw new Error(`Can't find shop for ${item} on realm ${realm}`);\n      }\n\n      await navigation.execute(path);\n      write(`comprar ${amount} ${name}`);\n\n      return Promise.any([\n        when('Lo siento, esta cerrado, vuelve mas tarde.').then(() => false),\n        when(['Compras ', 'pone todo en una bolsa y te la da']).then(\n          () => true,\n        ),\n      ]);\n    },\n  );\n}\n","import { Context } from '../lib';\n\nexport async function afk(\n  { abort, run, when, plugins: { navigation, prompt } }: Context,\n  ...areas: string[]\n) {\n  const initialExp = prompt.getValue('exp');\n  let isAborted = false;\n\n  console.log({ initialExp });\n\n  when('.. Todo empieza a volverse negro.\\n', async () => {\n    await prompt.until();\n\n    const exp = prompt.getValue('exp');\n\n    if (exp > initialExp) {\n      isAborted = true;\n      abort();\n    }\n  });\n\n  while (!isAborted) {\n    await action();\n  }\n\n  async function action(): Promise<void> {\n    try {\n      await run('recover');\n      await run('repair');\n      await run('dope');\n      await run('recover');\n    } catch (error) {\n      console.log('Preparation error', error);\n    }\n\n    try {\n      await run('train', [rand(areas || [])]);\n    } catch (error) {\n      console.log('Train error', error);\n    }\n\n    try {\n      if (navigation.isAtRecall) {\n        await run('bank');\n      }\n    } catch (error) {\n      console.log('Bank error', error);\n    }\n  }\n}\n\nfunction rand<T>(list: T[]) {\n  return list[Math.floor(Math.random() * list.length)];\n}\n","import { Context } from '../lib';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { int, toInt } from '../lib/util/int';\n\nexport async function bank(\n  { when, write, plugins: { navigation } }: Context,\n  take?: number,\n) {\n  const INGRESS = concatRegexes(\n    /Ingresas /,\n    int(),\n    / monedas? de oro en tu cuenta bancaria./,\n  );\n  const EXTRACT = concatRegexes(\n    /Retiras /,\n    int(),\n    / monedas? de oro de tu cuenta bancaria./,\n  );\n\n  await navigation.execute('r4s2en');\n\n  write('banco saldo');\n\n  const { groups } = await when(\n    concatRegexes(\n      /Estas llevando /,\n      int('carring'),\n      / monedas de oro.\\n/,\n      /Tienes /,\n      int('balance'),\n      / monedas de oro en el banco.\\n/,\n      /Lo que hace un total de /,\n      int('total'),\n      / monedas de oro.\\n/,\n    ),\n  );\n\n  const carring = toInt(groups.carring);\n  const balance = toInt(groups.balance);\n  const total = toInt(groups.total);\n  const final = take == null ? Math.ceil(total * 0.01) : take;\n\n  if (carring < final) {\n    write(`banco retirar ${final - carring}`);\n    await when(EXTRACT);\n  } else if (carring > final) {\n    write(`banco ingresar ${carring - final}`);\n    await when(INGRESS);\n  }\n\n  await navigation.execute('s2w4n');\n}\n","import { Casteable } from '../data/spells';\nimport { Context } from '../lib';\nimport { wait } from '../lib/util/wait';\n\nexport async function cast(\n  { plugins: { prompt, skills } }: Context,\n  spell: Casteable,\n  ...args: string[]\n) {\n  const result = await repeatUntilCasted();\n\n  if (result === false) {\n    console.warn(`Unable to cast \"${spell}\"`);\n  }\n\n  return result;\n\n  async function repeatUntilCasted(): Promise<boolean> {\n    if (prompt.isFighting) {\n      await prompt.until(x => !x.isFighting);\n    }\n\n    switch (await skills.castSpell(spell, args.join(' '))) {\n      case skills.CASTED:\n      case skills.ALREADY_APPLIED:\n        return true;\n      case skills.NOT_AVAILABLE:\n        return false;\n      case skills.BUSY:\n        await wait(3);\n      case skills.FAILED:\n        return repeatUntilCasted();\n    }\n\n    throw new Error('WTF DUDE');\n  }\n}\n","import { ITEM_SUSTANTIVES } from '../data/items';\nimport { Context } from '../lib';\n\nconst rooms = [\n  { from: 31, to: 40, path: '4wn' },\n  { from: 21, to: 30, path: '3wn' },\n  { from: 11, to: 20, path: '2wn' },\n  { from: 1, to: 10, path: 'wn' },\n  { from: 41, to: 50, path: 'en' },\n  { from: 51, to: 60, path: '2en' },\n  { from: 61, to: 70, path: '3en' },\n  { from: 71, to: 80, path: '4en' },\n];\n\nexport async function donations({\n  when,\n  write,\n  run,\n  plugins: { navigation: nav, stats },\n}: Context) {\n  write('estado');\n  const level = await stats.getLevel();\n  const room = rooms.find(x => x.from <= level && x.to <= level);\n\n  if (!room) {\n    throw new Error(`No room for level \"${level}\"`);\n  }\n\n  await nav.execute('rh2w4n');\n\n  const promise = when(/Salidas: sur\\.\\n\\n((?:.|\\n)*)\\n\\n/, {\n    // donations rooms can get HUGE\n    captureLength: Number.MAX_VALUE,\n  });\n\n  await nav.execute(room.path);\n\n  const { captured: itemsMatch } = await promise;\n  const list = itemsMatch[1].split('\\n').map(x => x.trim());\n\n  for (const item of Object.values(ITEM_SUSTANTIVES)) {\n    const found = list.some(x => x.includes(item) && !x.includes('mallas'));\n\n    if (found) {\n      await run('wear', [item]);\n    }\n  }\n\n  await nav.recall();\n}\n","import { getAreaMetadata, Realm } from '../data/areas';\nimport { Context } from '../lib';\n\nconst PATH = /^r?((?:x|\\d+)?[nsewudohjkl])+$/;\nconst TRAVEL = 'un pergamino de viajar';\n\nconst REALM_RECALLS: Record<Realm, string | null> = {\n  Calimhar: 'DarkHaven',\n  Earand: 'Justicia',\n  Valmorag: 'Tinieblas',\n  Niruk: null,\n};\n\nexport async function go(\n  { run, when, write, plugins: { navigation, inventory, skills } }: Context,\n  path: string,\n) {\n  if (PATH.test(path)) {\n    return navigation.execute(path);\n  }\n\n  const area = getAreaMetadata(path);\n\n  if (!area) {\n    throw new Error(`Can't resolve path or area \"${path}\"`);\n  }\n\n  if (!area.path) {\n    throw new Error(`Area ${area.name} doesn't have a path`);\n  }\n\n  const realm = await navigation.getRealm();\n\n  if (area.realm === realm) {\n    return navigation.execute(area.path);\n  }\n\n  const recall = REALM_RECALLS[area.realm];\n\n  if (!recall) {\n    throw new Error(`Realm ${area.realm} doesn't have recall.`);\n  }\n\n  if (await skills.can('viajar')) {\n    if (await run('cast', ['viajar', area.realm])) {\n      return navigation.execute(area.path);\n    }\n  }\n\n  let canTravel = false;\n\n  if (await inventory.has(TRAVEL)) {\n    canTravel = true;\n  } else if (await inventory.hasInBackpack(TRAVEL)) {\n    write('coger viajar mochila');\n\n    canTravel = await Promise.any([\n      when('Coges un pergamino de viajar de').then(() => true),\n      when('No hay nada parecido a eso en').then(() => false),\n    ]);\n  }\n\n  if (canTravel) {\n    write(`recitar viajar ${recall}`);\n    await when('Recitas un pergamino de viajar.').timeout(3);\n    return navigation.execute(area.path);\n  }\n\n  throw new Error(`No way to travel to ${area.name} in ${area.realm}`);\n}\n","export default [\n  {\n    realm: 'Calimhar',\n    name: 'Academia de Darkhaven',\n    path: 'rd',\n    from: 1,\n    to: 5,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Bosque de las Hadas',\n    path: 'r6w2nwk2wh',\n    from: 1,\n    to: 5,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Catacumbas de la Capilla',\n    path: 'r6w8se7s',\n    from: 15,\n    to: 25,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Cementerio Oscuro',\n    path: 'r4s4ws',\n    clan: 'Legends',\n    from: 5,\n    to: 15,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Ciudad Imperial',\n    path: 'r8e2n4el3e2sj',\n    from: 0,\n    to: 95,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'DarkHaven',\n    path: 'rd',\n    from: 0,\n    to: 95,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'El Campamento Goblin',\n    path: 'r10s4en3e2n',\n    from: 1,\n    to: 10,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'El Cementerio',\n    path: 'r6w8ses',\n    from: 5,\n    to: 10,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'El Centinela',\n    path: 'r7ws',\n    from: 5,\n    to: 10,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'El Gran Estadio',\n    path: 'r8e2n4el3e2s2jn',\n    from: 10,\n    to: 20,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'El Imperio Orco',\n    path: 'r13s2wn',\n    clan: 'Legends',\n    from: 10,\n    to: 20,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'El Jardin de los Heroes',\n    path: 'r8e2n4el3e2s2j8l8e5j4els',\n    from: 75,\n    to: 80,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'El Pantano Orco',\n    path: 'r13s2en',\n    clan: 'DarkAngels',\n    from: 5,\n    to: 30,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'El Refugio Destruido',\n    path: 'r8e2ne',\n    from: 5,\n    to: 20,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Exportaciones de Dragones',\n    path: 'r4sen',\n    clan: 'Legends',\n    from: 5,\n    to: 25,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Foire de Reves',\n    path: 'r8n3ene',\n    from: 0,\n    to: 50,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Galeria de arte',\n    path: 'r4swn',\n    from: 10,\n    to: 50,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Guarderia Enana',\n    path: 'r8ejs',\n    from: 1,\n    to: 5,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Haon Dor',\n    path: 'r7w',\n    from: 5,\n    to: 10,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Holy Grove',\n    path: 'r9e',\n    from: 5,\n    to: 20,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Kharadest, Baluarte de Platino',\n    from: 78,\n    to: 80,\n    min: 77,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'La Fortaleza de Valor',\n    path: 'r11n2en',\n    clan: 'DragonSlayers',\n    from: 5,\n    to: 30,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'La Mansion de Marmol',\n    path: 'r9w3s',\n    from: 5,\n    to: 15,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'La Mansion de Tullfuhrzky',\n    path: 'r6w2nwk2wh4nj',\n    from: 1,\n    to: 10,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'La Torre del Brujo',\n    path: 'r9w2sese2s',\n    clan: 'Legends',\n    from: 10,\n    to: 20,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Las Alcantarillas',\n    path: 'r4sd',\n    from: 5,\n    to: 20,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Las Llanuras del Norte',\n    path: 'r7n',\n    from: 1,\n    to: 20,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: \"Miden'nir\",\n    path: 'r7s',\n    from: 5,\n    to: 15,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Residencias de Mortales',\n    from: 0,\n    to: 95,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Calimhar',\n    name: 'Sindaliore',\n    clan: 'Legends',\n    from: 75,\n    to: 80,\n    min: 77,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Armageddon',\n    path: 'r3s7w6n2wsl2sejls',\n    clan: 'Conclave',\n    from: 50,\n    to: 80,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Asgard',\n    path: 'r3s7w11ne2n2enhjn;entrar;.s',\n    clan: 'El Santuario',\n    from: 40,\n    to: 60,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Asoinwan, ciudad de las hadas',\n    path: 'r3s7w11ne2n',\n    clan: 'DragonSlayers',\n    from: 5,\n    to: 30,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Camelot',\n    path: 'r3s7w11ne2n2ej',\n    from: 65,\n    to: 80,\n    min: 50,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Dregoria',\n    path: 'r3s5e10n3wn',\n    clan: 'Cantico',\n    from: 40,\n    to: 65,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'El Calabozo de la Muerte',\n    path: 'ruse7n',\n    from: 10,\n    to: 35,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'El Campo de Batalla Desolado',\n    path: 'r3s7w6n2wsl2se',\n    from: 15,\n    to: 25,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'El Plano Astral',\n    path: 'r2su',\n    clan: 'DarkAngels',\n    from: 15,\n    to: 35,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'El Pueblo Fantasma',\n    path: 'r3s5e2j',\n    clan: 'DragonSlayers',\n    from: 35,\n    to: 50,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'El Reino de Yggdrasil',\n    path: 'r3s7w11ne2n2enhjn;entrar',\n    from: 15,\n    to: 50,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'El Yunque del Sol',\n    path: 'r3s7w6n2wsl2sejl2s5e4n3w2n4w',\n    clan: 'Legends',\n    from: 60,\n    to: 80,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Estroglia, corazn del Yunque',\n    clan: 'DarkAngels',\n    from: 75,\n    to: 80,\n    min: 75,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Ghotiamir',\n    path: 'r',\n    from: 0,\n    to: 95,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'La Ciudad de Velas',\n    path: 'r3s7wn',\n    from: 45,\n    to: 55,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'La Fortaleza de Lord Krothgar',\n    path: 'r3s5e3n',\n    from: 35,\n    to: 60,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'La Fortaleza Enana',\n    path: 'r3s5el2nj',\n    clan: 'El Santuario',\n    from: 35,\n    to: 65,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'La Guarida de Kotegaesi',\n    path: 'r3s7w6n2wslsk',\n    from: 30,\n    to: 45,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'La tumba de Damara',\n    path: 'r3s5w3n',\n    clan: 'Shinsent',\n    from: 15,\n    to: 25,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Las Ruinas de los Antiguos',\n    from: 78,\n    to: 80,\n    min: 77,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Observatorio del Ojo Celeste',\n    path: 'r3s3e2s',\n    clan: 'Cantico',\n    from: 25,\n    to: 65,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Valle de Rivendel',\n    path: 'r3s7w11ne2n2e2n',\n    from: 60,\n    to: 80,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Earand',\n    name: 'Villa Enana',\n    path: 'r3s5el',\n    from: 10,\n    to: 35,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Niruk',\n    name: 'La casa de Anarion',\n    from: 75,\n    to: 80,\n    min: 75,\n    max: 95,\n  },\n  {\n    realm: 'Niruk',\n    name: 'Las Tierras Desoladas',\n    clan: 'DarkAngels',\n    from: 10,\n    to: 80,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Niruk',\n    name: 'Residencia de Inmortales',\n    from: 81,\n    to: 95,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Niruk',\n    name: \"Tiempo de L'Hopital\",\n    from: 75,\n    to: 80,\n    min: 75,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'Bosque de los Muertos',\n    path: 'r3s5e2n2e2ses2en',\n    from: 20,\n    to: 40,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'Dhusebark',\n    path: 'r',\n    from: 0,\n    to: 95,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'El Devorador de Mundos',\n    path: 'r3s5e2n2e2ses2e3n2wkwnwhne6nunj',\n    from: 30,\n    to: 50,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'El Legado de Xchantharus',\n    path: 'r3s5e2n2e3swse3sd9sh',\n    clan: 'El Santuario',\n    from: 30,\n    to: 50,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'El Mausoleo del Minotauro',\n    path: 'r3s5e2n2en',\n    from: 40,\n    to: 65,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'Guarida de Gigantes de Fuego',\n    path: 'r3s5wh2w',\n    from: 40,\n    to: 50,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'Infierno',\n    path: 'r4sd',\n    from: 30,\n    to: 80,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'La Ciudad Maldita',\n    path: 'r9sk3esek',\n    clan: 'Sindicato',\n    from: 40,\n    to: 80,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'La Fortaleza de Lilith',\n    path: 'r9sk2w3usw',\n    clan: 'Torre Arcana',\n    from: 65,\n    to: 80,\n    min: 55,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'La Fortaleza de Mahn-Tor',\n    path: 'r3s5e2n2e',\n    from: 5,\n    to: 35,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'La Gran Torre de la Hechiceria',\n    path: 'r3s5e2nj',\n    from: 10,\n    to: 30,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'La Maldicion del Nigromante',\n    path: 'r3s5e2n2e2s2e',\n    clan: 'Cantico',\n    from: 30,\n    to: 55,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'La Residencia de Redferne',\n    path: 'r9sk2w',\n    from: 20,\n    to: 30,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'Los Pozos de la Reina Aranya',\n    from: 40,\n    to: 55,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'Los Usurpadores de Hochenyana',\n    path: 'r3s6ele',\n    clan: 'Shinsent',\n    from: 20,\n    to: 35,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'Profundidades Umbrias',\n    path: 'r3s5e2n2e3swse3sd9sd',\n    from: 20,\n    to: 50,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'Puerto Libre',\n    path: 'r9ske',\n    from: 10,\n    to: 55,\n    min: 0,\n    max: 95,\n  },\n  {\n    realm: 'Valmorag',\n    name: 'Valle de Morgul',\n    path: 'r9sk2w3us',\n    clan: 'Shinsent',\n    from: 30,\n    to: 55,\n    min: 0,\n    max: 95,\n  },\n] as const;\n","import { ATTACK_RECEIVED, getMobIn } from '../data/mobs';\nimport { Casteable, SPELLS_BY_TYPE } from '../data/spells';\nimport { Context } from '../lib';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { wait } from '../lib/util/wait';\n\nexport type KillResult = 'win' | 'flee' | 'missing';\n\nexport async function kill(\n  { when, write, plugins: { prompt, navigation, skills } }: Context,\n  target: string,\n): Promise<KillResult> {\n  const { dedope } = SPELLS_BY_TYPE;\n  const focused = target.startsWith('!');\n\n  if (focused) {\n    target = target.substr(1);\n  }\n\n  if (!(await repeatUntilCasted(dedope, target))) {\n    write(`matar ${target}`);\n  }\n\n  const unsubscribe = prompt.onUpdate(x => {\n    if (x.hp.percent <= 0.4) {\n      navigation.recall();\n    }\n  });\n\n  when(ATTACK_RECEIVED, async ({ groups }) => {\n    const fullName = groups.mob;\n    const mob = getMobIn(fullName);\n    const name = mob ? mob.name : fullName || target;\n    const attack = focused\n      ? SPELLS_BY_TYPE.attack\n      : ([...SPELLS_BY_TYPE.massAttack, ...SPELLS_BY_TYPE.attack] as Casteable);\n\n    await skills.castSpell(attack, name);\n  });\n\n  let bodyContent: string[] = [];\n\n  const result = await Promise.any<Promise<KillResult>>([\n    navigation.waitForRecall().then(() => 'flee' as const),\n\n    when([\n      concatRegexes(target, /(?:\\w|| )* (ha)|(cae al suelo) MUERTO!!/i),\n      'monedas de oro de el cadaver de un ladron',\n    ]).then(() => 'win' as const),\n\n    when('No esta aqui.')\n      .timeout(3)\n      .then(() => 'missing' as const),\n\n    when([\n      'Huyes como un cobarde del combate.',\n      'Estas demasiado malherido para hacer eso.',\n      'Estas demasiado aturdido para hacer eso.',\n    ]).then(() => 'flee' as const),\n  ]);\n\n  if (result === 'win') {\n    // no need to await for this\n    setTimeout(() => handleBody(bodyContent));\n  }\n\n  unsubscribe();\n  return result;\n\n  async function handleBody(items: string[]) {\n    write('sacrificar cuerpo');\n    await when('te da una moneda de oro por tu sacrificio.');\n  }\n\n  async function repeatUntilCasted(\n    spell: Casteable,\n    target: string,\n  ): Promise<boolean> {\n    switch (await skills.castSpell(spell, target)) {\n      case skills.CASTED:\n      case skills.ALREADY_APPLIED:\n        return true;\n      case skills.NOT_AVAILABLE:\n        return false;\n      case skills.BUSY:\n        await wait(3);\n      case skills.FAILED:\n        return repeatUntilCasted(spell, target);\n    }\n\n    throw new Error('WTF DUDE');\n  }\n}\n","import { SPELLS_BY_TYPE } from '../data/spells';\nimport { Context } from '../lib';\nimport { wait } from '../lib/util/wait';\n\nexport async function recover({ run, plugins: { skills, prompt } }: Context) {\n  const heal = SPELLS_BY_TYPE.heal;\n  const refresh = 'refrescar';\n  const invisible = 'invisibilidad';\n\n  const canHeal = await skills.can(heal);\n  const canRefresh = await skills.can(refresh);\n  const canMeditate = await skills.can('meditar');\n  const canInvisible = await skills.can(invisible);\n\n  const hp = () => prompt.getPercent('hp');\n  const mana = () => prompt.getPercent('mana');\n  const mv = () => prompt.getPercent('mv');\n\n  const needsHeal = () => hp() < 1;\n  const needsToMeditate = () => mana() < 0.8;\n  const needsRefresh = () => mv() < 1;\n\n  const hasEnoughMana = () => (canMeditate ? mana() > 0.5 : mana() > 0.1);\n  const isDone = () =>\n    (canHeal ? !needsHeal() : true) &&\n    (canMeditate ? !needsToMeditate() : true) &&\n    (canRefresh ? !needsRefresh() : true);\n\n  while (!isDone()) {\n    if (canInvisible && !prompt.isInvisible) {\n      await run('cast', [invisible]);\n    }\n\n    while (canHeal && needsHeal() && hasEnoughMana()) {\n      await run('cast', [heal]);\n    }\n\n    while (canRefresh && needsRefresh() && hasEnoughMana()) {\n      await run('cast', [refresh]);\n    }\n\n    while (canMeditate && needsToMeditate()) {\n      const result = await skills.meditate();\n\n      if (result === skills.BUSY) {\n        await wait(2);\n      }\n    }\n  }\n}\n","import { getAreaMetadata, getAreasForLevel } from '../data/areas';\nimport {\n  getMobFromPresence,\n  getMobIn,\n  getMobsPresence,\n  Mob,\n  MOB_ARRIVES,\n  MOB_DIES,\n  MOB_LEAVES,\n} from '../data/mobs';\nimport { Context } from '../lib';\nimport { KillResult } from './kill';\n\nexport async function train(\n  {\n    log,\n    run,\n    when,\n    write,\n    plugins: { navigation: nav, prompt, stats },\n  }: Context,\n  area?: string,\n) {\n  if (area === 'test') {\n    const area = await getBestArea();\n    console.log(area.name, area);\n    return;\n  }\n\n  const arena = await getArena(area);\n  const theif = getMobIn('ladron');\n  const enemies: Mob[] = [];\n\n  when(getMobsPresence(), ({ patterns, fullMatch, captured }) =>\n    enemySpotted(\n      getMobFromPresence(patterns) || getMobIn(fullMatch || captured[0]),\n    ),\n  );\n\n  when(MOB_ARRIVES, ({ groups }) => enemySpotted(getMobIn(groups.mob)));\n  when(\n    MOB_LEAVES,\n    ({ groups }) => groups.mob && enemyGone(getMobIn(groups.mob)),\n  );\n  when(MOB_DIES, ({ groups }) => groups.mob && enemyGone(getMobIn(groups.mob)));\n\n  const route = `${arena.path}${arena.arena}`;\n\n  write('visible');\n  write('huida');\n\n  await nav.execute(route, enterRoom);\n  return nav.recall();\n\n  async function enterRoom() {\n    log('ENTER_ROOM');\n    await prompt.until(({ mv: { current: mv } }) => mv > 50);\n\n    while (enemies.length) {\n      if (await checkEnemies()) {\n        return false;\n      }\n\n      const recover = run('recover');\n      await Promise.any([\n        recover,\n        when(MOB_ARRIVES).then(() => recover.cancel()),\n      ]);\n\n      log('READY_TO_FIGHT!!!');\n    }\n  }\n\n  function enemySpotted(mob: Mob | null = null) {\n    if (mob && (mob !== theif || !enemies.includes(theif))) {\n      enemies.push(mob);\n    }\n  }\n\n  function enemyGone(mob: Mob | null = null) {\n    if (mob) {\n      const index = enemies.indexOf(mob);\n      if (index > -1) {\n        enemies.splice(index, 1);\n      }\n    }\n  }\n\n  async function checkEnemies() {\n    log('CHECK_ENEMIES', enemies.length);\n\n    while (enemies.length) {\n      const enemy = enemies[0];\n      const result = (await run('kill', [enemy.name])) as KillResult;\n\n      if (result === 'flee') {\n        console.log('Had to run. Train over.');\n        await nav.recall();\n        return true;\n      }\n\n      if (result === 'missing') {\n        enemies.shift();\n      }\n    }\n  }\n\n  async function getArena(areaName?: string) {\n    const area = areaName ? getAreaMetadata(areaName) : await getBestArea();\n\n    if (!area) {\n      throw new Error(`NO AREA \"${areaName}\"`);\n    }\n\n    if (!area.arena) {\n      throw new Error(`\"${area.name}\" training path is unknown`);\n    }\n\n    const path = area.path!.split('');\n    const last = path.pop();\n    const arena = Array.isArray(area.arena) ? area.arena.join('') : area.arena;\n\n    return { path: path.join(''), arena: `${last}${arena}` };\n  }\n\n  async function getBestArea() {\n    const [realm, level] = await Promise.all([\n      nav.getRealm(),\n      stats.getLevel(),\n    ]);\n\n    const areas = getAreasForLevel(realm, level);\n    const [first, ...others] = areas.filter(x => x.arena);\n\n    if (others.length) {\n      console.warn('Multiple arenas available');\n    }\n\n    console.log('Selected', first.name);\n    return first;\n  }\n}\n","import {\n  getItemSustantive,\n  ITEM_ARTICLE,\n  ITEM_SUSTANTIVES,\n  UNWEAR,\n  WEAR,\n} from '../data/items';\nimport { Context } from '../lib';\nimport { concatRegexes } from '../lib/util/concatRegexes';\n\nexport async function wear({ run, when, write }: Context, ...args: string[]) {\n  const items = args.length ? args : ITEM_SUSTANTIVES;\n\n  for (const item of items) {\n    for (let i = 0; i < 5; i++) {\n      if (await wearItem(item)) {\n        break;\n      }\n    }\n  }\n\n  async function wearItem(item: string) {\n    write(`coger \"${item}\"`);\n\n    const pickedUp = await Promise.any([\n      when(`No hay ningun ${item} aqui.`)\n        .wait(8)\n        .then(() => false),\n      when(\n        concatRegexes(/Coges/, ITEM_ARTICLE, /(?: (?:\\\\w|)+)* /i, item),\n      ).then(() => true),\n    ]);\n\n    if (!pickedUp) {\n      throw new Error(`Couldn't pick up \"${item}\"`);\n    }\n\n    let isMetallic = false;\n\n    const sus = when(' es un(a) armadura_metalica,', () => (isMetallic = true));\n    const identified = await run('cast', ['identificar', item]);\n    sus.unsubscribe();\n\n    if (!identified) {\n      throw new Error(`Couldn't identifiy \"${item}\"`);\n    }\n\n    if (isMetallic) {\n      await tirar(item);\n      return false;\n    }\n\n    write(`vestir \"${item}\"`);\n\n    const result = await Promise.any([\n      when(WEAR).then(() => true),\n      when(UNWEAR).then(({ groups }) => groups.item),\n      when([\n        /Debes ser nivel \\w+ para usar este objeto./,\n        'No puedes vestir eso, necesita repararse.',\n      ]).then(() => false),\n    ]);\n\n    if (result === false) {\n      await tirar(item);\n      return false;\n    }\n\n    if (typeof result === 'string') {\n      const other = getItemSustantive(result);\n\n      if (other) {\n        await run('cast', ['identificar', other]);\n        write(`poner ${other} mochila`);\n        await when('Pones ');\n      }\n    }\n\n    return true;\n  }\n\n  function tirar(item: string) {\n    write(`tirar \"${item}\"`);\n    return when('Tiras ');\n  }\n}\n","import './index.css';\n\nimport { ClientStorage } from '@amatiasq/client-storage';\nimport { dom } from '@amatiasq/dom';\n\nimport { Controls } from './Controls';\nimport { Hamburger } from './Hamburger';\nimport { Sidebar } from './Sidebar';\nimport { Terminal } from './Terminal';\n\nexport function renderUserInterface(parent: HTMLElement) {\n  const state = initState();\n  const data = state.get()!;\n\n  const sidebar = new Sidebar();\n  const controls = new Controls();\n  const terminal = new Terminal();\n\n  const hamburger = new Hamburger(data.showControls);\n  hamburger.onChange(onControlsToggle);\n\n  const main = dom`\n    <div class=\"container\">\n      ${sidebar.render()}\n      ${controls.render()}\n      ${terminal.render()}\n    </div>\n  `;\n\n  parent.appendChild(main);\n  parent.appendChild(hamburger.render());\n\n  onControlsToggle(data.showControls);\n\n  return { controls, sidebar, terminal };\n\n  function onControlsToggle(value: boolean) {\n    if (value) {\n      main.classList.add('show-controls');\n      data.showControls = true;\n    } else {\n      main.classList.remove('show-controls');\n      data.showControls = false;\n    }\n\n    state.set(data);\n  }\n}\n\nfunction initState() {\n  const state = new ClientStorage<{ showControls: boolean }>('ui:state');\n  const data = state.get();\n\n  if (!data) {\n    state.set({ showControls: false });\n  }\n\n  return state;\n}\n","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!./index.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import { dom } from '@amatiasq/dom';\n\ntype Observable = (listener: (data: number) => void) => void;\n\nexport class Controls {\n  private readonly $meters = dom`<div class=\"meters\"></div>`;\n  private readonly $el = dom`<header class=\"controls\">${this.$meters}</div>`;\n\n  render() {\n    return this.$el;\n  }\n\n  addMeter(color: string, observable: Observable) {\n    const el = dom`<div class=\"meter\"><div class=\"bar\"></div></div>`;\n\n    el.style.setProperty('--color', color);\n    el.style.setProperty('--value', '100%');\n\n    observable(value => {\n      const percent = Math.round(value * 100);\n      el.style.setProperty('--value', `${percent}%`);\n    });\n\n    this.$meters.appendChild(el);\n  }\n\n  addButton(name: string, onClick: () => void) {\n    const el = dom`<button class=\"ui-button\">${name}</button>`;\n    el.addEventListener('click', onClick);\n    this.$el.appendChild(el);\n  }\n}\n","import { dom } from '@amatiasq/dom';\nimport { emitter } from '@amatiasq/emitter';\n\nexport class Hamburger {\n  private readonly $checkbox = dom<HTMLInputElement>`<input type=\"checkbox\" />`;\n  private readonly $el = dom`\n    <div class=\"hamburger\">\n      ${this.$checkbox}\n      <span></span>\n      <span></span>\n      <span></span>\n    </div>\n  `;\n\n  private readonly emitChange = emitter<boolean>();\n  readonly onChange = this.emitChange.subscribe;\n\n  constructor(initialState = false) {\n    this.toggle = this.toggle.bind(this);\n    this.$checkbox.checked = initialState;\n  }\n\n  render() {\n    this.$checkbox.addEventListener('change', this.toggle);\n\n    if (this.$checkbox.checked) {\n      this.toggle();\n    }\n\n    return this.$el;\n  }\n\n  toggle() {\n    this.emitChange(this.$checkbox.checked);\n  }\n}\n","import { dom } from '@amatiasq/dom';\nimport { Mud } from '../lib/Mud';\n\nimport { Workflow } from '../lib/workflow/Workflow';\n\nexport class Sidebar {\n  private readonly $workflows = dom`<ul class=\"workflow-list\"></ul>`;\n  private readonly $el = dom`\n    <aside class=\"sidebar\">\n      <div class=\"workflows\">\n        <h1 class=\"title\">Workflows</h1>\n        ${this.$workflows}\n      </div>\n    </aside>\n  `;\n\n  private refresh = () => {};\n  private readonly subscriptions = new Set<Function>();\n\n  render() {\n    return this.$el;\n  }\n\n  clear() {\n    this.$workflows.innerHTML = '';\n    this.subscriptions.forEach(x => x());\n    this.subscriptions.clear();\n  }\n\n  setWorkflows(workflows: Workflow[], mud: Mud) {\n    this.clear();\n    this.refresh = () => this.setWorkflows(workflows, mud);\n\n    for (const workflow of workflows) {\n      this.$workflows.appendChild(this.renderWorkflow(workflow));\n    }\n  }\n\n  private renderWorkflow(workflow: Workflow) {\n    const { isEnabled, isRunning, instancesRunning } = workflow;\n    const instances = instancesRunning > 1 ? ` (${instancesRunning})` : '';\n    const name = `${workflow.name}${instances}`;\n\n    this.subscriptions.add(workflow.onChange(this.refresh));\n\n    const expand = button(icon('caret-right'), () =>\n      el.classList.toggle('expaneded'),\n    );\n\n    const classes = [\n      'workflow',\n      isRunning ? 'running' : 'idle',\n      isEnabled ? 'enabled' : 'disabled',\n    ];\n\n    const el = dom`\n      <li class=\"${classes}\">\n        <div class=\"workflow-content\">\n          <header>\n            ${expand}\n            <h3 class=\"name\">${name}</h3>\n            ${this.getWorkflowActions(workflow)}\n          </header>\n\n          <!--\n          <ul class=\"triggers\">\n            To be implemented...\n          </ul>\n          -->\n        </div>\n      </li>\n    `;\n\n    return el;\n  }\n\n  private getWorkflowActions(workflow: Workflow) {\n    const { isEnabled, isRunning } = workflow;\n\n    const enabler = isEnabled\n      ? button([icon('check'), icon('times')], () => workflow.disable())\n      : button([icon('times'), icon('check')], () => workflow.enable());\n\n    enabler.classList.add('enable-control');\n\n    const actions = [enabler];\n\n    if (isEnabled) {\n      actions.push(\n        isRunning\n          ? button(icon('stop'), () => workflow.stop())\n          : button(icon('play'), () => workflow.execute()),\n      );\n    }\n\n    return actions;\n  }\n}\n\nfunction button(\n  content: HTMLElement[] | HTMLElement | string,\n  onClick: (event: MouseEvent) => void,\n) {\n  const el = dom`<button class=\"action\">${content}</button>`;\n  el.addEventListener('click', onClick);\n  return el;\n}\n\nfunction icon(name: string) {\n  return dom`<i class=\"fas fa-${name}\"></i>`;\n}\n","import Convert from 'ansi-to-html';\n\nimport { ClientStorage } from '@amatiasq/client-storage';\nimport { dom } from '@amatiasq/dom';\nimport { emitter } from '@amatiasq/emitter';\n\nconst convert = new Convert();\nconst history = new ClientStorage<string[]>('mud:command-history');\nconst MIN_INPUT_SIZE = 3;\n\nexport class Terminal {\n  private readonly $log = dom`<span class=\"log\"></span>`;\n  private readonly $input = dom<\n    HTMLInputElement\n  >`<input type=\"text\" size=\"${MIN_INPUT_SIZE}\" autofocus>`;\n  private readonly $el = dom`\n    <main class=\"terminal\">\n      <div class=\"scroll-bottom\">\n        ${this.$log}\n        ${this.$input}\n      </div>\n    </main>\n  `;\n\n  private readonly history: string[] = history.get() || [];\n  private lastChunk: string = '';\n  private histPos = 0;\n\n  private readonly emitSubmit = emitter<string>();\n  readonly onSubmit = this.emitSubmit.subscribe;\n\n  constructor() {\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.onKeyUp = this.onKeyUp.bind(this);\n  }\n\n  focus() {\n    this.$input.focus();\n  }\n\n  render() {\n    this.$el.addEventListener('click', () =>\n      setTimeout(() => !userHasSelectedText() && this.$input.focus(), 80),\n    );\n\n    this.$input.addEventListener('keydown', this.onKeyDown);\n    this.$input.addEventListener('keyup', this.onKeyUp);\n\n    return this.$el;\n  }\n\n  write(data: string) {\n    const content = `${this.lastChunk}${fixLineEndings(data)}`.split(/\\n\\n+/);\n    this.lastChunk = content.pop()!;\n\n    for (const block of content) {\n      this.$log.before(dom`<p>${{ __html__: asciiToHtml(block) }}</p>`);\n    }\n\n    this.$log.innerHTML = asciiToHtml(this.lastChunk);\n  }\n\n  private onKeyDown(event: KeyboardEvent) {\n    if (event.code === 'Enter') {\n      this.submit();\n    }\n\n    if (event.code === 'ArrowUp') {\n      this.loadHistory(1);\n    }\n\n    if (event.code === 'ArrowDown') {\n      this.loadHistory(-1);\n    }\n\n    this.onKeyUp(event);\n  }\n\n  private onKeyUp(event: KeyboardEvent) {\n    const value = this.$input.value;\n    this.history[0] = value;\n    this.$input.size = value.length + MIN_INPUT_SIZE;\n  }\n\n  private submit() {\n    const { value } = this.$input;\n    this.$input.value = '';\n    this.histPos = 0;\n\n    if (value && value !== this.history[1]) {\n      this.history.shift();\n      this.history.unshift(value);\n      this.history.unshift('');\n      history.set(this.history);\n    }\n\n    for (const command of value.split(/;\\s+/)) {\n      this.emitSubmit(command);\n    }\n  }\n\n  private loadHistory(modifier: 1 | -1) {\n    if (!this.history.length) {\n      return;\n    }\n\n    this.history[this.histPos] = this.$input.value;\n    this.histPos = clamp(this.histPos + modifier, 0, this.history.length - 1);\n    this.$input.value = this.history[this.histPos];\n  }\n}\n\nfunction asciiToHtml(text: string) {\n  const escaped = escapeHtml(text);\n  const html = convert.toHtml(escaped);\n  return html.replace(/\\n/g, '<br>');\n}\n\nfunction fixLineEndings(text: string) {\n  return text.replace(/\\r/g, '');\n}\n\nfunction escapeHtml(unsafe: string) {\n  return unsafe\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#039;')\n    .replace(/  +/g, x => '&nbsp;'.repeat(x.length));\n}\n\nfunction userHasSelectedText() {\n  const selection = getSelection();\n  return selection && selection.type === 'Range';\n}\n\nfunction clamp(value: number, min: number, max: number) {\n  return value < min ? min : value > max ? max : value;\n}\n","import { ClientStorage } from '@amatiasq/client-storage';\n\nexport function getPassword(user: string) {\n  const storage = new ClientStorage<string>(`pass:${user}`);\n  const stored = storage.get();\n\n  if (stored) {\n    return stored;\n  }\n\n  const input = prompt(`Password for ${user}`);\n\n  if (!input) {\n    throw new Error(`Password required`);\n  }\n\n  storage.set(input);\n  return input;\n}\n","export function getQueryParams() {\n  const result: { [key: string]: string } = {};\n\n  window.location.search\n    .substr(1)\n    .split('&')\n    .map(entry => entry.split('=').map(decodeURIComponent))\n    .forEach(([key, value]) => (result[key] = value));\n\n  return result;\n}\n"],"sourceRoot":""}
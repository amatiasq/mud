{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/lib/util/concatRegexes.ts","webpack:///./src/ui/render.ts","webpack:///./src/lib/util/wait.ts","webpack:///./src/data/spells.ts","webpack:///./src/lib/util/int.ts","webpack:///./src/data/items.ts","webpack:///./src/ui/index.css","webpack:///./src/ui/Controls/Controls.css","webpack:///./src/ui/Hamburger/Hamburger.css","webpack:///./src/ui/Sidebar/Sidebar.css","webpack:///./src/ui/Terminal/Terminal.css","webpack:///./src/lib/util/singleExecution.ts","webpack:///./src/lib/triggers/PatternPromise.ts","webpack:///./src/plugins/promptPlugin.ts","webpack:///./src/lib/PluginContext.ts","webpack:///./src/lib/ExecutionAbortedError.ts","webpack:///./src/lib/util/bindAll.ts","webpack:///./src/data/mobs.ts","webpack:///./src/data/areas.ts","webpack:///./src/index.ts","webpack:///./src/lib/Mud.ts","webpack:///./src/plugins/index.ts","webpack:///./src/plugins/chatPlugin.ts","webpack:///./src/lib/util/dateTime.ts","webpack:///./src/lib/util/requestNotificationPermission.ts","webpack:///./src/plugins/inventoryPlugin.ts","webpack:///./src/plugins/navigationPlugin.ts","webpack:///./src/lib/triggers/PatternPromiseTimeoutError.ts","webpack:///./src/plugins/skillsPlugin.ts","webpack:///./src/plugins/statsPlugin.ts","webpack:///./src/plugins/login.ts","webpack:///./src/lib/triggers/TriggerCollection.ts","webpack:///./src/lib/triggers/PatternMatcher.ts","webpack:///./src/lib/util/trimEnd.ts","webpack:///./src/lib/triggers/PatternResult.ts","webpack:///./src/lib/workflow/Context.ts","webpack:///./src/lib/workflow/MissingPluginError.ts","webpack:///./src/lib/workflow/Workflow.ts","webpack:///./src/lib/workflow/WorkflowNotFoundError.ts","webpack:///./src/lib/RemoteTelnet.ts","webpack:///./src/registerWorkflows.ts","webpack:///./src/daemons/defend.ts","webpack:///./src/daemons/dope.ts","webpack:///./src/util/uniq.ts","webpack:///./src/daemons/drink.ts","webpack:///./src/daemons/eat.ts","webpack:///./src/daemons/idle.ts","webpack:///./src/daemons/repair.ts","webpack:///./src/daemons/rest.ts","webpack:///./src/workflows/afk.ts","webpack:///./src/workflows/bank.ts","webpack:///./src/workflows/cast.ts","webpack:///./src/workflows/donations.ts","webpack:///./src/workflows/go.ts","webpack:///./src/data/realms.ts","webpack:///./src/workflows/kill.ts","webpack:///./src/workflows/train.ts","webpack:///./src/workflows/wear.ts","webpack:///./src/ui/index.ts","webpack:///./src/ui/index.css?3ef0","webpack:///./src/ui/Controls/Controls.ts","webpack:///./src/ui/Controls/Controls.css?eebb","webpack:///./src/ui/Controls/Controls.html","webpack:///./src/ui/Hamburger/Hamburger.ts","webpack:///./src/ui/Hamburger/Hamburger.css?b2d9","webpack:///./src/ui/Hamburger/Hamburger.html","webpack:///./src/ui/index.html","webpack:///./src/ui/Sidebar/Sidebar.ts","webpack:///./src/ui/Sidebar/Sidebar.css?e0a4","webpack:///./src/ui/Sidebar/Sidebar.html","webpack:///./src/ui/Terminal/Terminal.ts","webpack:///./src/ui/Terminal/Terminal.css?82ae","webpack:///./src/ui/Terminal/Terminal.html","webpack:///./src/util/getPassword.ts","webpack:///./src/util/getQueryParams.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","createConcatenator","escape","regexes","join","map","x","RegExp","toString","replace","flags","filter","Boolean","uniq","Set","escapeRegExp","concatRegexes","concatRegexesUnescaped","String","clone","el","cloneNode","template","config","html","document","createElement","innerHTML","renderHtml","instance","HTMLTemplateElement","content","selector","operator","entries","querySelector","console","error","assign","$","seconds","Promise","resolve","setTimeout","getSpells","SPELLS","desc","UNKNOWN","SPELL_FAILED","SPELL_ALREADY_APPLIED","SPELL_NOT_POSSIBLE","SPELLS_BY_TYPE","food","water","levitate","heal","attack","dedope","SPELL_LEARN_ORDER","lower","toLowerCase","find","startsWith","armadura","success","target","endEffect","dope","bendecir","ceguera","flotar","identificar","invisibilidad","afterDope","maldecir","proteccion","refrescar","terremoto","veneno","volar","NUMBER","parseInt","ITEM_ARTICLE","WEAR","UNWEAR","ITEM_SUSTANTIVES","item","includes","___CSS_LOADER_EXPORT___","fn","running","then","executor","_reject","super","reject","this","forceReject","wait","PatternPromiseTimeoutError","race","PROMPT","FPROMPT","captureProgress","int","PROMPT_DETECTOR","Stat","total","current","Math","round","async","when","write","isInvisible","stats","hp","mana","mv","exp","gold","enemy","update","emitter","timeout","catch","finally","groups","g","toInt","hpCurr","hpTotal","mCurr","mTotal","mvCurr","mvTotal","invis","getPercent","stat","percent","until","whenFresh","log","onUpdate","subscribe","isFighting","predicate","unsubscribe","PluginContext","username","triggers","send","subscriptions","isPrintingLogs","isAborted","bindAll","command","options","checkNotAborted","pattern","handler","add","forEach","args","ExecutionAbortedError","Error","source","proto","getOwnPropertyNames","getOwnPropertyDescriptor","method","MOB_ARTICLE","ALLIES","MOB_SUSTANTIVES","text","some","warn","MOB_ARRIVES","MOB_LEAVES","MOB_PRESENT","ALL_AREAS","values","flat","METADATA","path","arena","DarkHaven","avg","area","level","abs","from","to","getWithMetadata","Calimhar","sort","a","b","areaName","first","candidates","toLocaleLowerCase","serverUri","location","origin","DEFAULT_PORT","host","port","user","pass","server","getQueryParams","split","getPassword","getParams","terminal","controls","renderUserInterface","body","socket","WebSocket","addEventListener","telnet","RemoteTelnet","connect","mud","Mud","connectStats","addMeter","getPlugin","connectButtons","addButton","run","runWorkflow","cmd","message","onCommand","onData","onbeforeunload","isConnected","close","onSubmit","workflow","substr","userInput","login","registerWorkflows","initializeMud","openSocket","TriggerCollection","workflows","emitCommand","whenLoggedIn","emitLoggedIn","process","removeAsciiCodes","context","plugins","initializePlugins","dispose","password","repeat","params","Workflow","runForever","executeWorkflow","WorkflowNotFoundError","logs","createWorkflowContext","printLogs","promise","execute","abort","Context","chat","chatPlugin","inventory","inventoryPlugin","navigation","navigationPlugin","prompt","promptPlugin","skills","skillsPlugin","statsPlugin","promises","plugin","all","fromEntries","version","receive","addMessage","requestNotificationPermission","Notification","notify","sent","partial","datetime","Date","set","order","ClientStorage","tell","whisper","pad","val","date","getFullYear","getMonth","getDate","getHours","getMinutes","permission","requestPermission","INVENTORY_DETECTOR","isInitialized","items","refresh","singleExecution","captured","_","trim","match","captureLength","has","search","hasSync","Array","isArray","keys","CLOSED","aliases","e","w","u","k","h","isNavigating","landingAtRecall","isAtRecall","directions","roomChanged","closed","dir","any","canGo","go","callback","recall","untilEnd","step","times","toUpperCase","move","waitForRecall","PatternPromise","onRoomChange","direction","isClosed","NOT_AVAILABLE","undefined","CASTED","SKILL","SKILLS_DETECTOR","isSpellRunning","skill","matchAll","canLearn","ensureInitiated","castSpell","getSpell","learnt","spell","BUSY","FAILED","ALREADY_APPLIED","SIZE","STATE_DETECTOR","low","ANY","DASH","SPACE","PIPE","row","isInitiated","principal","fue","fueBase","des","desBase","vida","vidaBase","vidaRegen","intBase","sab","sabBase","manaBase","manaRegen","con","conBase","car","carBase","mov","movBase","movRegen","sue","sueBase","initialize","await","once","patterns","queue","isProcessing","arguments","watch","entry","PatternMatcher","delete","original","sub","splitted","last","pop","lines","line","max","buffer","clear","trimEnd","matching","testPattern","PatternResult","output","indexOf","test","maxLength","isRegex","merge","haystack","stringPatterns","reduce","register","finish","Proxy","MissingPluginError","executionCount","currentExecutions","iteration","_isConnected","emitClose","onClose","emitData","onMessage","proxy","type","payload","JSON","stringify","event","afk","bank","cast","donations","kill","train","wear","daemon","defend","drink","eat","idle","repair","rest","fullName","getMobIn","RECUPERED","bodies","sus","memory","shouldHeal","defineShould","shouldRefresh","repeatUntilCasted","casting","spells","min","multiplier","clapped","hypot","invoke","after","list","isFontAvailable","isBottleFull","getWaterBottle","bottle","nav","eatSomething","getFoodFromBag","getFoodFromInventory","err","createFood","buyFood","repairEquipment","broken","repairAll","getBrokenEquipment","getItemSustantive","areas","action","floor","random","take","INGRESS","EXTRACT","carring","balance","final","ceil","rooms","getLevel","room","Number","MAX_VALUE","itemsMatch","PATH","getAreaMetadata","clan","Earand","Niruk","Valmorag","attackSpells","tryNTimes","getAreasForLevel","others","getBestArea","getArena","enemies","fullMatch","enemySpotted","mob","index","enemyGone","route","checkEnemies","readyToFight","wearItem","isMetallic","identified","tirar","other","parent","state","showControls","initState","dom","render","main","sidebar","Sidebar","Controls","Terminal","appendChild","hamburger","Hamburger","onChange","classList","remove","locals","meterTpl","buttonTpl","color","observable","fragment","style","setProperty","onClick","button","textContent","initialState","checkbox","emitChange","toggle","checked","convert","history","asciiToHtml","escaped","toHtml","userHasSelectedText","selection","getSelection","$log","$input","histPos","emitSubmit","onKey","focus","$parent","parentElement","block","insertBefore","scrollTop","scrollHeight","code","submit","loadHistory","size","unshift","modifier","storage","stored","input","decodeURIComponent"],"mappings":"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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([26,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","const createConcatenator = (escape: (x: string) => string) => (\n  ...regexes: (RegExp | string)[]\n) => {\n  const join = regexes\n    .map(x => (x instanceof RegExp ? regexToString(x) : escape(x)))\n    .join('');\n\n  const flags = regexes\n    .map(x => x instanceof RegExp && x.flags)\n    .filter(Boolean)\n    .join('');\n\n  const uniq = [...new Set(flags)].join('');\n  return new RegExp(join, uniq);\n};\n\nexport const concatRegexes = createConcatenator(escapeRegExp);\nexport const concatRegexesUnescaped = createConcatenator(String);\n\nfunction regexToString(value: RegExp) {\n  return value.toString().replace(/^\\/|\\/[gi]*$/g, '');\n}\n\nfunction stringToRegex(value: string, flags: string) {\n  return new RegExp(escapeRegExp(value));\n}\n\nfunction escapeRegExp(value: string) {\n  // $& means the whole matched string\n  return value.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&').replace(/\\n/g, '\\\\n');\n}\n","export function render(\n  template: string | HTMLElement,\n  config?: Record<string, (el: HTMLElement) => void>,\n) {\n  if (typeof template === 'string') {\n    template = renderHtml(template);\n  }\n\n  const instance =\n    template instanceof HTMLTemplateElement\n      ? clone(template.content)\n      : clone(template);\n\n  if (config) {\n    for (const [selector, operator] of Object.entries(config)) {\n      const el = instance.querySelector(selector) as HTMLElement;\n\n      if (el) {\n        operator(el);\n      } else {\n        console.error(`Selector ${selector} returned no results`);\n      }\n    }\n  }\n\n  return Object.assign(instance, {\n    $: <T extends HTMLElement>(selector: string) =>\n      instance.querySelector(selector) as T,\n  });\n}\n\nfunction renderHtml(html: string) {\n  const template = document.createElement('template');\n  template.innerHTML = html;\n  return template;\n}\n\nfunction clone<T extends Node>(el: T) {\n  return el.cloneNode(true) as T;\n}\n","export function wait(seconds: number) {\n  return new Promise<void>(resolve => setTimeout(resolve, seconds * 1000));\n}\n","import { Pattern } from './../lib/triggers/Pattern';\nexport type SpellName = keyof typeof SPELLS;\nexport type Spell = SpellName | SpellName[];\n\nexport const UNKNOWN = null;\nexport type UNKNOWN = typeof UNKNOWN;\n\nexport const SPELL_FAILED = [\n  'Algo te distrae y pierdes la concentracion.',\n  'Has perdido la concentracion.',\n  'Has tenido una laguna mental mientras invocabas el hechizo.',\n  'Pierdes la concentracion.',\n  'Un picor en la nariz te impide mantener la concentracion.',\n  'Un pinchazo en tu pierna te impide lanzar el conjuro adecuadamente.',\n  'Una mota de polvo en el ojo rompe tu concentracion por un momento.',\n];\n\nexport const SPELL_ALREADY_APPLIED = [\n  'Has fallado.',\n  'Eso no parece tener ningun efecto.',\n];\n\nexport const SPELL_NOT_POSSIBLE = [\n  'No tienes suficiente mana.',\n  'Sobre que quieres lanzar este conjuro?',\n  'No puedes encontrar ningun ',\n  'Este estilo de lucha pide demasiado atencion para hacer eso!',\n  'Este asalto del combate es demasiado febril para concentrarte adecuadamente.',\n  'No has tenido suficiente tiempo en este asalto para completar el conjuro.',\n  'Estas demasiado malherido para hacer eso.',\n  'Estas demasiado aturdido para hacer eso.',\n];\n\nexport const SPELLS_BY_TYPE: Record<string, Spell> = {\n  food: ['crear baya', 'crear comida'],\n  water: ['crear manantial', 'crear agua'],\n  levitate: ['volar', 'flotar'],\n  heal: ['curar criticas', 'curar graves', 'curar leves'],\n  attack: ['causar critica', 'causar grave', 'causar leve'],\n  dedope: ['ceguera', 'veneno'],\n};\n\nexport const SPELL_LEARN_ORDER: Spell[] = [\n  // Survival\n  SPELLS_BY_TYPE.food,\n  SPELLS_BY_TYPE.water,\n  SPELLS_BY_TYPE.dedope,\n  'luz eterna',\n\n  // Love\n  'invisibilidad',\n  'invocar armadillo',\n\n  // Dope\n  'armadura',\n  'bendecir',\n  'detectar escondido',\n  'detectar invisible',\n  'detectar magia',\n  SPELLS_BY_TYPE.levitate,\n\n  // Medic\n  'curar ceguera',\n  SPELLS_BY_TYPE.heal,\n  'refrescar',\n\n  // Other\n  SPELLS_BY_TYPE.attack,\n  'crear fuego',\n];\n\nexport function getSpells(): SpellDescription[] {\n  return Object.entries(SPELLS)\n    .filter(([name, desc]) => desc)\n    .map(([name, desc]) => ({\n      ...((desc as any) as Omit<SpellDescription, 'name'>),\n      name: name as SpellName,\n    }));\n}\n\nexport function getSpell(name: string) {\n  const lower = name.toLowerCase();\n  return getSpells().find(x => x.name.toLowerCase().startsWith(lower));\n}\n\nconst SPELLS = {\n  armadura: {\n    success: 'Tu armadura brilla suavemente al ser mejorada por un conjuro.',\n    target: /La armadura de (?<target>(?:\\w+ )+)brilla suavemente al ser mejorada por un conjuro\\./,\n    endEffect: 'Tu armadura vuelve a su valor normal.',\n    dope: true,\n  },\n\n  bendecir: {\n    success: 'Tu dios te otorga una poderosa bendicion.',\n    endEffect: 'La bendicion desaparece.',\n  },\n\n  'bola fuego': UNKNOWN,\n\n  'causar critica': UNKNOWN,\n\n  'causar grave': {\n    success: /Tu conjuro [^\\n]+ a( w+)+!/,\n  },\n\n  'causar leve': UNKNOWN,\n\n  ceguera: {\n    success: /Lanzas un conjuro de ceguera contra ([^.]+)./,\n  },\n\n  'conocer alineamiento': UNKNOWN,\n\n  'control climatico': UNKNOWN,\n\n  'crear agua': {\n    success: ' esta lleno.\\n',\n  },\n\n  'crear baya': UNKNOWN,\n\n  'crear comida': {\n    success: 'Una seta magica aparece de repente.',\n  },\n\n  'crear fuego': {\n    success: 'Una gran hoguera se enciende en el suelo delante tuyo.',\n  },\n\n  'crear manantial': {\n    success:\n      'Trazas un circulo delante tuyo del cual emerge un manantial de agua cristalina.',\n    endEffect: 'Un manantial magico se seca.',\n  },\n\n  'curar ceguera': UNKNOWN,\n  'curar criticas': UNKNOWN,\n  'curar graves': UNKNOWN,\n\n  'curar leves': {\n    success: 'Tus heridas leves se cierran y el dolor desaparece.',\n  },\n\n  'curar veneno': UNKNOWN,\n\n  'detectar escondido': {\n    success: 'Tus sentidos cobran la viveza de los del mejor predador.',\n    target: false,\n    endEffect: 'Te sientes menos consciente de lo que te rodea.',\n    dope: true,\n  },\n\n  'detectar invisible': {\n    success: 'Tus ojos brillan, siendo capaces ahora de ver lo invisible.',\n    target: false,\n    endEffect: 'Ya no ves objetos invisibles.',\n    dope: true,\n  },\n\n  'detectar magia': {\n    success:\n      'Delgadas lineas azules reseguiran las siluetas de los objetos magicos que te encuentres.',\n    target: false,\n    endEffect: 'Las lineas azules desaparecen de tu vision',\n    dope: true,\n  },\n\n  'detectar maldad': {\n    success:\n      'Delgadas lineas rojas reseguiran las siluetas de los seres malvados que te encuentres.',\n    target: false,\n    endEffect: 'Las lineas rojas desaparecen de tu vision.',\n    dope: true,\n  },\n\n  'detectar trampas': {\n    success: 'De repente te sientes mas alerta de los peligros que te rodean.',\n    target: false,\n    endEffect: 'Te sientes menos alerta de los peligros que te rodean.',\n    dope: true,\n  },\n\n  'detectar veneno': UNKNOWN,\n  'disipar magia': UNKNOWN,\n  'disipar maldad': UNKNOWN,\n\n  flotar: {\n    success: 'Empiezas a flotar a unos centimetros del suelo...',\n    endEffect: 'Tus pies aterrizan suavemente en el suelo.',\n    dope: ['volar', 'flotar'],\n  },\n\n  'fuego espectral': UNKNOWN,\n\n  identificar: {\n    success: /El objeto '(?<name>[^']+)' es un\\(a\\) (?<type>\\w+), propiedades especiales: (?<properties>[^\\n]+)\\n/,\n  },\n\n  invisibilidad: {\n    success: 'Te desvaneces en el aire.',\n    target: /(?<target>(?:\\w+ )+)se desvanece en el aire./,\n    endEffect: 'Ya no eres invisible.',\n    dope: true,\n  },\n\n  'invocar armadillo': {\n    success:\n      'Agitas tus brazos a la vez que te concentras para invocar un pequenyo armadillo.',\n    endEffect: UNKNOWN,\n  },\n\n  'llamar rayo': UNKNOWN,\n  'localizar objeto': UNKNOWN,\n\n  'luz eterna': {\n    success:\n      'Rayos de luz iridiscente colisionan para formar una bola de luz eterna...',\n    endEffect: 'Esta completamente oscuro ...',\n    afterDope: ['vestir luz', 'mirar'],\n  },\n\n  maldecir: UNKNOWN,\n  'misil magico': UNKNOWN,\n  'niebla espectral': UNKNOWN,\n\n  'piel robliza': {\n    success: 'Tu piel se oscurece a la vez que adquiere la dureza del roble.',\n    target: false,\n    endEffect: 'Tu piel vuelve a su estado normal...',\n    dope: true,\n  },\n\n  proteccion: UNKNOWN,\n\n  refrescar: {\n    success: 'Nueva vitalidad fluye hacia ti.',\n  },\n\n  'retirar invisibilida': UNKNOWN,\n  'saciar hambre': UNKNOWN, // LEARN\n  terremoto: UNKNOWN,\n  veneno: UNKNOWN,\n\n  volar: {\n    success: 'Te elevas entre las corrientes de aire...',\n    target: /(?<target>(?:\\w+ )+)se eleva entre las corrientes de aire.../,\n    endEffect: 'Aterrizas suavemente en el suelo.',\n    dope: ['volar', 'flotar'],\n  },\n} as const;\n\nSPELLS as Record<string, UNKNOWN | Omit<SpellDescription, 'name'>>;\n\nexport interface SpellDescription {\n  readonly name: SpellName;\n  readonly success: Pattern;\n  readonly target?: Pattern | false;\n  readonly endEffect?: Pattern | UNKNOWN;\n  readonly dope?: true | readonly SpellName[];\n  readonly afterDope?: string | readonly string[];\n}\n","import { concatRegexesUnescaped } from './concatRegexes';\n\nconst NUMBER = /-?\\d+(?:,\\d{3})*/;\n\nexport function toInt(value: string) {\n  return parseInt(value.replace(/,/g, ''), 10);\n}\n\nexport function int(name?: string) {\n  return name ? concatRegexesUnescaped(`(?<${name}>`, NUMBER, ')') : NUMBER;\n}\n","import { concatRegexes } from '../lib/util/concatRegexes';\n\nexport type ItemName = typeof ITEM_SUSTANTIVES[number];\n\nexport const ITEM_ARTICLE = /(?: (?:un|una|el|la|los|las|unos|unas))?/;\n\nexport const WEAR = [\n  'Te colocas ',\n  'Te pones ',\n  'Metes las piernas ',\n  'Vistes ',\n];\nexport const UNWEAR = concatRegexes(\n  /Dejas de usar/,\n  ITEM_ARTICLE,\n  / (?<item>[^.]+?)\\./,\n);\n\nexport const ITEM_SUSTANTIVES = [\n  'amuleto',\n  'anillo',\n  'anteojos',\n  'armadura',\n  'baculo',\n  'baston',\n  'bola',\n  'botas',\n  'brazal',\n  'brazalete',\n  'brazaletes',\n  'brigandina',\n  'capa',\n  'capote',\n  'casco',\n  'cetro',\n  'cinto',\n  // 'cinturon',\n  'coderas',\n  'colgante',\n  'collar',\n  'coraza',\n  'cota',\n  'cubrepiernas',\n  'daga',\n  'escudo',\n  'espada',\n  'faja',\n  'faldones',\n  'grebas',\n  'guanteletes',\n  'guantes',\n  'hacha',\n  // 'joya',\n  'lanza',\n  'luz',\n  'mangas',\n  'manoplas',\n  'martillo',\n  'maza',\n  'mocasines',\n  'pendiente',\n  'perneras',\n  'peto',\n  'pica',\n  'placa',\n  'polainas',\n  'pulsera',\n  'ropaje',\n  'sombrero',\n  'tobillera',\n  'vara',\n  'varita',\n  'visera',\n  'yelmo',\n] as const;\n\nexport function getItemSustantive(item: string): ItemName | null {\n  const lower = item.toLowerCase();\n  return ITEM_SUSTANTIVES.find(x => lower.includes(x)) || null;\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"body {\\n  --background-color: #1c1c1c;\\n  --border-color: #484848;\\n  background-color: black;\\n  color: white;\\n}\\n\\n.container {\\n  height: 100%;\\n  display: grid;\\n  grid-template-rows: 1fr;\\n  grid-template-columns: 1fr;\\n  grid-template-areas: 'terminal';\\n}\\n\\n.container.show-controls {\\n  grid-template-rows: 50px auto;\\n  grid-template-columns: 9fr 3fr;\\n  grid-template-areas:\\n    'controls sidebar'\\n    'terminal sidebar';\\n}\\n\\n.terminal {\\n  grid-area: terminal;\\n}\\n\\n.sidebar {\\n  grid-area: sidebar;\\n  background-color: var(--background-color);\\n  border-left: 1px solid var(--border-color);\\n}\\n\\n.controls {\\n  grid-area: controls;\\n  background-color: var(--background-color);\\n  border-bottom: 1px solid var(--border-color);\\n}\\n\\n.container:not(.show-controls) .sidebar,\\n.container:not(.show-controls) .controls {\\n  display: none;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/ui/index.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,2BAA2B;EAC3B,uBAAuB;EACvB,uBAAuB;EACvB,YAAY;AACd;;AAEA;EACE,YAAY;EACZ,aAAa;EACb,uBAAuB;EACvB,0BAA0B;EAC1B,+BAA+B;AACjC;;AAEA;EACE,6BAA6B;EAC7B,8BAA8B;EAC9B;;sBAEoB;AACtB;;AAEA;EACE,mBAAmB;AACrB;;AAEA;EACE,kBAAkB;EAClB,yCAAyC;EACzC,0CAA0C;AAC5C;;AAEA;EACE,mBAAmB;EACnB,yCAAyC;EACzC,4CAA4C;AAC9C;;AAEA;;EAEE,aAAa;AACf\",\"sourcesContent\":[\"body {\\n  --background-color: #1c1c1c;\\n  --border-color: #484848;\\n  background-color: black;\\n  color: white;\\n}\\n\\n.container {\\n  height: 100%;\\n  display: grid;\\n  grid-template-rows: 1fr;\\n  grid-template-columns: 1fr;\\n  grid-template-areas: 'terminal';\\n}\\n\\n.container.show-controls {\\n  grid-template-rows: 50px auto;\\n  grid-template-columns: 9fr 3fr;\\n  grid-template-areas:\\n    'controls sidebar'\\n    'terminal sidebar';\\n}\\n\\n.terminal {\\n  grid-area: terminal;\\n}\\n\\n.sidebar {\\n  grid-area: sidebar;\\n  background-color: var(--background-color);\\n  border-left: 1px solid var(--border-color);\\n}\\n\\n.controls {\\n  grid-area: controls;\\n  background-color: var(--background-color);\\n  border-bottom: 1px solid var(--border-color);\\n}\\n\\n.container:not(.show-controls) .sidebar,\\n.container:not(.show-controls) .controls {\\n  display: none;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".controls {\\n  display: flex;\\n  align-items: stretch;\\n}\\n\\n.controls .meter {\\n  width: 100px;\\n  margin: 8px;\\n  margin-right: 0;\\n  border: 1px solid var(--border-color);\\n  --color: white;\\n  --value: 100%;\\n}\\n\\n.controls .meter .bar {\\n  height: 100%;\\n  width: var(--value);\\n  background-color: var(--color);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/ui/Controls/Controls.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,aAAa;EACb,oBAAoB;AACtB;;AAEA;EACE,YAAY;EACZ,WAAW;EACX,eAAe;EACf,qCAAqC;EACrC,cAAc;EACd,aAAa;AACf;;AAEA;EACE,YAAY;EACZ,mBAAmB;EACnB,8BAA8B;AAChC\",\"sourcesContent\":[\".controls {\\n  display: flex;\\n  align-items: stretch;\\n}\\n\\n.controls .meter {\\n  width: 100px;\\n  margin: 8px;\\n  margin-right: 0;\\n  border: 1px solid var(--border-color);\\n  --color: white;\\n  --value: 100%;\\n}\\n\\n.controls .meter .bar {\\n  height: 100%;\\n  width: var(--value);\\n  background-color: var(--color);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".hamburger {\\n  display: inline-block;\\n  position: absolute;\\n  top: 24px;\\n  right: 40px;\\n  z-index: 1;\\n  -webkit-user-select: none;\\n  user-select: none;\\n}\\n\\n.hamburger input {\\n  display: block;\\n  width: 40px;\\n  height: 32px;\\n  position: absolute;\\n  top: -7px;\\n  left: -5px;\\n  cursor: pointer;\\n  opacity: 0; /* hide this */\\n  z-index: 2; /* and place it over the hamburger */\\n  -webkit-touch-callout: none;\\n}\\n\\n.hamburger span {\\n  display: block;\\n  width: 33px;\\n  height: 4px;\\n  margin-bottom: 5px;\\n  position: relative;\\n  background: #cdcdcd;\\n  border-radius: 3px;\\n  z-index: 1;\\n  transform-origin: center right;\\n  transition: transform 0.5s cubic-bezier(0.77, 0.2, 0.05, 1),\\n    background 0.5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity 0.55s ease;\\n}\\n\\n/*\\n * Transform all the slices of hamburger\\n * into a crossmark.\\n */\\n.hamburger input:checked ~ span:nth-of-type(2) {\\n  opacity: 0;\\n  transform: rotate(0deg) scale(0.2, 0.2);\\n}\\n\\n.hamburger input:checked ~ span:first-of-type {\\n  transform: rotate(-45deg) translate(0, -4px);\\n}\\n\\n.hamburger input:checked ~ span:last-of-type {\\n  transform: rotate(45deg) translate(0, 4px);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/ui/Hamburger/Hamburger.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,qBAAqB;EACrB,kBAAkB;EAClB,SAAS;EACT,WAAW;EACX,UAAU;EACV,yBAAyB;EACzB,iBAAiB;AACnB;;AAEA;EACE,cAAc;EACd,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,SAAS;EACT,UAAU;EACV,eAAe;EACf,UAAU,EAAE,cAAc;EAC1B,UAAU,EAAE,oCAAoC;EAChD,2BAA2B;AAC7B;;AAEA;EACE,cAAc;EACd,WAAW;EACX,WAAW;EACX,kBAAkB;EAClB,kBAAkB;EAClB,mBAAmB;EACnB,kBAAkB;EAClB,UAAU;EACV,8BAA8B;EAC9B;wEACsE;AACxE;;AAEA;;;EAGE;AACF;EACE,UAAU;EACV,uCAAuC;AACzC;;AAEA;EACE,4CAA4C;AAC9C;;AAEA;EACE,0CAA0C;AAC5C\",\"sourcesContent\":[\".hamburger {\\n  display: inline-block;\\n  position: absolute;\\n  top: 24px;\\n  right: 40px;\\n  z-index: 1;\\n  -webkit-user-select: none;\\n  user-select: none;\\n}\\n\\n.hamburger input {\\n  display: block;\\n  width: 40px;\\n  height: 32px;\\n  position: absolute;\\n  top: -7px;\\n  left: -5px;\\n  cursor: pointer;\\n  opacity: 0; /* hide this */\\n  z-index: 2; /* and place it over the hamburger */\\n  -webkit-touch-callout: none;\\n}\\n\\n.hamburger span {\\n  display: block;\\n  width: 33px;\\n  height: 4px;\\n  margin-bottom: 5px;\\n  position: relative;\\n  background: #cdcdcd;\\n  border-radius: 3px;\\n  z-index: 1;\\n  transform-origin: center right;\\n  transition: transform 0.5s cubic-bezier(0.77, 0.2, 0.05, 1),\\n    background 0.5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity 0.55s ease;\\n}\\n\\n/*\\n * Transform all the slices of hamburger\\n * into a crossmark.\\n */\\n.hamburger input:checked ~ span:nth-of-type(2) {\\n  opacity: 0;\\n  transform: rotate(0deg) scale(0.2, 0.2);\\n}\\n\\n.hamburger input:checked ~ span:first-of-type {\\n  transform: rotate(-45deg) translate(0, -4px);\\n}\\n\\n.hamburger input:checked ~ span:last-of-type {\\n  transform: rotate(45deg) translate(0, 4px);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".sidebar {\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/ui/Sidebar/Sidebar.css\"],\"names\":[],\"mappings\":\"AAAA;AACA\",\"sourcesContent\":[\".sidebar {\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".terminal {\\n  grid-area: terminal;\\n  overflow-x: hidden;\\n  overflow-y: auto;\\n  -ms-overflow-style: none; /* IE and Edge */\\n  scrollbar-width: none; /* Firefox */\\n}\\n\\n.terminal::-webkit-scrollbar {\\n  display: none;\\n}\\n\\n.terminal p {\\n  margin: 1em 0;\\n}\\n\\n.terminal input {\\n  background-color: transparent;\\n  border: none;\\n  color: white;\\n  display: inline-block;\\n  font-family: monospace;\\n  outline: none;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/ui/Terminal/Terminal.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,mBAAmB;EACnB,kBAAkB;EAClB,gBAAgB;EAChB,wBAAwB,EAAE,gBAAgB;EAC1C,qBAAqB,EAAE,YAAY;AACrC;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,6BAA6B;EAC7B,YAAY;EACZ,YAAY;EACZ,qBAAqB;EACrB,sBAAsB;EACtB,aAAa;AACf\",\"sourcesContent\":[\".terminal {\\n  grid-area: terminal;\\n  overflow-x: hidden;\\n  overflow-y: auto;\\n  -ms-overflow-style: none; /* IE and Edge */\\n  scrollbar-width: none; /* Firefox */\\n}\\n\\n.terminal::-webkit-scrollbar {\\n  display: none;\\n}\\n\\n.terminal p {\\n  margin: 1em 0;\\n}\\n\\n.terminal input {\\n  background-color: transparent;\\n  border: none;\\n  color: white;\\n  display: inline-block;\\n  font-family: monospace;\\n  outline: none;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","export function singleExecution<Return>(fn: () => Promise<Return>) {\n  let running: Promise<Return> | null = null;\n\n  return () => {\n    if (running) {\n      return running;\n    }\n\n    running = fn().then(x => {\n      running = null;\n      return x;\n    });\n\n    return running;\n  };\n}\n","import { wait } from '../util/wait';\nimport { PatternMatchSubscription } from './PatternMatchSubscription';\nimport { PatternPromiseTimeoutError } from './PatternPromiseTimeoutError';\nimport { PatternResult } from './PatternResult';\n\nexport class PatternPromise\n  extends Promise<PatternResult>\n  implements PatternMatchSubscription {\n  private forceReject!: (reason?: any) => void;\n\n  constructor(\n    executor: (\n      resolve: (value?: PatternResult | PromiseLike<PatternResult>) => void,\n      reject: (reason?: any) => void,\n    ) => void,\n  ) {\n    let _reject!: (reason?: any) => void;\n\n    super((resolve, reject) => {\n      _reject = reject;\n      executor(resolve, reject);\n    });\n\n    this.forceReject = _reject;\n  }\n\n  timeout(seconds: number) {\n    wait(seconds).then(() =>\n      this.forceReject(new PatternPromiseTimeoutError()),\n    );\n\n    return this as Promise<PatternResult>;\n  }\n\n  wait(seconds: number) {\n    return Promise.race([this, wait(seconds)]);\n  }\n\n  unsubscribe(): void {\n    this.forceReject('aborted');\n  }\n\n  once() {\n    return this;\n  }\n}\n","import { emitter } from '@amatiasq/emitter';\n\nimport { PluginContext } from '../lib/PluginContext';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { int, toInt } from '../lib/util/int';\n\nconst PROMPT = [\n  '&W<',\n  '&R%h/%Hhp ',\n  '&C%m/%Mm ',\n  '&G%v/%Vmv ',\n  '&P%Xxp ',\n  '&Y%gg',\n  '&W> ',\n  '&W%A ',\n  '\\n',\n].join('');\n\nconst FPROMPT = PROMPT.replace('&W>', ' &R%E&W>');\n\nconst captureProgress = (name: string) =>\n  concatRegexes(int(`${name}Curr`), '/', int(`${name}Total`), `${name} `);\n\n// prettier-ignore\nexport const PROMPT_DETECTOR = concatRegexes(\n  /</,\n  captureProgress('hp'),\n  captureProgress('m'),\n  captureProgress('mv'),\n  int('exp'), /xp /,\n  int('gold'), /g/,\n  /( \\((?<enemy>\\d+)%\\))?/,\n  /> (?<invis>I)?/,\n);\n\nclass Stat {\n  total = 0;\n  current = 0;\n\n  get percent() {\n    const result = this.total ? (1 / this.total) * this.current : 0;\n    return Math.round(result * 100) / 100;\n  }\n}\n\nexport async function promptPlugin({ when, write }: PluginContext) {\n  let isInvisible = false;\n\n  const stats = {\n    hp: new Stat(),\n    mana: new Stat(),\n    mv: new Stat(),\n    exp: 0,\n    gold: 0,\n    enemy: null as number | null,\n\n    get isFighting() {\n      return stats.enemy !== null;\n    },\n  };\n\n  type Stats = typeof stats;\n\n  const update = emitter<typeof stats>();\n\n  when(PROMPT_DETECTOR)\n    .timeout(1)\n    .catch(setPrompt)\n    .finally(() => {\n      when(PROMPT_DETECTOR, ({ groups: g }) => {\n        stats.hp.current = toInt(g.hpCurr);\n        stats.hp.total = toInt(g.hpTotal);\n        stats.mana.current = toInt(g.mCurr);\n        stats.mana.total = toInt(g.mTotal);\n        stats.mv.current = toInt(g.mvCurr);\n        stats.mv.total = toInt(g.mvTotal);\n        stats.exp = toInt(g.exp);\n        stats.gold = toInt(g.gold);\n        stats.enemy = g.enemy ? toInt(g.enemy) : null;\n        isInvisible = Boolean(g.invis);\n        update(stats);\n      });\n    });\n\n  return {\n    getPercent,\n    until,\n    whenFresh,\n    onUpdate: update.subscribe,\n\n    get isFighting() {\n      return stats.isFighting;\n    },\n\n    get isInvisible() {\n      return isInvisible;\n    },\n  };\n\n  function whenFresh() {\n    return until(stats => {\n      console.log(\n        stats.hp.percent,\n        stats.mana.percent,\n        stats.mv.percent,\n        stats.hp.percent === 1 &&\n          stats.mana.percent === 1 &&\n          stats.mv.percent === 1,\n      );\n      return (\n        stats.hp.percent === 1 &&\n        stats.mana.percent === 1 &&\n        stats.mv.percent === 1\n      );\n    });\n  }\n\n  function setPrompt() {\n    write(`prompt ${PROMPT}`);\n    write(`fprompt ${FPROMPT}`);\n  }\n\n  function getPercent(stat: 'hp' | 'mana' | 'mv') {\n    return stats[stat].percent;\n  }\n\n  function until(predicate?: (stats: Stats) => boolean) {\n    if (!predicate) {\n      return when(PROMPT_DETECTOR);\n    }\n\n    if (predicate(stats)) {\n      return true;\n    }\n\n    return new Promise(resolve => {\n      const unsubscribe = update.subscribe((stats: Stats) => {\n        if (predicate(stats)) {\n          unsubscribe();\n          resolve(stats);\n        }\n      });\n    });\n  }\n}\n","import { ExecutionAbortedError } from './ExecutionAbortedError';\nimport { Pattern } from './triggers/Pattern';\nimport { PatternMatchSubscription } from './triggers/PatternMatchSubscription';\nimport { PatternOptions } from './triggers/PatternOptions';\nimport { PatternPromise } from './triggers/PatternPromise';\nimport { PatternResult } from './triggers/PatternResult';\nimport { TriggerCollection } from './triggers/TriggerCollection';\nimport { bindAll } from './util/bindAll';\nimport { wait } from './util/wait';\nimport { WriteOptions } from './WriteOptions';\n\nexport class PluginContext {\n  protected readonly subscriptions: PatternMatchSubscription[] = [];\n  protected isPrintingLogs = false;\n  private isAborted = false;\n\n  get printLogs() {\n    this.isPrintingLogs = true;\n    return null;\n  }\n\n  constructor(\n    readonly name: string,\n    readonly username: string,\n    protected readonly triggers: TriggerCollection,\n    protected readonly send: (command: string, options?: WriteOptions) => void,\n  ) {\n    bindAll(this, PluginContext);\n  }\n\n  write(command: string, options?: WriteOptions) {\n    this.checkNotAborted();\n    this.log(`[WRITE]`, command);\n    this.send(command, options);\n  }\n\n  when(pattern: Pattern, options?: PatternOptions): PatternPromise;\n  when(\n    pattern: Pattern,\n    handler: (result: PatternResult) => void,\n    options?: PatternOptions,\n  ): PatternMatchSubscription;\n  when(\n    pattern: Pattern,\n    handler?: ((result: PatternResult) => void) | PatternOptions,\n    options?: PatternOptions,\n  ) {\n    this.checkNotAborted();\n    this.log('[WATCH]', pattern);\n\n    if (typeof handler === 'function') {\n      return this.triggers.add(pattern, handler, options);\n    } else {\n      return this.triggers.add(pattern, handler);\n    }\n  }\n\n  sleep(seconds: number) {\n    this.checkNotAborted();\n    this.log('[SLEEP]', seconds);\n    return wait(seconds);\n  }\n\n  abort() {\n    this.isAborted = true;\n  }\n\n  dispose() {\n    this.log('DISPOSE');\n    this.subscriptions.forEach(x => x.unsubscribe());\n  }\n\n  log(...args: Parameters<Console['log']>) {\n    this.checkNotAborted();\n\n    if (this.isPrintingLogs) {\n      console.log(`[${this.name}]`, ...args);\n    }\n  }\n\n  protected checkNotAborted() {\n    if (this.isAborted) {\n      throw new ExecutionAbortedError();\n    }\n  }\n}\n","export class ExecutionAbortedError extends Error {}\n","export function bindAll<T extends {}>(\n  target: T,\n  source: { new (...args: any[]): T },\n) {\n  const proto = source.prototype;\n  const keys = Object.getOwnPropertyNames(proto) as (keyof T)[];\n\n  keys\n    .filter(key => {\n      const descriptor = Object.getOwnPropertyDescriptor(proto, key)!;\n      return typeof descriptor.value === 'function';\n    })\n    .forEach(method => {\n      target[method] = (target[method] as any).bind(target);\n    });\n}\n","import { concatRegexes } from '../lib/util/concatRegexes';\n\nconst MOB_ARTICLE = /(?:un|una|el|la|los|las|unos|unas)/;\n\nexport type MobName = typeof MOB_SUSTANTIVES[number];\n\nconst ALLIES = ['armadillo'];\n\nconst MOB_SUSTANTIVES = [\n  'adorador',\n  'buitre',\n  'caracol',\n  'ciervo',\n  'conejo',\n  'cultista',\n  'dragon',\n  'empleado',\n  'fanat', // fanatico\n  'goblin',\n  'guardia',\n  'ladron',\n  'lobo',\n  'merodeador',\n  'murcielago',\n  'ogro',\n  'orco',\n  'pantera',\n  'serpiente',\n] as const;\n\nexport function getMobIn(text: string) {\n  const lower = text.toLowerCase();\n\n  if (ALLIES.some(x => lower.includes(x))) {\n    return null;\n  }\n\n  const result = MOB_SUSTANTIVES.find(x => lower.includes(x));\n\n  if (!result) {\n    console.warn(`Unknown sustantive for \"${text}\"`);\n  }\n\n  return result;\n}\n\nexport const MOB_ARRIVES = concatRegexes(\n  MOB_ARTICLE,\n  / (?<mob>(?: \\w+)) llega desde el (?<direction>\\w+)/,\n);\n\nexport const MOB_LEAVES = concatRegexes(\n  MOB_ARTICLE,\n  / (?<mob>(?: \\w+)) (?:se va)|(?:vuela) hacia (?:el )?(?<direction>\\w+)/,\n);\n\nexport const MOB_PRESENT = [\n  'Un buitre carronyero esta aqui.', //: 1,\n  'Un corpulento orco esta aqui de guardia.',\n  'Un deforme humano, un engendro de la magia, quiere descargar su agresividad.',\n  'Un gran lobo negro, te muestra los colmillos hambriento.',\n  'Un lobo feroz esta aqui y grunye muy enojado.',\n  'Un lobo hambriento te esta mirando', //: 1,\n  'Un orco fuera de servicio esta sentado aqui jugando a las cartas.',\n  'Un pequenyo caracol esta aqui haciendo trompos.', //: 1,\n  'Un pequenyo orco se sienta en una de las sillas roncando.',\n  'Un sargento orco mantiene vigilada la chusma a la que comanda.',\n  'Una joven cultista parece bastante serena, mientras no vea a nadie m',\n  'Una serpiente que parece venenosa te mira fijamente.', //: 1,\n  /Kivon, el l.der del culto, no est. nada contento con intromisiones\\./,\n  /Nejane, la l.der, parece estar en trance\\./,\n  /Un adorador mira con c.lera a su alrededor\\./,\n  /Un devoto adorador mira con c.lera a su alrededor\\./,\n  /Un Guardia Real est. aqu. velando por la seguridad del estadio/, //: 14,\n  /Un humano pose.do por el fanatismo busca 'herejes'\\./,\n];\n","import REALMS from './realms';\n\nconst ALL_AREAS = Object.values(REALMS).flat();\n\ntype AreaBase = typeof ALL_AREAS[number];\nexport type AreaName = AreaBase['name'];\n\nexport interface AreaMetadata {\n  path: string;\n  arena?: string | string[];\n}\n\nexport type Area = AreaBase & Partial<AreaMetadata>;\n\nconst METADATA: Partial<Record<AreaName, AreaMetadata>> = {\n  // cadaver: { path: 'ru2sw'},\n  'Academia de Darkhaven': {\n    path: 'rd',\n    arena: ['Xse', 'Xne', 'Xse', 'Xne', 'Xse'],\n  },\n  'Bosque de las Hadas': { path: 'r6w2nwk2wh' },\n  'Catacumbas de la Capilla': { path: 'r6w8se7s' },\n  'Cementerio Oscuro': { path: 'r4s4ws' },\n  'Ciudad Imperial': { path: 'r8e2n4el3e2sj' },\n  DarkHaven: { path: 'r' },\n  'El Campamento Goblin': { path: 'r10s4en3e2n' },\n  'El Cementerio': { path: 'r6w8ses' },\n  'El Centinela': { path: 'r7ws' },\n  'El Gran Estadio': {\n    path: 'r8e2n4el3e2s2jn',\n    arena: 'j',\n  },\n  'El Imperio Orco': {\n    path: 'r13s2wn',\n    arena: [\n      'Xnu',\n      'Xsu',\n      'ne2wene2weXsu',\n      'ne2wenXsnu',\n      '3ne2we2nu',\n      // 's', // hogoblin\n    ],\n  },\n  'El Jardin de los Heroes': { path: 'r8e2n4el3e2s2j8l8e5j4els' },\n  'El Pantano Orco': { path: 'r13s2en' },\n  'El Refugio Destruido': { path: 'r8e2ne' },\n  'Exportaciones de Dragones': { path: 'r4sen' },\n  'Foire de Reves': { path: 'r8n3ene' },\n  'Galeria de arte': { path: 'r4swn' },\n  'Guarderia Enana': { path: 'r8ejs' },\n  'Haon Dor': { path: 'r7w' },\n  'Holy Grove': { path: 'r9e' },\n  'La Fortaleza de Valor': { path: 'r11n2en' },\n  'La Mansion de Marmol': {\n    path: 'r9w3s',\n    arena: [\n      'e2n', // entrada\n      'n2d', // sotano\n      '3n3s',\n      '3e3w', // prisionera\n      // '3w3e', engendro\n      '3s3n',\n      '2us', // salir sotano\n      '2e2w',\n      '4w4e',\n      // '2un', // Kivon & Nejane\n    ],\n  },\n  'La Mansion de Tullfuhrzky': { path: 'r6w2nwk2wh4nj' },\n  'La Torre del Brujo': { path: 'r9w2sese2s' },\n  'Las Alcantarillas': { path: 'r4sd' },\n  'Las Llanuras del Norte': { path: 'r7n' },\n  \"Miden'nir\": { path: 'r7s' },\n};\n\n// export function getAreaName(name: string) {\n//   return Object.keys(ALL_AREAS).find(x => x.includes(name));\n// }\n\nexport function getAreasForLevel(level: number) {\n  return REALMS.Calimhar.filter(x => x.from <= level && x.to >= level)\n    .sort((a, b) => avg(a, level) - avg(b, level))\n    .map(getWithMetadata);\n}\n\nfunction avg(area: AreaBase, level: number) {\n  return Math.abs(level - area.from + (level - area.to));\n}\n\nexport function getAreaMetadata(areaName: string) {\n  const lower = areaName.toLowerCase();\n  const [first, ...candidates] = ALL_AREAS.filter(x =>\n    x.name.toLocaleLowerCase().includes(lower),\n  );\n\n  if (candidates.length) {\n    console.warn(\n      `Many areas detected for ${areaName}:\\n- ${[first, ...candidates]\n        .map(x => x.name)\n        .join('\\n- ')}`,\n    );\n  }\n\n  return first && getWithMetadata(first);\n}\n\nfunction getWithMetadata(area: AreaBase): Area {\n  if (area.name in METADATA) {\n    return { ...area, ...METADATA[area.name] };\n  }\n\n  return area;\n}\n","import { emitter } from '@amatiasq/emitter';\n\nimport { Mud } from './lib/Mud';\nimport { RemoteTelnet } from './lib/RemoteTelnet';\nimport { registerWorkflows } from './registerWorkflows';\nimport { renderUserInterface } from './ui';\nimport { getPassword } from './util/getPassword';\nimport { getQueryParams } from './util/getQueryParams';\nimport { DEFAULT_PORT } from '../../config.json';\n\nlet FORCE_PROD_SERVER = false;\n// FORCE_PROD_SERVER = true;\n\nconst serverUri = getSocketUri();\nconst { host, port, user, pass } = getParams();\nconst { terminal, controls } = renderUserInterface(document.body);\n\nopenSocket();\n\nfunction openSocket() {\n  const socket = new WebSocket(serverUri);\n\n  // socket.addEventListener('close', openSocket);\n  socket.addEventListener('open', () => {\n    const telnet = new RemoteTelnet(socket);\n\n    telnet.connect(host, port);\n    terminal.write(`Connecting to ${host}:${port} as ${user}\\n`);\n\n    initializeMud(telnet);\n  });\n}\n\nasync function initializeMud(telnet: RemoteTelnet) {\n  const mud = new Mud(telnet);\n\n  mud.onCommand(x => terminal.write(`${x}\\n`));\n  telnet.onData(data => terminal.write(data));\n\n  window.onbeforeunload = () => {\n    if (telnet.isConnected) {\n      telnet.send('abandonar');\n    }\n\n    telnet.close();\n  };\n\n  terminal.onSubmit(command => {\n    terminal.write(`${command}\\n`);\n\n    if (command.startsWith('!')) {\n      const [workflow, ...args] = command.substr(1).split(/\\s+/);\n      runWorkflow(workflow, args);\n      return;\n    }\n\n    telnet.send(command);\n    mud.userInput(command);\n  });\n\n  await mud.login(user, pass);\n  registerWorkflows(mud);\n  await connectStats();\n  connectButtons();\n\n  Object.assign(window, { mud });\n\n  async function connectStats() {\n    const hp = emitter<number>();\n    controls.addMeter('red', hp.subscribe);\n\n    const mana = emitter<number>();\n    controls.addMeter('blue', mana.subscribe);\n\n    const mv = emitter<number>();\n    controls.addMeter('green', mv.subscribe);\n\n    mud.getPlugin('prompt').onUpdate(x => {\n      hp(x.hp.percent);\n      mana(x.mana.percent);\n      mv(x.mv.percent);\n    });\n  }\n\n  function connectButtons() {\n    controls.addButton('Entrenar', () => mud.run('train'));\n  }\n\n  function runWorkflow(name: string, args: string[]) {\n    const cmd = `\"${name}\" with \"${args.join(' ')}\"`;\n    terminal.write(`-> Running ${cmd}\\n`);\n\n    mud.run(name, args).then(\n      x => terminal.write(`\\n<- Done ${cmd}: ${x}\\n`),\n      x => terminal.write(`\\n\\n<! FAILED ${cmd}: ${x.message}\\n\\n`),\n    );\n  }\n}\n\nfunction getSocketUri() {\n  return location.origin === 'https://amatiasq.github.io' || FORCE_PROD_SERVER\n    ? 'wss://mudOS.amatiasq.com'\n    : `ws://localhost:${DEFAULT_PORT}`;\n}\n\nfunction getParams() {\n  const { user, server } = getQueryParams();\n  const [host, port] = server.split(':');\n  const pass = getPassword(user);\n  return { host, port: parseInt(port, 10), user, pass };\n}\n","import { emitter } from '@amatiasq/emitter';\n\nimport { initializePlugins, PluginMap } from '../plugins/index';\nimport { login } from '../plugins/login';\nimport { PluginContext } from './PluginContext';\nimport { RemoteTelnet } from './RemoteTelnet';\nimport { TriggerCollection } from './triggers/TriggerCollection';\nimport { Context } from './workflow/Context';\nimport { InvokeOptions } from './workflow/InvokeOptions';\nimport { Workflow } from './workflow/Workflow';\nimport { WorkflowFn } from './workflow/WorkflowFn';\nimport { WorkflowNotFoundError } from './workflow/WorkflowNotFoundError';\nimport { WriteOptions } from './WriteOptions';\n\nexport class Mud {\n  private readonly triggers = new TriggerCollection();\n  private readonly workflows: Record<string, Workflow> = {};\n  private plugins!: PluginMap;\n  private username!: string;\n\n  private readonly emitCommand = emitter<string>();\n  readonly onCommand = this.emitCommand.subscribe;\n\n  private emitLoggedIn!: (usernamne: string) => void;\n  readonly whenLoggedIn = new Promise(resolve => (this.emitLoggedIn = resolve));\n\n  constructor(private readonly telnet: RemoteTelnet) {\n    this.workflow = this.workflow.bind(this);\n    this.send = this.send.bind(this);\n    this.run = this.run.bind(this);\n    this.telnet.onData(x => this.triggers.process(removeNoise(x)));\n  }\n\n  async login(user: string, pass: string) {\n    const context = new PluginContext('login', 'N/A', this.triggers, this.send);\n\n    await login(context, user, pass, async () => {\n      this.plugins = await initializePlugins(\n        name => new PluginContext(name, user, this.triggers, this.send),\n      );\n    });\n\n    context.dispose();\n    this.username = user;\n    this.emitLoggedIn(user);\n  }\n\n  send(text: string, options: WriteOptions = {}) {\n    this.emitCommand(options.password ? '*'.repeat(text.length) : text);\n    this.telnet.send(text);\n  }\n\n  userInput(command: string): void {}\n\n  getPlugin<Name extends keyof PluginMap>(name: Name): PluginMap[Name] {\n    return this.plugins[name];\n  }\n\n  daemon<Args extends any[]>(\n    name: string,\n    run: WorkflowFn<[]>,\n    params?: Args,\n    options?: InvokeOptions,\n  ) {\n    const workflow = new Workflow(name, async (context: Context) => {\n      await run(context);\n      return context.runForever();\n    });\n\n    return this.executeWorkflow(\n      workflow as Workflow<any, any>,\n      params,\n      options,\n    );\n  }\n\n  workflow<Args extends any[]>(name: string, run: WorkflowFn<Args>) {\n    const workflow = new Workflow(name, run);\n    this.workflows[workflow.name] = workflow as Workflow<any, any>;\n    return workflow;\n  }\n\n  async run(name: string, params?: any[], options?: InvokeOptions) {\n    if (!(name in this.workflows)) {\n      throw new WorkflowNotFoundError(`Workflow \"${name}\" is not registered.`);\n    }\n\n    const workflow = this.workflows[name];\n    return this.executeWorkflow(workflow, params, options);\n  }\n\n  private executeWorkflow(\n    workflow: Workflow,\n    params: any[] = [],\n    { logs }: InvokeOptions = {},\n  ) {\n    const context = this.createWorkflowContext(workflow.name);\n\n    if (logs) {\n      context.printLogs;\n    }\n\n    const promise = workflow.execute(context, ...params).then(result => {\n      context.dispose();\n      return result;\n    });\n\n    return Object.assign(promise, {\n      abort() {\n        context.abort();\n      },\n    });\n  }\n\n  private createWorkflowContext(name: string): Context {\n    return new Context(\n      name,\n      this.username,\n      this.triggers,\n      this.plugins,\n      this.send,\n      this.workflow,\n      this.run,\n    );\n  }\n}\n\nfunction removeNoise(text: string) {\n  return removeAsciiCodes(text).replace(/\\r/g, '');\n}\n\nfunction removeAsciiCodes(text: string) {\n  return text.replace(/\\u001b\\[.*?m/g, '');\n}\n","import { PluginContext } from '../lib/PluginContext';\nimport { chatPlugin } from './chatPlugin';\nimport { inventoryPlugin } from './inventoryPlugin';\nimport { navigationPlugin } from './navigationPlugin';\nimport { promptPlugin } from './promptPlugin';\nimport { skillsPlugin } from './skillsPlugin';\nimport { statsPlugin } from './statsPlugin';\n\nconst plugins = {\n  chat: chatPlugin,\n  inventory: inventoryPlugin,\n  navigation: navigationPlugin,\n  prompt: promptPlugin,\n  skills: skillsPlugin,\n  stats: statsPlugin,\n};\n\n// -- Dirty implementation\n\ntype plugins = typeof plugins;\ntype UnPromisify<T> = T extends Promise<infer U> ? U : T;\n\nexport type PluginMap = {\n  [name in keyof plugins]: UnPromisify<ReturnType<plugins[name]>>;\n};\n\nexport async function initializePlugins(\n  context: (name: string) => PluginContext,\n) {\n  const promises = Object.entries(plugins).map(async ([name, plugin]) => [\n    name,\n    await plugin(context(name)),\n  ]);\n\n  const entries = await Promise.all(promises);\n  return Object.fromEntries(entries) as PluginMap;\n}\n","import { ClientStorage } from '@amatiasq/client-storage';\n\nimport { PluginContext } from '../lib/PluginContext';\nimport { PatternResult } from '../lib/triggers/PatternResult';\nimport { datetime, DateTime } from '../lib/util/dateTime';\nimport { requestNotificationPermission } from '../lib/util/requestNotificationPermission';\n\ntype Message = [DateTime, string, string, string];\ntype History = ClientStorage<Message[]>;\n\nconst version = { version: 2 };\n\nconst receive = (log: History) => ({\n  groups: { name, message },\n}: PatternResult) => {\n  console.log(`[MESSAGE(${name})]:`, message);\n  addMessage(log, { from: name, message });\n  notify(name, message);\n};\n\nconst sent = (log: History) => ({ groups: { name, message } }: PatternResult) =>\n  addMessage(log, { to: name, message });\n\nexport function chatPlugin({ when }: PluginContext) {\n  // const say = new ClientStorage<Record<string, Message[]>>('chat:say');\n  const order = new ClientStorage<Message[]>('chat:order', version);\n  const tell = new ClientStorage<Message[]>('chat:tell', version);\n  const whisper = new ClientStorage<Message[]>('chat:whisper', version);\n\n  (window as any).chat = () => ({\n    tell: tell.get(),\n    order: order.get(),\n    whisper: whisper.get(),\n  });\n\n  when(/(?<name>\\[Orden: [^\\]]+\\]): '(?<message>[^']+)'/, receive(order));\n  when(/(?<name>\\[Orden\\]): '(?<message>[^']+)'/, sent(order));\n\n  when(/(?<name>.+) te susurra '(?<message>[^']+)'/, receive(whisper));\n  when(/Susurras a (?<name>.+) '(?<message>[^']+)'/, sent(whisper));\n\n  when(\n    [\n      /(?<name>.+) te cuenta '(?<message>[^']+)'/,\n      /(?<name>.+) te responde '(?<message>[^']+)'/,\n    ],\n    receive(tell),\n  );\n\n  when(\n    [\n      /Cuentas a (?<name>.+) '(?<message>[^']+)'/,\n      /Respondes a (?<name>.+) '(?<message>[^']+)'/,\n    ],\n    sent(tell),\n  );\n}\n\ntype msg = { message: string };\n\nasync function notify(from: string, message: string) {\n  await requestNotificationPermission();\n\n  if (!from.startsWith('[Orden')) {\n    return new Notification(`${from}=>${message}`);\n  }\n}\n\nfunction addMessage(log: History, partial: { from: string } & msg): Message;\nfunction addMessage(log: History, partial: { to: string } & msg): Message;\nfunction addMessage(\n  log: History,\n  partial: { from?: string; to?: string } & msg,\n): Message {\n  const message: Message = [\n    datetime(new Date()),\n    partial.from || 'me',\n    partial.to || 'me',\n    partial.message,\n  ];\n\n  log.set([...(log.get() || []), message]);\n  return message;\n}\n","const pad = (val: number) => (val < 10 ? `0${val}` : val);\n\nexport type DateTime = '[string DateTime]';\n\nexport function datetime(date: Date) {\n  const yyyy = date.getFullYear();\n  const MM = pad(date.getMonth() + 1);\n  const dd = pad(date.getDate());\n  const hh = pad(date.getHours());\n  const mm = pad(date.getMinutes());\n\n  return `${yyyy}-${MM}-${dd} ${hh}:${mm}` as DateTime;\n}\n","export function requestNotificationPermission() {\n  if (!('Notification' in window)) {\n    console.warn('This browser does not support desktop notification');\n    return;\n  }\n\n  if (Notification.permission === 'granted') {\n    return Promise.resolve(true);\n  }\n\n  if (Notification.permission === 'denied') {\n    return;\n  }\n\n  return Notification.requestPermission().then(x => x === 'granted');\n}\n","import { PluginContext } from '../lib/PluginContext';\nimport { singleExecution } from '../lib/util/singleExecution';\n\nconst INVENTORY_DETECTOR = /Estas llevando:(\\n.*)+?\\n\\n/;\n\nexport function inventoryPlugin({ when, write }: PluginContext) {\n  let isInitialized = false;\n  let items: Record<string, number> = {};\n\n  const refresh = singleExecution(async () => {\n    write('inventario');\n    await when(INVENTORY_DETECTOR);\n  });\n\n  when('No tienes ese objeto.', refresh);\n\n  when(\n    INVENTORY_DETECTOR,\n    ({ captured }) => {\n      const [_, ...inventory] = captured[0]\n        .split('\\n')\n        .map(x => x.trim())\n        .filter(Boolean);\n\n      isInitialized = true;\n      items = {};\n\n      for (const item of inventory) {\n        if (item === 'Nada.') {\n          return;\n        }\n\n        const match = item.match(/(.*) \\((\\d+)\\)$/);\n\n        if (match) {\n          items[match[1]] = parseInt(match[2], 10);\n        } else {\n          items[item] = 1;\n        }\n      }\n    },\n    { captureLength: 1000 },\n  );\n\n  return { refresh, has };\n\n  async function has(search: string | string[] | Record<string, string>) {\n    if (!isInitialized) {\n      await refresh();\n    }\n\n    if (typeof search === 'string') {\n      return hasSync(search) ? search : null;\n    }\n\n    if (Array.isArray(search)) {\n      return search.find(hasSync) || null;\n    }\n\n    const key = Object.keys(search).find(hasSync);\n    return key ? search[key] : null;\n  }\n\n  function hasSync(key: string) {\n    return items[key];\n  }\n}\n","import { emitter } from '@amatiasq/emitter';\n\nimport { PluginContext } from '../lib/PluginContext';\nimport { PatternPromise } from '../lib/triggers/PatternPromise';\nimport { PROMPT_DETECTOR } from './promptPlugin';\n\nconst CLOSED = '(cerrada)';\nconst aliases = {\n  s: 'sur',\n  n: 'norte',\n  e: 'este',\n  w: 'oeste',\n  o: 'oeste',\n  u: 'arriba',\n  d: 'abajo',\n  l: 'sureste',\n  k: 'suroeste',\n  j: 'noreste',\n  h: 'noroeste',\n};\n\nexport function navigationPlugin({ log, when, write }: PluginContext) {\n  let isNavigating = false;\n  let landingAtRecall = false;\n  let isAtRecall = false;\n  let directions: string[] = [];\n\n  const prompt = () => when(PROMPT_DETECTOR);\n  const roomChanged = emitter<string[]>();\n\n  when(/Plaza de Darkhaven\\s+/, () => (landingAtRecall = true));\n\n  when('Puertas? esta cerrada.', async () => {\n    const closed = directions.find(x => x.includes(CLOSED));\n\n    if (closed) {\n      const dir = closed.replace(CLOSED, '');\n      write(`abrir ${dir}`);\n\n      const result = await Promise.any([\n        when('Esta cerrada con llave.').then(() => false),\n        when('Abres ').then(() => true),\n      ]);\n\n      if (result) {\n        write(dir);\n      }\n    }\n  });\n\n  when(/\\nSalidas: ([^\\.]+)/, async ({ captured }) => {\n    directions = captured[1].split(' ');\n    isNavigating = false;\n    isAtRecall = landingAtRecall;\n    landingAtRecall = false;\n    await prompt();\n    roomChanged(directions);\n  });\n\n  return {\n    canGo,\n    go,\n    execute,\n    recall,\n    waitForRecall,\n    onRoomChange: roomChanged.subscribe,\n\n    get isNavigating() {\n      return isNavigating;\n    },\n\n    get isAtRecall() {\n      return isAtRecall;\n    },\n  };\n\n  async function recall() {\n    if (isAtRecall) {\n      return true;\n    }\n\n    write('recall');\n    await when('Plaza de Darkhaven');\n    await prompt();\n  }\n\n  function waitForRecall() {\n    if (isAtRecall) {\n      return new PatternPromise(resolve => resolve());\n    }\n\n    return when('Plaza de Darkhaven');\n  }\n\n  function canGo(direction: string) {\n    return Boolean(get(direction));\n  }\n\n  function isClosed(direction: string) {\n    const dir = get(direction);\n    return dir && dir.includes(CLOSED);\n  }\n\n  async function execute(pattern: string, callback?: () => Promise<any>) {\n    if (pattern[0] === 'r') {\n      await recall();\n      pattern = pattern.substr(1);\n    }\n\n    let untilEnd = false;\n\n    for (const step of parsePath(pattern)) {\n      if (step.toUpperCase() === 'X') {\n        untilEnd = true;\n        continue;\n      }\n\n      if (untilEnd) {\n        while (canGo(step)) {\n          if (await move(step)) {\n            return false;\n          }\n        }\n\n        untilEnd = false;\n      } else {\n        if (await move(step)) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n\n    async function move(step: string) {\n      try {\n        if (!(await go(step))) {\n          return true;\n        }\n      } catch (error) {\n        throw new Error(`${error.message} - on ${pattern}`);\n      }\n\n      if (typeof callback === 'function') {\n        const result = await callback();\n        return result === false;\n      }\n    }\n  }\n\n  async function go(direction: string) {\n    if (isNavigating) {\n      throw new Error('WTF DUDE');\n    }\n\n    const dir = get(direction);\n\n    if (!dir) {\n      throw new Error(`Unknown direction '${direction}'`);\n    }\n\n    if (isClosed(direction)) {\n      write(`abrir ${direction}`);\n\n      const success = await Promise.any([\n        when(/Abres la puertas?\\./).then(() => true),\n        when('Esta cerrada con llave.').then(() => false),\n      ]);\n\n      if (!success) {\n        log('Can\\t open door');\n        return false;\n      }\n    }\n\n    write(dir.replace(CLOSED, '').trim());\n    isNavigating = true;\n\n    await when('\\nSalidas:');\n    await prompt();\n\n    isNavigating = false;\n    return true;\n  }\n\n  function get(direction: string) {\n    if (direction in aliases) {\n      direction = aliases[direction as keyof typeof aliases];\n    }\n\n    return directions.find(x => x.startsWith(direction));\n  }\n}\n\nfunction parsePath(path: string) {\n  return path.replace(/(\\d+)(\\w)/g, (_, times, dir) => dir.repeat(times));\n}\n","export class PatternPromiseTimeoutError extends Error {}\n","import { SpellDescription } from './../data/spells';\nimport {\n  getSpell,\n  SPELL_ALREADY_APPLIED,\n  SPELL_FAILED,\n  SPELL_NOT_POSSIBLE,\n} from '../data/spells';\nimport { PluginContext } from '../lib/PluginContext';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { singleExecution } from '../lib/util/singleExecution';\n\n// Skill cast results\n// const TIMEOUT = 0;\nconst NOT_AVAILABLE = undefined;\nconst BUSY = null;\nconst FAILED = false;\nconst CASTED = true;\nconst ALREADY_APPLIED = 1;\n\nexport type CastSpellResult =\n  | typeof NOT_AVAILABLE\n  | typeof BUSY\n  | typeof FAILED\n  | typeof CASTED\n  | typeof ALREADY_APPLIED;\n\nconst SKILL = /((?:\\w+ )+)\\s+(\\d+)%/g;\nconst SKILLS_DETECTOR = concatRegexes(\n  /-+\\[(\\w+)\\]-+\\n/,\n  /(.|\\n)+/,\n  /Te quedan \\d+ practicas.\\n/,\n  /Tienes \\d+ entrenamientos.\\n/,\n);\n\nexport function skillsPlugin({ when, write }: PluginContext) {\n  let isInitialized = false;\n  let isSpellRunning = false;\n  let skills: Record<string, number> = {};\n\n  const refresh = singleExecution(() => {\n    write('practicar');\n    return when(SKILLS_DETECTOR);\n  });\n\n  when(\n    SKILLS_DETECTOR,\n    ({ captured: [content] }) => {\n      isInitialized = true;\n\n      for (const skill of content.matchAll(SKILL)!) {\n        skills[skill[1].trim()] = parseInt(skill[2], 10);\n      }\n\n      isInitialized = true;\n\n      console.log(skills);\n    },\n    { captureLength: 5000 },\n  );\n\n  return {\n    has,\n    canLearn,\n    castSpell,\n    NOT_AVAILABLE,\n    BUSY,\n    FAILED,\n    CASTED,\n    ALREADY_APPLIED,\n  };\n\n  async function has(search: string | string[]) {\n    await ensureInitiated();\n\n    if (typeof search === 'string') {\n      return hasSync(search) ? search : null;\n    } else {\n      return search.find(hasSync) || null;\n    }\n  }\n\n  function hasSync(name: string) {\n    return skills[name];\n  }\n\n  async function canLearn(name: string) {\n    await ensureInitiated();\n    return name in skills;\n  }\n\n  function ensureInitiated() {\n    if (!isInitialized) {\n      return refresh();\n    }\n  }\n\n  async function castSpell(name: string | string[], args = '') {\n    const aliases = Array.isArray(name) ? name : [name];\n    const candidates = aliases\n      .map(getSpell)\n      .filter(Boolean) as SpellDescription[];\n    const learnt = await has(candidates.map(x => x.name));\n\n    if (!learnt) {\n      return NOT_AVAILABLE;\n    }\n\n    const spell = candidates.find(x => x.name === learnt)!;\n\n    if (!spell.success) {\n      throw new Error(`Unknown response for spell \"${name}\" (${spell.name}).`);\n    }\n\n    if (isSpellRunning) {\n      return BUSY;\n    }\n\n    isSpellRunning = true;\n    write(`conjurar \"${spell.name}\" ${args}`);\n\n    const promises: Promise<CastSpellResult>[] = [\n      when(spell.success).then(() => CASTED),\n      when(SPELL_NOT_POSSIBLE).then(() => NOT_AVAILABLE),\n      when(SPELL_ALREADY_APPLIED).then(() => ALREADY_APPLIED),\n      when(SPELL_FAILED)\n        .wait(4)\n        .then(() => FAILED),\n    ];\n\n    if (spell.target) {\n      promises.push(when(spell.target).then(() => CASTED));\n    }\n\n    const result: CastSpellResult = await Promise.any(promises);\n\n    isSpellRunning = false;\n    return result;\n  }\n}\n","import { PluginContext } from '../lib/PluginContext';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { int, toInt } from '../lib/util/int';\n\nconst SIZE = 3000;\n\nconst STATE_DETECTOR = (() => {\n  type Args = Parameters<typeof concatRegexes>;\n  const r = concatRegexes;\n  const low = (x: string) => x.toLowerCase();\n\n  const ANY = /(?:.|\\n)+?/;\n  const DASH = /\\-{78}/;\n  const SPACE = /\\s+/;\n  const PIPE = /\\s+\\|\\s+/;\n  const SPACER = /\\|\\|-{36}\\+-{41}\\|\\|\\n/;\n\n  const row = (...content: Args) => r(/\\|\\|\\s*/, ...content, /\\s*\\|\\|\\n/);\n  const stat = (key: string) =>\n    r(key, /\\s+: /, int(low(key)), /\\(/, int(`${low(key)}Base`), /\\)/);\n\n  const percent = (key: string) =>\n    r(\n      key,\n      /\\s+: /,\n      int(low(key)),\n      /\\s+\\//,\n      int(`${low(key)}Base`),\n      /\\s+\\(\\s*/,\n      int(`${low(key)}Regen`),\n      /%\\) (?:Regen)?/,\n    );\n\n  return r(\n    DASH,\n    /\\n\\/\\s{78}\\\\\\n/,\n    row(/Ficha de (?<name>\\w+)(?<principal> \\(Personaje Principal\\))\\./),\n    row(DASH),\n    row(stat('FUE'), SPACE, stat('DES'), PIPE, percent('Vida')),\n    row(stat('INT'), SPACE, stat('SAB'), PIPE, percent('Mana')),\n    row(stat('CON'), SPACE, stat('CAR'), PIPE, percent('Mov')),\n    row(stat('SUE'), SPACE, PIPE, SPACE),\n    SPACER,\n    row(/Nivel\\s+: /, int('level'), ANY),\n    ANY,\n    / \\|\\|\\n\\\\\\s{78}\\/\\n  /,\n    DASH,\n  );\n\n  /*\n    ------------------------------------------------------------------------------\n  /                                                                              \\\n  ||  Ficha de May (Personaje Principal).                                         ||\n  ||------------------------------------------------------------------------------||\n  || FUE      : 17(16)   DES   : 17(15) | Vida      : 362  /362   ( 0%) Regen     ||\n  || INT      : 20(18)   SAB   : 17(16) | Mana      : 359  /359   ( 0%)           ||\n  || CON      : 15(15)   CAR   : 15(15) | Mov       : 250  /250   ( 0%)           ||\n  || SUE      : 14(14)                  |                                         ||\n  ||------------------------------------+-----------------------------------------||\n  || Nivel    : 15      Edad   : 68     | Profesion : Druida   Raza: Medio-Elfo   ||\n  || Hitroll  : 19      Damroll: 18     | Objetos   : 1    /8                     ||\n  || Armadura : -13     Alin   : 40     | Peso      : 36   /220                   ||\n  || Impacto  : 22 %    Da�o   : 11     | Posicion  : de pie                      ||\n  || Esquivar : 12 %    Parada : 12 %   | Estilo    : estandar                    ||\n  || Huida    : 0       Horas  : 102    | Mision    : 0 /15   Quest: 0    (0 /50) ||\n  ||------------------------------------+-----------------------------------------||\n  || FISIC Da�o/Res/Crit:   0%/  0%/ 3% |            Salvaciones                  ||\n  || MAGIA Da�o/Res/Crit:   0%/  0%/ 3% | Veneno       : 5        Fuego    : -3   ||\n  || CURAS Dar / Recibir:   0%/  0%     | Acido/Paral  : 0        Frio     : 0    ||\n  || EXP : 4,202,269     Pract : 12     | Energia/Elec : 0                        ||\n  || ORO : 63,593        Entr  : 26     |                                         ||\n  || Deidad   : Mittarna                | Favor        : amado        (2500 )     ||\n  ||------------------------------------------------------------------------------||\n  || Te sientes muy bien.                                                         ||\n  ||------------------------------------------------------------------------------||\n  ||                        -= Datos de Guerras =-                                ||\n  || Rango           : Plebeya                     Gloria         : 0    /0       ||\n  || Asesinatos      : 0                           Muertes        : 0             ||\n  ||------------------------------------------------------------------------------||\n  || Conclave:                                                                    ||\n  ||  Avatar Matados : 336                         Otros Matados  : 136           ||\n  ||  Avatar Muertos : 557                         Otros Muertos  : 366           ||\n  \\                                                                              /\n    ------------------------------------------------------------------------------\n  */\n})();\n\nexport function statsPlugin({ when, write }: PluginContext) {\n  let isInitiated = false;\n  const stats = {\n    name: 0,\n    principal: 0,\n    fue: 0,\n    fueBase: 0,\n    des: 0,\n    desBase: 0,\n    vida: 0,\n    vidaBase: 0,\n    vidaRegen: 0,\n    int: 0,\n    intBase: 0,\n    sab: 0,\n    sabBase: 0,\n    mana: 0,\n    manaBase: 0,\n    manaRegen: 0,\n    con: 0,\n    conBase: 0,\n    car: 0,\n    carBase: 0,\n    mov: 0,\n    movBase: 0,\n    movRegen: 0,\n    sue: 0,\n    sueBase: 0,\n    level: 0,\n  };\n\n  when(\n    STATE_DETECTOR,\n    ({ groups }) => {\n      for (const key of Object.keys(stats) as (keyof typeof stats)[]) {\n        stats[key] = toInt(groups[key]);\n      }\n\n      console.log(stats);\n      isInitiated = true;\n    },\n    { captureLength: SIZE },\n  );\n\n  return {\n    async getLevel() {\n      await ensureInitiated();\n      return stats.level;\n    },\n  };\n\n  async function ensureInitiated() {\n    if (!isInitiated) {\n      write('estado');\n      await when(STATE_DETECTOR, { captureLength: SIZE });\n    }\n  }\n}\n","import { PluginContext } from '../lib/PluginContext';\n\nexport async function login(\n  { when, write, log }: PluginContext,\n  username: string,\n  password: string,\n  initialize: () => Promise<any>,\n) {\n  await when('Entra el nombre de tu personaje o escribe Nuevo:');\n  write(username);\n  log('Username sent, waiting for password request');\n\n  await when('Password:');\n  write(password, { password: true });\n  log(`Logged in as ${username}`);\n\n  await Promise.any([\n    (async () => {\n      await when('Reconectando.');\n      await initialize();\n    })(),\n    (async () => {\n      await when('Pulsa [ENTER]');\n      write('');\n      await when('Pulsa [ENTER]');\n      write('');\n      await when('Bienvenido a Balzhur...', initialize, { await: true }).once();\n    })(),\n  ]);\n}\n","import { Pattern } from './Pattern';\nimport { PatternMatcher } from './PatternMatcher';\nimport { PatternMatchSubscription } from './PatternMatchSubscription';\nimport { PatternOptions } from './PatternOptions';\nimport { PatternPromise } from './PatternPromise';\nimport { PatternResult } from './PatternResult';\n\ntype Handler = (result: PatternResult) => void;\n\nexport class TriggerCollection {\n  private readonly patterns = new Set<PatternMatcher>();\n  private readonly queue: string[] = [];\n  private isProcessing = false;\n\n  add(pattern: Pattern, options?: PatternOptions): PatternPromise;\n  add(\n    pattern: Pattern,\n    handler: (result: PatternResult) => void,\n    options?: PatternOptions,\n  ): PatternMatchSubscription;\n  add(\n    pattern: Pattern,\n    handler?: Handler | PatternOptions,\n    options?: PatternOptions,\n  ): any {\n    if (arguments.length === 1) return this.once(pattern);\n\n    if (arguments.length === 3)\n      return this.watch(pattern, handler as Handler, options);\n\n    if (typeof handler === 'function')\n      return this.watch(pattern, handler as Handler);\n\n    return this.once(pattern, handler as PatternOptions);\n  }\n\n  private watch(pattern: Pattern, handler: Handler, options?: PatternOptions) {\n    const entry = new PatternMatcher(pattern, x => handler(x), options);\n\n    this.patterns.add(entry);\n\n    const unsubscribe = () => this.patterns.delete(entry);\n\n    const once = () =>\n      new PatternPromise(resolve => {\n        const original = handler;\n\n        handler = async x => {\n          unsubscribe();\n\n          if (original) {\n            if (options && options.await) {\n              await original(x);\n            } else {\n              original(x);\n            }\n          }\n\n          resolve(x);\n        };\n      });\n\n    return { unsubscribe, once } as PatternMatchSubscription;\n  }\n\n  private once(pattern: Pattern, options?: PatternOptions) {\n    return new PatternPromise(resolve => {\n      const sub = this.add(pattern, handler, options);\n\n      function handler(result: PatternResult) {\n        sub.unsubscribe();\n        resolve(result);\n      }\n    });\n  }\n\n  async process(text: string): Promise<void> {\n    if (this.isProcessing) {\n      this.queue.push(text);\n      return;\n    }\n\n    this.isProcessing = true;\n\n    const splitted = text.split('\\n');\n    const last = splitted.pop() as string;\n    const lines = [...splitted.map(x => `${x}\\n`), last];\n\n    for (const line of lines) {\n      // console.log('PROCESS', line);\n      for (const pattern of this.patterns) {\n        await pattern.process(line);\n      }\n    }\n\n    this.isProcessing = false;\n\n    if (this.queue.length) {\n      return this.process(this.queue.pop()!);\n    }\n  }\n}\n","import { trimEnd } from '../util/trimEnd';\nimport { Pattern, SinglePattern } from './Pattern';\nimport { PatternOptions } from './PatternOptions';\nimport { PatternResult } from './PatternResult';\n\nexport class PatternMatcher {\n  private readonly patterns: SinglePattern[];\n  private readonly buffer;\n  readonly length;\n\n  constructor(\n    pattern: Pattern,\n    private readonly handler: (result: PatternResult) => void,\n    private readonly options: PatternOptions = {},\n  ) {\n    this.patterns = Array.isArray(pattern) ? pattern : [pattern];\n    this.length =\n      options.captureLength ||\n      Math.max(...this.patterns.map(x => String(x).length)) * 10;\n\n    this.buffer = buffer(this.length);\n  }\n\n  process(text: string) {\n    const value = this.buffer(text);\n    const matching = this.patterns.filter(pattern =>\n      this.testPattern(value, pattern),\n    );\n\n    if (!matching.length) {\n      return;\n    }\n\n    this.buffer.clear();\n    const result = new PatternResult(matching, value);\n    const output = this.handler(result);\n    return this.options.await ? output : null;\n  }\n\n  private testPattern(text: string, pattern: SinglePattern) {\n    if (typeof pattern === 'string') {\n      return text.indexOf(pattern) > -1;\n    }\n\n    return pattern.test(text);\n  }\n}\n\nfunction buffer(length: number) {\n  let value = '';\n  const clear = () => (value = '');\n  const add = (text: string) => (value = trimEnd(`${value}${text}`, length));\n  return Object.assign(add, { clear });\n}\n","export function trimEnd(value: string, maxLength: number) {\n  return value.length > maxLength\n    ? value.substr(value.length - maxLength)\n    : value;\n}\n","import { SinglePattern } from './Pattern';\n\nexport class PatternResult {\n  private get regexes() {\n    return this.patterns.filter(isRegex);\n  }\n\n  private get stringPatterns() {\n    return this.patterns.filter(x => !isRegex(x)) as string[];\n  }\n\n  get fullMatch() {\n    return this.stringPatterns[0];\n  }\n\n  get captured() {\n    const regexMatches = this.regexes\n      .map(x => this.haystack.match(x)!)\n      .filter(Boolean)\n      .map(x => Array.from(x));\n\n    // TODO: maybe return the one with more captures?\n    return regexMatches[0];\n  }\n\n  get groups(): Record<string, string> {\n    return this.regexes\n      .map(x => this.haystack.match(x)!)\n      .filter(Boolean)\n      .map(x => x.groups!)\n      .filter(Boolean)\n      .reduce(merge, {});\n  }\n\n  constructor(\n    readonly patterns: SinglePattern[],\n    private readonly haystack: string,\n  ) {}\n}\n\nfunction isRegex(value: SinglePattern) {\n  return value instanceof RegExp;\n}\n\nfunction merge(a: object, b: object) {\n  return { ...a, ...b };\n}\n","import { WorkflowFn } from './WorkflowFn';\nimport { PluginMap } from '../../plugins/index';\nimport { ExecutionAbortedError } from '../ExecutionAbortedError';\nimport { Mud } from '../Mud';\nimport { PluginContext } from '../PluginContext';\nimport { TriggerCollection } from '../triggers/TriggerCollection';\nimport { bindAll } from '../util/bindAll';\nimport { WriteOptions } from '../WriteOptions';\nimport { MissingPluginError } from './MissingPluginError';\n\nexport class Context extends PluginContext {\n  private finish: ((reason: any) => void) | null = null;\n\n  readonly plugins: PluginMap;\n\n  constructor(\n    name: string,\n    username: string,\n    triggers: TriggerCollection,\n    plugins: PluginMap,\n    send: (command: string, options?: WriteOptions) => void,\n    readonly register: <Args extends any[]>(\n      name: string,\n      action: WorkflowFn<Args>,\n    ) => void,\n    private readonly runWorkflow: Mud['run'],\n  ) {\n    super(`W(${name})`, username, triggers, send);\n    this.plugins = createPluginsGetter(plugins, this.log.bind(this));\n\n    bindAll(this, Context);\n  }\n\n  async run(name: string, params: any[] = []) {\n    this.checkNotAborted();\n    this.log(`Invoke workflow \"${name}\" with`, ...params);\n\n    try {\n      const result = await this.runWorkflow(name, params, {\n        logs: this.isPrintingLogs,\n      });\n      this.log(`Invocation \"${name}\" returned `, result);\n      return result;\n    } catch (error) {\n      this.log(`Invocation \"${name}\" failed `, error);\n    }\n  }\n\n  runForever() {\n    return new Promise(resolve => (this.finish = resolve));\n  }\n\n  abort() {\n    super.abort();\n\n    if (this.finish) {\n      this.finish(new ExecutionAbortedError());\n    }\n  }\n}\n\nfunction createPluginsGetter(source: PluginMap, log: Function) {\n  return new Proxy(source, {\n    get(target, key: string) {\n      if (!(key in target)) {\n        log(`Failed to get plugin ${key}`);\n        throw new MissingPluginError(`Plugin ${key} is not registered.`);\n      }\n\n      log(`Requires plugin ${key}`);\n      return target[key as keyof typeof target];\n    },\n  });\n}\n","export class MissingPluginError extends Error {}\n","import { Context } from './Context';\n\nexport class Workflow<Args extends any[] = any[], Return = any> {\n  private executionCount = 0;\n  private currentExecutions = 0;\n\n  get isRunning() {\n    return this.currentExecutions > 0;\n  }\n\n  get timesExecuted() {\n    return this.executionCount;\n  }\n\n  constructor(\n    readonly name: string,\n    private readonly run: (\n      context: Context,\n      ...args: Args\n    ) => Promise<Return> | void,\n  ) {}\n\n  async execute(context: Context, ...args: Args) {\n    this.currentExecutions++;\n    const iteration = this.executionCount++;\n\n    context.log(`[Exe(${iteration})]`, ...args);\n\n    try {\n      const result = await this.run(context, ...args);\n      context.log(`[Res(${iteration}]`, result);\n      return result;\n    } catch (error) {\n      context.log(`[ERR(${iteration})]`, error);\n      throw error;\n    } finally {\n      this.currentExecutions--;\n    }\n  }\n}\n","export class WorkflowNotFoundError extends Error {}\n","import { emitter } from '@amatiasq/emitter';\n\nexport class RemoteTelnet {\n  private _isConnected = false;\n\n  get isConnected() {\n    return this._isConnected;\n  }\n\n  private readonly emitClose = emitter();\n  readonly onClose = this.emitClose.subscribe;\n\n  private readonly emitData = emitter<string>();\n  readonly onData = this.emitData.subscribe;\n\n  constructor(private readonly socket: WebSocket) {\n    socket.addEventListener('close', this.emitClose);\n    socket.addEventListener('message', this.onMessage.bind(this));\n\n    this.onData(() => (this._isConnected = true));\n    this.onClose(() => (this._isConnected = false));\n  }\n\n  connect(host: string, port: number) {\n    this.proxy('OPEN', { host, port });\n  }\n\n  send(value: string) {\n    this.proxy('INPUT', value);\n  }\n\n  close() {\n    this.socket.close();\n  }\n\n  private proxy(type: string, payload: any) {\n    this.socket.send(JSON.stringify({ type, payload }));\n  }\n\n  private async onMessage(event: MessageEvent<Blob>) {\n    const escaped = await event.data.text();\n    const text = escaped\n      // .replace(/z<Ex>/g, '')\n      // .replace(/\\[1z<\\/Ex>/g, '')\n      .replace(/&lt;/g, '<')\n      .replace(/&gt;/g, '>')\n      .replace(/&amp;/g, '&');\n\n    this.emitData(text);\n  }\n}\n","import { defend } from './daemons/defend';\nimport { dope } from './daemons/dope';\nimport { drink } from './daemons/drink';\nimport { eat } from './daemons/eat';\nimport { idle } from './daemons/idle';\nimport { repair } from './daemons/repair';\nimport { rest } from './daemons/rest';\nimport { Mud } from './lib/Mud';\nimport { afk } from './workflows/afk';\nimport { bank } from './workflows/bank';\nimport { cast } from './workflows/cast';\nimport { donations } from './workflows/donations';\nimport { go } from './workflows/go';\nimport { kill } from './workflows/kill';\nimport { train } from './workflows/train';\nimport { wear } from './workflows/wear';\n\nexport function registerWorkflows(mud: Mud) {\n  mud.workflow('afk', afk);\n  mud.workflow('bank', bank);\n  mud.workflow('cast', cast);\n  mud.workflow('donations', donations);\n  mud.workflow('kill', kill);\n  mud.workflow('go', go);\n  mud.workflow('train', train);\n  mud.workflow('wear', wear);\n\n  mud.daemon('defend', defend);\n  mud.daemon('dope', dope);\n  mud.daemon('drink', drink);\n  mud.daemon('eat', eat);\n  mud.daemon('idle', idle);\n  mud.daemon('repair', repair);\n  mud.daemon('rest', rest);\n}\n","import { getMobIn } from '../data/mobs';\nimport { SPELLS_BY_TYPE } from '../data/spells';\nimport { Context } from '../lib/workflow/Context';\n\nexport async function defend({\n  log,\n  when,\n  write,\n  plugins: { prompt, skills, navigation },\n}: Context) {\n  when('Estas demasiado exhausto para huir del combate!', () =>\n    navigation.recall(),\n  );\n\n  when(/El \\w+ de (?:el|la|un|una) ((?: |\\w)+) te /, async ({ captured }) => {\n    const hp = prompt.getPercent('hp');\n\n    if (hp < 0.1) {\n      await navigation.recall();\n    } else if (prompt.getPercent('mv') < 0.1 || hp < 0.3) {\n      write('huir');\n    } else if (prompt.getPercent('mana') > 0.1) {\n      const fullName = captured[1];\n      const name = getMobIn(fullName);\n      await skills.castSpell(SPELLS_BY_TYPE.attack, name || fullName);\n    } else {\n      log('Nothing');\n    }\n  });\n\n  when('.. Todo empieza a volverse negro.\\n', async () => {\n    const RECUPERED =\n      'Tu cuerpo aparece de repente, rodeado por una divina presencia...';\n\n    let bodies = 0;\n\n    const sus = when(RECUPERED, () => bodies++);\n\n    await write('suplicar cuerpo');\n    await when(RECUPERED).timeout(5);\n\n    sus.unsubscribe();\n\n    when('El cadaver de May pasa a convertirse en polvo', () => bodies--);\n\n    while (bodies) {\n      write('coger todo may');\n      await prompt.until();\n      write('vestir todo');\n      await prompt.until();\n      await prompt.until();\n    }\n  });\n}\n","import { ClientStorage } from '@amatiasq/client-storage';\n\nimport { getSpells, SpellDescription, SPELLS_BY_TYPE } from '../data/spells';\nimport { Context } from '../lib/workflow/Context';\nimport { uniq } from '../util/uniq';\n\nconst memory = new ClientStorage<(string | string[])[]>('dope:casting');\n\nexport async function dope({\n  when,\n  write,\n  register,\n  run,\n  plugins: { prompt, skills },\n}: Context) {\n  const shouldHeal = defineShould(0.2);\n  const shouldRefresh = defineShould(0.1, 0.8);\n  const repeatUntilCasted = (\n    name: string | string[],\n    ...args: (string | undefined)[]\n  ) => run('cast', [name, ...args]).catch(() => null);\n\n  const casting = new Set(memory.get());\n  const spells = getSpells();\n\n  spells.filter(x => x.endEffect).forEach(watchDope);\n\n  prompt.onUpdate(\n    async ({\n      isFighting,\n      mana: { percent: mana },\n      hp: { percent: hp },\n      mv: { percent: mv },\n    }) => {\n      if (isFighting || mana === 0) {\n        return;\n      }\n\n      if (hp > 0 && shouldHeal(mana, hp)) {\n        return skills.castSpell(SPELLS_BY_TYPE.heal);\n      }\n\n      if (hp > 0 && shouldRefresh(mana, mv)) {\n        return skills.castSpell('refrescar');\n      }\n    },\n  );\n\n  register('dope', async (x: Context, name?: string) => {\n    const list = spells\n      .filter(x => x.dope && (name ? x.target : true))\n      .map(x => (Array.isArray(x.dope) ? x.dope.join('|') : x.name));\n\n    for (const spell of uniq(list)) {\n      await repeatUntilCasted(spell.split('|'), name);\n    }\n  });\n\n  async function watchDope(spell: SpellDescription) {\n    const invoke = Array.isArray(spell.dope) ? spell.dope : spell.name;\n\n    when(spell.endEffect!, async () => {\n      casting.add(invoke);\n      memory.set([...casting]);\n\n      const success = await repeatUntilCasted(invoke);\n\n      if (success) {\n        casting.delete(invoke);\n        memory.set([...casting]);\n\n        const after = spell.afterDope;\n\n        if (Array.isArray(after)) {\n          after.forEach(x => write(x));\n        } else if (after) {\n          write(after as string);\n        }\n      }\n    });\n  }\n\n  function defineShould(min: number, max = 1) {\n    const multiplier = 1 / (max - min);\n\n    return (mana: number, stat: number) => {\n      if (mana === 0 || stat > max) return false;\n      if (stat < min) return true;\n\n      const clapped = (stat - min) * multiplier;\n      return Math.hypot(mana, 1 - clapped) > 1;\n    };\n  }\n}\n","export function uniq<T>(list: T[]) {\n  return [...new Set(list)];\n}\n","import { Context } from './../lib/workflow/Context';\n\nexport async function drink({\n  when,\n  write,\n  plugins: { inventory, navigation, skills },\n}: Context) {\n  let isFontAvailable = false;\n  let isBottleFull = false;\n\n  navigation.onRoomChange(() => (isFontAvailable = false));\n\n  when(\n    [\n      'Un manantial magico esta aqui.',\n      'Una hermosa fuente de marmol blanco esta aqui.',\n      'Trazas un circulo delante tuyo del cual emerge un manantial de agua cristalina.',\n    ],\n    async () => {\n      isFontAvailable = true;\n\n      if (!isBottleFull) {\n        const bottle = await getWaterBottle();\n\n        if (bottle) {\n          write(`llenar ${bottle}`);\n          isBottleFull = true;\n        }\n      }\n    },\n  );\n\n  when(\n    [\n      'Te apetece dar un sorbo a algo refrescante.',\n      'Tienes sed.',\n      // 'Estas sediento.',\n      'Estas realmente sediento.',\n      'Estas MUERTO de SED!',\n      'Estas en peligro de deshidratacion.',\n    ],\n    async () => {\n      if (isFontAvailable || (await skills.castSpell('crear manantial'))) {\n        write('beber');\n        return;\n      }\n\n      const bottle = await getWaterBottle();\n\n      if (!bottle) {\n        console.log('No hay fuente de agua');\n        return;\n      }\n\n      write(`beber ${bottle}`);\n      await skills.castSpell('crear agua', bottle);\n    },\n  );\n\n  async function getWaterBottle() {\n    return inventory.has({\n      'un odre de cuero': 'odre',\n      'una cantimplora': 'cantimplora',\n    });\n  }\n}\n","import { Context } from './../lib/workflow/Context';\n\nexport async function eat({\n  when,\n  write,\n  plugins: { inventory, navigation: nav, skills },\n}: Context) {\n  const EXPECTED_FOOD = 1;\n  const DEFAULT_FOOD_NAME = 'chuleta';\n\n  when(['Tienes hambre.', 'Estas realmente hambriento.'], eatSomething);\n\n  when(['Estas terriblemente hambriento.', 'Estas HAMBRIENTO!'], async () => {\n    if (await eatSomething()) {\n      return;\n    }\n\n    if (nav.isAtRecall) {\n      await buyFood();\n      await eatSomething();\n    }\n  });\n\n  async function eatSomething() {\n    const food = await getFoodFromInventory();\n\n    if (food) {\n      write(`comer ${food}`);\n      inventory.refresh();\n      return true;\n    }\n\n    return await createFood();\n  }\n\n  async function createFood() {\n    if (!(await skills.castSpell('crear comida'))) {\n      return false;\n    }\n\n    write('coger seta');\n\n    try {\n      await when('Coges una seta magica.').timeout(3);\n      write('comer seta');\n      return true;\n    } catch (err) {\n      return false;\n    }\n  }\n\n  async function buyFood() {\n    await nav.execute('2sen');\n\n    write(`comprar ${EXPECTED_FOOD} ${DEFAULT_FOOD_NAME}`);\n\n    await Promise.any([\n      when('Compras una chuleta de cordero.'),\n      when('El carnicero pone todo en una bolsa y te la da.').then(\n        getFoodFromBag,\n      ),\n    ]);\n\n    await nav.execute('sw2n');\n  }\n\n  async function getFoodFromInventory() {\n    await getFoodFromBag();\n\n    return await inventory.has({\n      'un chorizo': 'chorizo',\n      'pavo cocinado': 'pavo',\n      'una chuleta de cordero': 'chuleta',\n      'loncha de salami': 'salami',\n      'pierna de cordero': 'pierna',\n      'ricas longanizas': 'longanizas',\n      'un extranyo hongo': 'hongo',\n    });\n  }\n\n  async function getFoodFromBag() {\n    if (await inventory.has('una bolsa')) {\n      write('coger todo bolsa');\n      write('examinar bolsa');\n\n      const { captured } = await when(/Una bolsa contiene:\\n\\s+(Nada)?/);\n      if (captured[1]) {\n        write('tirar bolsa');\n      }\n    }\n  }\n}\n","import { Context } from './../lib/workflow/Context';\n\nexport async function idle({\n  when,\n  write,\n  run,\n  plugins: { navigation, skills },\n}: Context) {\n  when('Desapareces en la nada.', async () => {\n    console.log('IDLE');\n\n    if (!navigation.isAtRecall) {\n      write('estado');\n      return;\n    }\n\n    await run('train');\n\n    if (skills.has('invisibilidad')) {\n      await run('cast', ['invisibilidad']);\n    }\n  });\n}\n","import { getItemSustantive, ItemName, UNWEAR } from '../data/items';\nimport { wait } from '../lib/util/wait';\nimport { Context } from '../lib/workflow/Context';\n\nexport async function repair({\n  when,\n  write,\n  register,\n  plugins: { navigation, prompt },\n}: Context) {\n  register('repair', async () => {\n    const broken = await getBrokenEquipment();\n\n    if (broken) {\n      await navigation.execute('r2ses');\n      return repairEquipment(broken);\n    }\n  });\n\n  when('No puedes vestir eso, necesita repararse.', async () => {\n    await navigation.execute('r2ses');\n    await repairAll();\n\n    const broken = await getBrokenEquipment();\n\n    if (broken) {\n      return repairEquipment(broken);\n    }\n  });\n\n  async function repairEquipment(broken: ItemName[]) {\n    for (const item of broken) {\n      write(`guardar ${item}`);\n      await when(UNWEAR);\n    }\n\n    await repairAll();\n    return navigation.execute('nw2n');\n  }\n\n  async function getBrokenEquipment() {\n    const broken: ItemName[] = [];\n    write('equipo');\n\n    const sus = when(/>\\s+\\[\\+*[^+]+\\] (?<item>.*)/, ({ groups }) => {\n      const item = getItemSustantive(groups.item);\n      if (item) broken.push(item);\n    });\n\n    await when('Estas usando:');\n    await prompt.until();\n    sus.unsubscribe();\n\n    return broken.length ? broken : null;\n  }\n\n  async function repairAll() {\n    write('reparar todo');\n\n    await Promise.any([\n      when('El herrero te cobra').then(() => true),\n      when('El herrero te cuenta').then(() => false),\n      wait(5).then(() => null),\n    ]);\n\n    write('vestir todo');\n  }\n}\n","import { Context } from './../lib/workflow/Context';\n\nexport async function rest({ when, write }: Context) {\n  when(\n    [\n      'Nah... Estas demasiado relajado...',\n      'En tus suenyos o que?',\n      'Estas demasiado relajado para lanzar ese conjuro.',\n    ],\n    () => write('despertar'),\n  );\n}\n","import { Context } from './../lib/workflow/Context';\n\nexport async function afk(\n  { abort, run, when, plugins: { prompt, navigation } }: Context,\n  ...areas: string[]\n) {\n  when('.. Todo empieza a volverse negro.\\n', abort);\n\n  await action();\n\n  async function action(): Promise<void> {\n    await prompt.whenFresh();\n    await run('repair');\n    await run('dope');\n    await prompt.whenFresh();\n    console.log('Stats 100%. Start train...');\n\n    try {\n      await run('train', [rand(areas || [])]);\n      console.log('workflow completed');\n    } catch (error) {\n      console.log('workflow failed');\n    }\n\n    if (navigation.isAtRecall) {\n      await run('bank');\n    }\n\n    return action();\n  }\n}\n\nfunction rand<T>(list: T[]) {\n  return list[Math.floor(Math.random() * list.length)];\n}\n","import { concatRegexes } from '../lib/util/concatRegexes';\nimport { int, toInt } from '../lib/util/int';\nimport { Context } from '../lib/workflow/Context';\n\nexport async function bank(\n  { when, write, plugins: { navigation } }: Context,\n  take?: number,\n) {\n  const INGRESS = concatRegexes(\n    /Ingresas /,\n    int(),\n    / monedas? de oro en tu cuenta bancaria./,\n  );\n  const EXTRACT = concatRegexes(\n    /Retiras /,\n    int(),\n    / monedas? de oro de tu cuenta bancaria./,\n  );\n\n  await navigation.execute('r4s2en');\n\n  write('banco saldo');\n\n  const { groups } = await when(\n    concatRegexes(\n      /Estas llevando /,\n      int('carring'),\n      / monedas de oro.\\n/,\n      /Tienes /,\n      int('balance'),\n      / monedas de oro en el banco.\\n/,\n      /Lo que hace un total de /,\n      int('total'),\n      / monedas de oro.\\n/,\n    ),\n  );\n\n  const carring = toInt(groups.carring);\n  const balance = toInt(groups.balance);\n  const total = toInt(groups.total);\n  const final = take == null ? Math.ceil(total * 0.01) : take;\n\n  if (carring < final) {\n    write(`banco retirar ${final - carring}`);\n    await when(EXTRACT);\n  } else if (carring > final) {\n    write(`banco ingresar ${carring - final}`);\n    await when(INGRESS);\n  }\n\n  await navigation.execute('s2w4n');\n}\n","import { wait } from '../lib/util/wait';\nimport { Context } from '../lib/workflow/Context';\n\nexport async function cast(\n  { plugins: { prompt, skills } }: Context,\n  spell: string | string[],\n  ...args: string[]\n) {\n  const result = await repeatUntilCasted();\n\n  if (result === false) {\n    throw new Error(`Unable to cast \"${spell}\"`);\n  }\n\n  return result;\n\n  async function repeatUntilCasted(): Promise<boolean> {\n    if (prompt.isFighting) {\n      await prompt.until(x => !x.isFighting);\n    }\n\n    switch (await skills.castSpell(spell, args.join(' '))) {\n      case skills.CASTED:\n      case skills.ALREADY_APPLIED:\n        return true;\n      case skills.NOT_AVAILABLE:\n        return false;\n      case skills.BUSY:\n        await wait(3);\n      case skills.FAILED:\n        return repeatUntilCasted();\n    }\n\n    throw new Error('WTF DUDE');\n  }\n}\n","import { ITEM_SUSTANTIVES } from '../data/items';\nimport { Context } from './../lib/workflow/Context';\n\nconst rooms = [\n  { from: 31, to: 40, path: '4wn' },\n  { from: 21, to: 30, path: '3wn' },\n  { from: 11, to: 20, path: '2wn' },\n  { from: 1, to: 10, path: 'wn' },\n  { from: 41, to: 50, path: 'en' },\n  { from: 51, to: 60, path: '2en' },\n  { from: 61, to: 70, path: '3en' },\n  { from: 71, to: 80, path: '4en' },\n];\n\nexport async function donations({\n  when,\n  write,\n  run,\n  plugins: { navigation: nav, stats },\n}: Context) {\n  write('estado');\n  const level = await stats.getLevel();\n  const room = rooms.find(x => x.from <= level && x.to <= level);\n\n  if (!room) {\n    throw new Error(`No room for level \"${level}\"`);\n  }\n\n  await nav.execute('rh2w4n');\n\n  const promise = when(/Salidas: sur\\.\\n\\n((?:.|\\n)*)\\n\\n/, {\n    // donations rooms can get HUGE\n    captureLength: Number.MAX_VALUE,\n  });\n\n  await nav.execute(room.path);\n\n  const { captured: itemsMatch } = await promise;\n  const list = itemsMatch[1].split('\\n').map(x => x.trim());\n\n  for (const item of Object.values(ITEM_SUSTANTIVES)) {\n    const found = list.some(x => x.includes(item) && !x.includes('mallas'));\n\n    if (found) {\n      await run('wear', [item]);\n    }\n  }\n\n  await nav.recall();\n}\n","import { getAreaMetadata } from '../data/areas';\nimport { Context } from '../lib/workflow/Context';\n\nconst PATH = /^r?((?:x|\\d+)?nsewudohjkl)+$/;\n\nexport function go({ plugins: { navigation } }: Context, path: string) {\n  const area = PATH.test(path) ? null : getAreaMetadata(path);\n\n  if (area && area.path) {\n    path = area.path;\n    console.log(`Going ${area.name}`);\n  }\n\n  return navigation.execute(path);\n}\n","export default {\n  Calimhar: [\n    {\n      name: 'Academia de Darkhaven',\n      from: 1,\n      to: 5,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Bosque de las Hadas',\n      from: 1,\n      to: 5,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Catacumbas de la Capilla',\n      from: 15,\n      to: 25,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Cementerio Oscuro',\n      clan: 'Legends',\n      from: 5,\n      to: 15,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Ciudad Imperial',\n      from: 0,\n      to: 95,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'DarkHaven',\n      from: 0,\n      to: 95,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Campamento Goblin',\n      from: 1,\n      to: 10,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Cementerio',\n      from: 5,\n      to: 10,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Centinela',\n      from: 5,\n      to: 10,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Gran Estadio',\n      from: 10,\n      to: 20,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Imperio Orco',\n      clan: 'Legends',\n      from: 10,\n      to: 20,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Jardin de los Heroes',\n      from: 75,\n      to: 80,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Pantano Orco',\n      clan: 'DarkAngels',\n      from: 5,\n      to: 30,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Refugio Destruido',\n      from: 5,\n      to: 20,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Exportaciones de Dragones',\n      clan: 'Legends',\n      from: 5,\n      to: 25,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Foire de Reves',\n      from: 0,\n      to: 50,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Galeria de arte',\n      from: 10,\n      to: 50,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Guarderia Enana',\n      from: 1,\n      to: 5,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Haon Dor',\n      from: 5,\n      to: 10,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Holy Grove',\n      from: 5,\n      to: 20,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Kharadest, Baluarte de Platino',\n      from: 78,\n      to: 80,\n      min: 77,\n      max: 95,\n    },\n    {\n      name: 'La Fortaleza de Valor',\n      clan: 'DragonSlayers',\n      from: 5,\n      to: 30,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Mansion de Marmol',\n      from: 5,\n      to: 15,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Mansion de Tullfuhrzky',\n      from: 1,\n      to: 10,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Torre del Brujo',\n      clan: 'Legends',\n      from: 10,\n      to: 20,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Las Alcantarillas',\n      from: 5,\n      to: 20,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Las Llanuras del Norte',\n      from: 1,\n      to: 20,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: \"Miden'nir\",\n      from: 5,\n      to: 15,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Residencias de Mortales',\n      from: 0,\n      to: 95,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Sindaliore',\n      clan: 'Legends',\n      from: 75,\n      to: 80,\n      min: 77,\n      max: 95,\n    },\n  ],\n  Earand: [\n    {\n      name: 'Armageddon',\n      clan: 'Conclave',\n      from: 50,\n      to: 80,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Asgard',\n      clan: 'El Santuario',\n      from: 40,\n      to: 60,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Asoinwan, ciudad de las hadas',\n      clan: 'DragonSlayers',\n      from: 5,\n      to: 30,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Camelot',\n      from: 65,\n      to: 80,\n      min: 50,\n      max: 95,\n    },\n    {\n      name: 'Dregoria',\n      clan: 'Cantico',\n      from: 40,\n      to: 65,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Calabozo de la Muerte',\n      from: 10,\n      to: 35,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Campo de Batalla Desolado',\n      from: 15,\n      to: 25,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Plano Astral',\n      clan: 'DarkAngels',\n      from: 15,\n      to: 35,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Pueblo Fantasma',\n      clan: 'DragonSlayers',\n      from: 35,\n      to: 50,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Reino de Yggdrasil',\n      from: 15,\n      to: 50,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Yunque del Sol',\n      clan: 'Legends',\n      from: 60,\n      to: 80,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Estroglia, coraz�n del Yunque',\n      clan: 'DarkAngels',\n      from: 75,\n      to: 80,\n      min: 75,\n      max: 95,\n    },\n    {\n      name: 'Ghotiamir',\n      from: 0,\n      to: 95,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Ciudad de Velas',\n      from: 45,\n      to: 55,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Fortaleza de Lord Krothgar',\n      from: 35,\n      to: 60,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Fortaleza Enana',\n      clan: 'El Santuario',\n      from: 35,\n      to: 65,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Guarida de Kotegaesi',\n      from: 30,\n      to: 45,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La tumba de Damara',\n      clan: 'Shinsent',\n      from: 15,\n      to: 25,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Las Ruinas de los Antiguos',\n      from: 78,\n      to: 80,\n      min: 77,\n      max: 95,\n    },\n    {\n      name: 'Observatorio del Ojo Celeste',\n      clan: 'Cantico',\n      from: 25,\n      to: 65,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Valle de Rivendel',\n      from: 60,\n      to: 80,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Villa Enana',\n      from: 10,\n      to: 35,\n      min: 0,\n      max: 95,\n    },\n  ],\n  Niruk: [\n    {\n      name: 'La casa de Anarion',\n      from: 75,\n      to: 80,\n      min: 75,\n      max: 95,\n    },\n    {\n      name: 'Las Tierras Desoladas',\n      clan: 'DarkAngels',\n      from: 10,\n      to: 80,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Residencia de Inmortales',\n      from: 81,\n      to: 95,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: \"Tiempo de L'Hopital\",\n      from: 75,\n      to: 80,\n      min: 75,\n      max: 95,\n    },\n  ],\n  Valmorag: [\n    {\n      name: 'Bosque de los Muertos',\n      from: 20,\n      to: 40,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Dhusebark',\n      from: 0,\n      to: 95,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Devorador de Mundos',\n      from: 30,\n      to: 50,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Legado de Xchantharus',\n      clan: 'El Santuario',\n      from: 30,\n      to: 50,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'El Mausoleo del Minotauro',\n      from: 40,\n      to: 65,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Guarida de Gigantes de Fuego',\n      from: 40,\n      to: 50,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Infierno',\n      from: 30,\n      to: 80,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Ciudad Maldita',\n      clan: 'Sindicato',\n      from: 40,\n      to: 80,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Fortaleza de Lilith',\n      clan: 'Torre Arcana',\n      from: 65,\n      to: 80,\n      min: 55,\n      max: 95,\n    },\n    {\n      name: 'La Fortaleza de Mahn-Tor',\n      from: 5,\n      to: 35,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Gran Torre de la Hechiceria',\n      from: 10,\n      to: 30,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Maldicion del Nigromante',\n      clan: 'Cantico',\n      from: 30,\n      to: 55,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'La Residencia de Redferne',\n      from: 20,\n      to: 30,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Los Pozos de la Reina Aranya',\n      from: 40,\n      to: 55,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Los Usurpadores de Hochenyana',\n      clan: 'Shinsent',\n      from: 20,\n      to: 35,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Profundidades Umbrias',\n      from: 20,\n      to: 50,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Puerto Libre',\n      from: 10,\n      to: 55,\n      min: 0,\n      max: 95,\n    },\n    {\n      name: 'Valle de Morgul',\n      clan: 'Shinsent',\n      from: 30,\n      to: 55,\n      min: 0,\n      max: 95,\n    },\n  ],\n} as const;\n","import { SPELLS_BY_TYPE } from '../data/spells';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { Context } from '../lib/workflow/Context';\nimport { CastSpellResult } from '../plugins/skillsPlugin';\n\nexport async function kill(\n  { when, write, plugins: { navigation, skills } }: Context,\n  target: string,\n) {\n  const attackSpells = [...SPELLS_BY_TYPE.dedope, ...SPELLS_BY_TYPE.attack];\n  const cast = () => skills.castSpell(attackSpells, target);\n\n  if (!(await tryNTimes(3, cast))) {\n    write(`matar ${target}`);\n  }\n\n  // wile result == null cast attack!!!!\n  const result = await Promise.any([\n    navigation.waitForRecall().then(() => 'flee'),\n    when(concatRegexes(target, /(?:\\w| )* ha MUERTO!!/)).then(() => 'win'),\n    when('No esta aqui.')\n      .timeout(3)\n      .then(() => 'missing'),\n    when([\n      'Huyes como un cobarde del combate.',\n      'Estas demasiado malherido para hacer eso.',\n      'Estas demasiado aturdido para hacer eso.',\n    ]).then(() => 'flee'),\n  ]);\n\n  if (result === 'win') {\n    write('sacrificar cuerpo');\n    await when('te da una moneda de oro por tu sacrificio.');\n  }\n\n  return result;\n\n  async function tryNTimes(\n    times: number,\n    action: () => Promise<CastSpellResult>,\n  ) {\n    for (let i = 0; i < times; i++) {\n      if (await action()) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n}\n","import { getAreaMetadata, getAreasForLevel } from '../data/areas';\nimport { getMobIn, MOB_ARRIVES, MOB_LEAVES, MOB_PRESENT } from '../data/mobs';\nimport { Context } from '../lib/workflow/Context';\n\nexport async function train(\n  {\n    log,\n    run,\n    when,\n    write,\n    printLogs,\n    plugins: { navigation: nav, prompt, stats },\n  }: Context,\n  area?: string,\n) {\n  const arena = await getArena(area);\n  const enemies: string[] = [];\n\n  when(MOB_PRESENT, ({ captured, fullMatch }) =>\n    enemySpotted(fullMatch || captured[0]),\n  );\n\n  when(MOB_ARRIVES, ({ groups }) => enemySpotted(groups.mob));\n  when(MOB_LEAVES, x => {\n    const { mob } = x.groups;\n    if (mob) {\n      enemyGone(x.groups.mob);\n    } else {\n      console.warn(`No MOB detected in`, x.captured);\n    }\n  });\n\n  const route = `${arena.path}${arena.arena}`;\n\n  write('visible');\n\n  await nav.execute(route, enterRoom);\n  return nav.recall();\n\n  async function enterRoom() {\n    await prompt.until(({ mv: { current: mv } }) => mv > 50);\n\n    while (enemies.length) {\n      if (await checkEnemies()) {\n        return false;\n      }\n\n      await Promise.any([when(MOB_ARRIVES), readyToFight()]);\n    }\n  }\n\n  async function readyToFight() {\n    return prompt.until(\n      ({ hp: { percent: hp }, mana: { percent: mana } }) =>\n        hp > 0.7 && mana > 0.5,\n    );\n  }\n\n  function enemySpotted(text: string) {\n    const mob = getMobIn(text);\n\n    if (mob) {\n      enemies.push(mob);\n    }\n  }\n\n  function enemyGone(text: string) {\n    const mob = getMobIn(text);\n\n    if (mob) {\n      const index = enemies.indexOf(mob);\n      if (index > -1) {\n        enemies.splice(index, 1);\n      }\n    }\n  }\n\n  async function checkEnemies() {\n    while (enemies.length) {\n      const result = await run('kill', [enemies.pop()!]);\n\n      if (result === 'flee') {\n        console.log('Had to run. Train over.');\n        await nav.recall();\n        return true;\n      }\n\n      log(`Fight result: ${result}`);\n    }\n  }\n\n  async function getArena(areaName?: string) {\n    const area = areaName ? getAreaMetadata(areaName) : await getBestArea();\n\n    if (!area) {\n      throw new Error(`NO AREA \"${areaName}\"`);\n    }\n\n    if (!area.arena) {\n      throw new Error(`\"${area.name}\" is unknown`);\n    }\n\n    const path = area.path!.split('');\n    const last = path.pop();\n    const arena = Array.isArray(area.arena) ? area.arena.join('') : area.arena;\n\n    return { path: path.join(''), arena: `${last}${arena}` };\n  }\n\n  async function getBestArea() {\n    const level = await stats.getLevel();\n    const areas = getAreasForLevel(level);\n    const [first, ...others] = areas.filter(x => x.arena);\n\n    if (others.length) {\n      console.warn('Multiple arenas available');\n    }\n\n    return first;\n  }\n}\n","import {\n  getItemSustantive,\n  ITEM_ARTICLE,\n  ITEM_SUSTANTIVES,\n  UNWEAR,\n  WEAR,\n} from '../data/items';\nimport { concatRegexes } from '../lib/util/concatRegexes';\nimport { Context } from '../lib/workflow/Context';\n\nexport async function wear({ run, when, write }: Context, ...args: string[]) {\n  const items = args.length ? args : ITEM_SUSTANTIVES;\n\n  for (const item of items) {\n    for (let i = 0; i < 5; i++) {\n      if (await wearItem(item)) {\n        break;\n      }\n    }\n  }\n\n  async function wearItem(item: string) {\n    write(`coger \"${item}\"`);\n\n    const pickedUp = await Promise.any([\n      when(`No hay ningun ${item} aqui.`)\n        .wait(8)\n        .then(() => false),\n      when(\n        concatRegexes(/Coges/, ITEM_ARTICLE, /(?: (?:\\\\w|�)+)* /i, item),\n      ).then(() => true),\n    ]);\n\n    if (!pickedUp) {\n      throw new Error(`Couldn't pick up \"${item}\"`);\n    }\n\n    let isMetallic = false;\n\n    const sus = when(' es un(a) armadura_metalica,', () => (isMetallic = true));\n    const identified = await run('cast', ['identificar', item]);\n    sus.unsubscribe();\n\n    if (!identified) {\n      throw new Error(`Couldn't identifiy \"${item}\"`);\n    }\n\n    if (isMetallic) {\n      await tirar(item);\n      return false;\n    }\n\n    write(`vestir \"${item}\"`);\n\n    const result = await Promise.any([\n      when(WEAR).then(() => true),\n      when(UNWEAR).then(({ groups }) => groups.item),\n      when([\n        /Debes ser nivel \\w+ para usar este objeto./,\n        'No puedes vestir eso, necesita repararse.',\n      ]).then(() => false),\n    ]);\n\n    if (result === false) {\n      await tirar(item);\n      return false;\n    }\n\n    if (typeof result === 'string') {\n      const other = getItemSustantive(result);\n\n      if (other) {\n        await run('cast', ['identificar', other]);\n        write(`poner ${other} mochila`);\n        await when('Pones ');\n      }\n    }\n\n    return true;\n  }\n\n  function tirar(item: string) {\n    write(`tirar \"${item}\"`);\n    return when('Tiras ');\n  }\n}\n","import { ClientStorage } from '@amatiasq/client-storage';\nimport './index.css';\n\nimport { Controls } from './Controls/Controls';\nimport { Hamburger } from './Hamburger/Hamburger';\nimport html from './index.html';\nimport { render } from './render';\nimport { Sidebar } from './Sidebar/Sidebar';\nimport { Terminal } from './Terminal/Terminal';\n\nexport function renderUserInterface(parent: HTMLElement) {\n  const state = initState();\n  const data = state.get()!;\n\n  const dom = render(html);\n  const main = dom.$('.container');\n\n  const sidebar = new Sidebar();\n  sidebar.render(main);\n\n  const controls = new Controls();\n  controls.render(main);\n\n  const terminal = new Terminal();\n  terminal.render(main);\n\n  parent.appendChild(dom);\n\n  const hamburger = new Hamburger(data.showControls);\n  hamburger.render(parent);\n\n  hamburger.onChange(x => {\n    if (x) {\n      main.classList.add('show-controls');\n      data.showControls = true;\n    } else {\n      main.classList.remove('show-controls');\n      data.showControls = false;\n    }\n\n    state.set(data);\n  });\n\n  return { controls, sidebar, terminal };\n}\n\nfunction initState() {\n  const state = new ClientStorage<{ showControls: boolean }>('ui:state');\n  const data = state.get();\n\n  if (!data) {\n    state.set({ showControls: false });\n  }\n\n  return state;\n}\n","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!./index.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import './Controls.css';\n\nimport { render } from '../render';\nimport html from './Controls.html';\n\ntype Observable = (listener: (data: number) => void) => void;\n\nexport class Controls {\n  private readonly dom = render(html);\n  private readonly meterTpl = this.dom.$('.meter-template')!;\n  private readonly buttonTpl = this.dom.$('.button-template')!;\n\n  render(parent: HTMLElement) {\n    parent.appendChild(this.dom);\n  }\n\n  addMeter(color: string, observable: Observable) {\n    const fragment = render(this.meterTpl, {\n      '.meter': x => {\n        x.style.setProperty('--color', color);\n        x.style.setProperty('--value', '100%');\n\n        observable(value => {\n          const percent = Math.round(value * 100);\n          x.style.setProperty('--value', `${percent}%`);\n        });\n      },\n    });\n\n    this.dom.appendChild(fragment);\n  }\n\n  addButton(name: string, onClick: () => void) {\n    const fragment = render(this.buttonTpl, {\n      button: x => {\n        x.textContent = name;\n        x.addEventListener('click', onClick);\n      },\n    });\n\n    this.dom.appendChild(fragment);\n  }\n}\n","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!./Controls.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","// Module\nvar code = \"<header class=\\\"controls\\\"></header> <template class=\\\"meter-template\\\"> <div class=\\\"meter\\\" data-color=\\\"white\\\" data-value=\\\"100%\\\"> <div class=\\\"bar\\\"></div> </div> </template> <template class=\\\"button-template\\\"> <button class=\\\"ui-button\\\"></button> </template> \";\n// Exports\nmodule.exports = code;","import './Hamburger.css';\n\nimport { emitter } from '@amatiasq/emitter';\n\nimport { render } from '../render';\nimport html from './Hamburger.html';\n\nexport class Hamburger {\n  private readonly dom = render(html);\n  private readonly checkbox = this.dom.$<HTMLInputElement>('input');\n\n  private readonly emitChange = emitter<boolean>();\n  readonly onChange = this.emitChange.subscribe;\n\n  constructor(initialState = false) {\n    this.toggle = this.toggle.bind(this);\n    this.checkbox.checked = initialState;\n  }\n\n  render(parent: HTMLElement) {\n    this.checkbox.addEventListener('change', this.toggle);\n\n    parent.appendChild(this.dom);\n\n    if (this.checkbox.checked) {\n      this.toggle();\n    }\n  }\n\n  toggle() {\n    this.emitChange(this.checkbox.checked);\n  }\n}\n","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!./Hamburger.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","// Module\nvar code = \"<div class=\\\"hamburger\\\"> <input type=\\\"checkbox\\\"/> <span></span> <span></span> <span></span> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"container\\\"></div> \";\n// Exports\nmodule.exports = code;","import './Sidebar.css';\n\nimport { render } from '../render';\nimport html from './Sidebar.html';\n\nexport class Sidebar {\n  private readonly dom = render(html);\n\n  render(parent: HTMLElement) {\n    parent.appendChild(this.dom);\n  }\n}\n","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!./Sidebar.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","// Module\nvar code = \"<aside class=\\\"sidebar\\\"></aside> \";\n// Exports\nmodule.exports = code;","import { ClientStorage } from '@amatiasq/client-storage';\nimport './Terminal.css';\n\nimport Convert from 'ansi-to-html';\n\nimport { emitter } from '@amatiasq/emitter';\n\nimport { render } from '../render';\nimport html from './Terminal.html';\n\nconst convert = new Convert();\nconst history = new ClientStorage<string[]>('mud:command-history');\n\nexport class Terminal {\n  private readonly dom = render(html);\n  private readonly $log = this.dom.$('.log');\n  private readonly $input = this.dom.$<HTMLInputElement>('input');\n  private readonly log: string[] = [];\n  private readonly history: string[] = history.get() || [];\n  private histPos = 0;\n\n  private readonly emitSubmit = emitter<string>();\n  readonly onSubmit = this.emitSubmit.subscribe;\n\n  constructor() {\n    this.onKey = this.onKey.bind(this);\n  }\n\n  focus() {\n    this.$input.focus();\n  }\n\n  render(parent: HTMLElement) {\n    this.dom.$('.terminal').addEventListener('click', () => {\n      if (!userHasSelectedText()) {\n        this.$input.focus();\n      }\n    });\n\n    this.$input.addEventListener('keydown', this.onKey);\n    parent.appendChild(this.dom);\n  }\n\n  write(data: string) {\n    const $parent = this.$log.parentElement!;\n    const prev = this.log.length ? this.log.pop() : '';\n    const content = `${prev}${fixLineEndings(data)}`.split(/\\n\\n+/);\n    const last = content.pop()!;\n\n    for (const block of content) {\n      this.log.push(block);\n\n      const p = document.createElement('p');\n      p.innerHTML = asciiToHtml(block);\n      $parent.insertBefore(p, this.$log);\n    }\n\n    this.log.push(last);\n    this.$log.innerHTML = asciiToHtml(last);\n\n    if (!userHasSelectedText()) {\n      $parent.scrollTop = $parent.scrollHeight;\n    }\n  }\n\n  private onKey(event: KeyboardEvent) {\n    if (event.code === 'Enter') {\n      this.submit();\n    }\n\n    if (event.code === 'ArrowUp') {\n      this.loadHistory(1);\n    }\n\n    if (event.code === 'ArrowDown') {\n      this.loadHistory(-1);\n    }\n\n    this.$input.size = this.$input.value.length + 1;\n  }\n\n  private submit() {\n    const { value } = this.$input;\n    this.$input.value = '';\n    this.histPos = 0;\n\n    for (const command of value.split(/\\s+;\\s+/)) {\n      if (command) {\n        this.history.shift();\n        this.history.unshift(command);\n        this.history.unshift('');\n        history.set(this.history);\n      }\n\n      this.emitSubmit(command);\n    }\n  }\n\n  private loadHistory(modifier: 1 | -1) {\n    if (!this.history.length) {\n      return;\n    }\n\n    this.history[this.histPos] = this.$input.value;\n    this.histPos = clamp(this.histPos + modifier, 0, this.history.length - 1);\n    this.$input.value = this.history[this.histPos];\n  }\n}\n\nfunction asciiToHtml(text: string) {\n  const escaped = escapeHtml(text);\n  const html = convert.toHtml(escaped);\n  return html.replace(/\\n/g, '<br>');\n}\n\nfunction fixLineEndings(text: string) {\n  return text.replace(/\\r/g, '');\n}\n\nfunction escapeHtml(unsafe: string) {\n  return unsafe\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#039;')\n    .replace(/  +/g, x => '&nbsp;'.repeat(x.length));\n}\n\nfunction userHasSelectedText() {\n  const selection = getSelection();\n  return selection && selection.type === 'Range';\n}\n\nfunction clamp(value: number, min: number, max: number) {\n  return value < min ? min : value > max ? max : value;\n}\n","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!./Terminal.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","// Module\nvar code = \"<main class=\\\"terminal\\\"> <span class=\\\"log\\\"></span> <input type=\\\"text\\\" size=\\\"1\\\" autofocus> </main>\";\n// Exports\nmodule.exports = code;","import { ClientStorage } from '@amatiasq/client-storage';\n\nexport function getPassword(user: string) {\n  const storage = new ClientStorage<string>(`pass:${user}`);\n  const stored = storage.get();\n\n  if (stored) {\n    return stored;\n  }\n\n  const input = prompt(`Password for ${user}`);\n\n  if (!input) {\n    throw new Error(`Password required`);\n  }\n\n  storage.set(input);\n  return input;\n}\n","export function getQueryParams() {\n  const result: { [key: string]: string } = {};\n\n  window.location.search\n    .substr(1)\n    .split('&')\n    .map(entry => entry.split('=').map(decodeURIComponent))\n    .forEach(([key, value]) => (result[key] = value));\n\n  return result;\n}\n"],"sourceRoot":""}
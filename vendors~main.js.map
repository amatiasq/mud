{"version":3,"sources":["webpack:///./node_modules/@amatiasq/emitter/dist.es2015/emitterWithChannels.js","webpack:///./node_modules/@amatiasq/emitter/dist.es2015/emitter.js","webpack:///./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///./node_modules/ws/browser.js","webpack:///./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/@amatiasq/client-storage/dist.es2015/ClientStorage.js","webpack:///./node_modules/ansi-to-html/lib/ansi_to_html.js","webpack:///./node_modules/ansi-to-html/node_modules/entities/index.js","webpack:///./node_modules/ansi-to-html/node_modules/entities/lib/encode.js","webpack:///./node_modules/ansi-to-html/node_modules/entities/lib/decode.js","webpack:///./node_modules/ansi-to-html/node_modules/entities/lib/decode_codepoint.js","webpack:///./node_modules/@amatiasq/resilient-socket/dist.es2015/ResilientSocket.js","webpack:///./node_modules/@amatiasq/socket/dist.es2015/internals/messaging.js","webpack:///./node_modules/@amatiasq/socket/dist.es2015/internals/parseJson.js","webpack:///./node_modules/@amatiasq/socket/dist.es2015/internals/ClientSocket.js","webpack:///./node_modules/@amatiasq/socket/dist.es2015/internals/ServerSocket.js","webpack:///./node_modules/@amatiasq/socket/dist.es2015/internals/ServerClients.js","webpack:///./node_modules/@amatiasq/socket/dist.es2015/internals/WebSocketServer.js"],"names":["emitterWithChannels","channels","Map","emit","subscribe","channel","listener","listeners","get","Set","size","set","add","delete","data","forEach","Boolean","emitter","memo","isOldIE","window","document","all","atob","getTarget","target","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","result","i","length","modulesToDom","list","options","idCountMap","identifiers","item","id","base","count","concat","index","obj","css","media","sourceMap","references","updater","push","addStyle","insertStyleElement","style","createElement","attributes","nonce","Object","keys","key","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","join","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","btoa","unescape","encodeURIComponent","JSON","stringify","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","module","exports","lastIdentifiers","newList","prototype","toString","call","newLastIdentifiers","_i","_index","splice","_slicedToArray","arr","Array","isArray","_arrayWithHoles","Symbol","iterator","_arr","_n","_d","_e","undefined","_s","next","done","value","err","_iterableToArrayLimit","o","minLen","_arrayLikeToArray","n","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","len","arr2","_item","content","cssMapping","base64","sourceMapping","sourceURLs","sources","map","source","sourceRoot","cssWithMappingToString","this","modules","mediaQuery","dedupe","alreadyImportedModules","ClientStorage","isSessionOnly","noCache","version","cache","isCached","useCache","storage","sessionStorage","localStorage","deepClone","load","json","save","setItem","getItem","parse","reset","delay","Promise","resolve","setTimeout","removeItem","_defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","colors","entities","defaults","fg","bg","newline","escapeXML","stream","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","range","red","green","blue","r","g","b","ref","results","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","toHexString","toColorHexString","setStyleColor","gray","c","l","num","str","generateOutput","stack","token","text","encodeXML","pushText","code","parseInt","codeMap","resetStyles","pushTag","pushStyle","22","23","closeTag","24","39","pushForegroundColor","49","pushBackgroundColor","53","handleDisplay","operation","substring","substr","rgb","split","Number","handleRgb","stackClone","reverse","tag","low","high","j","categoryForCode","color","last","pop","Filter","instance","Constructor","_classCallCheck","assign","stickyStack","protoProps","staticProps","input","_this","buf","element","output","callback","ansiMatch","m","tokens","pattern","sub","g1","trim","trimRight","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","process","handler","replace","results1","outer","tokenize","category","updateStickyStack","encode","decode","level","XML","HTML","decodeStrict","HTMLStrict","encodeHTML4","encodeHTML5","encodeHTML","decodeXML","decodeXMLStrict","decodeHTML4","decodeHTML5","decodeHTML","decodeHTML4Strict","decodeHTML5Strict","decodeHTMLStrict","escape","inverseXML","getInverseObj","xmlReplacer","getInverseReplacer","getInverse","inverseHTML","htmlReplacer","sort","reduce","inverse","single","multiple","k","unshift","RegExp","re_nonASCII","re_astralSymbols","singleCharReplacer","charCodeAt","toUpperCase","astralReplacer","re","func","re_xmlChars","entityMap","legacyMap","xmlMap","decodeCodePoint","getStrictDecoder","getReplacer","String","legacy","sorter","replacer","a","charAt","decodeMap","codePoint","fromCharCode","uri","reconnectionDelay","maxReconnectAttempts","reconnectAttempts","disconnectedAt","Date","isReconnecting","isFirstConnection","messageQueue","emitOpen","onOpen","emitError","onError","emitClose","onClose","emitMessage","onMessage","emitReconnect","onReconnect","connectionOpen","processMessage","connectionLost","ws","init","RECONNECTION_DELAY","MAX_RECONNECT_ATTEMPTS","isConnected","send","socket","WebSocket","addEventListener","removeEventListener","event","resetReconnectionCounters","disconnectedTime","processMessageQueue","reconnectionFailed","unbind","scheduleReconnection","message","console","error","reconnecting","singleLine","debug","onclose","close","ICMType","ISMType","parseJson","warn","typeListeners","emitConnected","onConnected","_open","_reconnect","_message","type","_sendInternal","AMQ_DISCONNECT","clientId","AMQ_CONNECT","AMQ_RECONNECT","AMQ_CONNECTED","emitDestroy","onDestroy","_onClose","_onMessage","on","payload","msg","destroy","off","lastId","clients","getNextId","client","has","server","emitConnection","onConnection","_onConnection","self","onClientConnected","onClientRecconect","bindTo"],"mappings":"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","file":"vendors~main.js","sourcesContent":["export function emitterWithChannels() {\n    const channels = new Map();\n    emit.subscribe = subscribe;\n    return emit;\n    function emit(channel, data) {\n        const listeners = channels.get(channel);\n        if (!listeners) {\n            return false;\n        }\n        listeners.forEach(listener => listener(data));\n        return Boolean(listeners.size);\n    }\n    function subscribe(channel, listener) {\n        const listeners = channels.get(channel) || new Set();\n        if (!listeners.size) {\n            channels.set(channel, listeners);\n        }\n        listeners.add(listener);\n        return () => listeners.delete(listener);\n    }\n}\n//# sourceMappingURL=emitterWithChannels.js.map","export function emitter() {\n    const listeners = new Set();\n    emit.subscribe = subscribe;\n    return emit;\n    function emit(data) {\n        listeners.forEach(listener => listener(data));\n        return Boolean(listeners.size);\n    }\n    function subscribe(listener) {\n        listeners.add(listener);\n        return () => listeners.delete(listener);\n    }\n}\n//# sourceMappingURL=emitter.js.map","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","'use strict';\n\nmodule.exports = function () {\n  throw new Error(\n    'ws does not work in the browser. Browser clients must use the native ' +\n      'WebSocket object'\n  );\n};\n","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (typeof btoa === 'function') {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n};","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","const DEFAULT_VERSION = 0;\nexport class ClientStorage {\n    constructor(key, { isSessionOnly = false, noCache = false, version = DEFAULT_VERSION, } = {}) {\n        this.key = key;\n        this.cache = null;\n        this.isCached = false;\n        this.version = version;\n        this.useCache = !noCache;\n        this.storage = isSessionOnly ? sessionStorage : localStorage;\n    }\n    get() {\n        if (!this.useCache) {\n            return this.load();\n        }\n        if (this.isCached) {\n            return deepClone(this.cache);\n        }\n        this.isCached = true;\n        this.cache = this.load();\n        return this.cache;\n    }\n    set(json) {\n        this.save(json);\n    }\n    save(json) {\n        const data = { data: json, version: this.version };\n        if (this.useCache) {\n            this.cache = json;\n            this.isCached = true;\n        }\n        this.storage.setItem(this.key, JSON.stringify(data));\n    }\n    load() {\n        const json = this.storage.getItem(this.key);\n        if (!json) {\n            return null;\n        }\n        const content = JSON.parse(json);\n        if (content.version !== this.version) {\n            this.reset();\n            return null;\n        }\n        if (this.useCache) {\n            this.cache = deepClone(content.data);\n            this.isCached = true;\n        }\n        return content.data;\n    }\n    loadAsync(delay = 100) {\n        return new Promise(resolve => {\n            setTimeout(() => resolve(this.load()), delay);\n        });\n    }\n    clear() {\n        const value = this.get();\n        this.reset();\n        return value;\n    }\n    reset() {\n        this.storage.removeItem(this.key);\n        this.cache = null;\n        this.isCached = true;\n    }\n}\nfunction deepClone(target) {\n    return typeof target === 'object'\n        ? JSON.parse(JSON.stringify(target))\n        : target;\n}\n//# sourceMappingURL=ClientStorage.js.map","\"use strict\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar entities = require('entities');\n\nvar defaults = {\n  fg: '#FFF',\n  bg: '#000',\n  newline: false,\n  escapeXML: false,\n  stream: false,\n  colors: getDefaultColors()\n};\n\nfunction getDefaultColors() {\n  var colors = {\n    0: '#000',\n    1: '#A00',\n    2: '#0A0',\n    3: '#A50',\n    4: '#00A',\n    5: '#A0A',\n    6: '#0AA',\n    7: '#AAA',\n    8: '#555',\n    9: '#F55',\n    10: '#5F5',\n    11: '#FF5',\n    12: '#55F',\n    13: '#F5F',\n    14: '#5FF',\n    15: '#FFF'\n  };\n  range(0, 5).forEach(function (red) {\n    range(0, 5).forEach(function (green) {\n      range(0, 5).forEach(function (blue) {\n        return setStyleColor(red, green, blue, colors);\n      });\n    });\n  });\n  range(0, 23).forEach(function (gray) {\n    var c = gray + 232;\n    var l = toHexString(gray * 10 + 8);\n    colors[c] = '#' + l + l + l;\n  });\n  return colors;\n}\n/**\n * @param {number} red\n * @param {number} green\n * @param {number} blue\n * @param {object} colors\n */\n\n\nfunction setStyleColor(red, green, blue, colors) {\n  var c = 16 + red * 36 + green * 6 + blue;\n  var r = red > 0 ? red * 40 + 55 : 0;\n  var g = green > 0 ? green * 40 + 55 : 0;\n  var b = blue > 0 ? blue * 40 + 55 : 0;\n  colors[c] = toColorHexString([r, g, b]);\n}\n/**\n * Converts from a number like 15 to a hex string like 'F'\n * @param {number} num\n * @returns {string}\n */\n\n\nfunction toHexString(num) {\n  var str = num.toString(16);\n\n  while (str.length < 2) {\n    str = '0' + str;\n  }\n\n  return str;\n}\n/**\n * Converts from an array of numbers like [15, 15, 15] to a hex string like 'FFF'\n * @param {[red, green, blue]} ref\n * @returns {string}\n */\n\n\nfunction toColorHexString(ref) {\n  var results = [];\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = ref[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var r = _step.value;\n      results.push(toHexString(r));\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return '#' + results.join('');\n}\n/**\n * @param {Array} stack\n * @param {string} token\n * @param {*} data\n * @param {object} options\n */\n\n\nfunction generateOutput(stack, token, data, options) {\n  var result;\n\n  if (token === 'text') {\n    result = pushText(data, options);\n  } else if (token === 'display') {\n    result = handleDisplay(stack, data, options);\n  } else if (token === 'xterm256') {\n    result = pushForegroundColor(stack, options.colors[data]);\n  } else if (token === 'rgb') {\n    result = handleRgb(stack, data);\n  }\n\n  return result;\n}\n/**\n * @param {Array} stack\n * @param {string} data\n * @returns {*}\n */\n\n\nfunction handleRgb(stack, data) {\n  data = data.substring(2).slice(0, -1);\n  var operation = +data.substr(0, 2);\n  var color = data.substring(5).split(';');\n  var rgb = color.map(function (value) {\n    return ('0' + Number(value).toString(16)).substr(-2);\n  }).join('');\n  return pushStyle(stack, (operation === 38 ? 'color:#' : 'background-color:#') + rgb);\n}\n/**\n * @param {Array} stack\n * @param {number} code\n * @param {object} options\n * @returns {*}\n */\n\n\nfunction handleDisplay(stack, code, options) {\n  code = parseInt(code, 10);\n  var codeMap = {\n    '-1': function _() {\n      return '<br/>';\n    },\n    0: function _() {\n      return stack.length && resetStyles(stack);\n    },\n    1: function _() {\n      return pushTag(stack, 'b');\n    },\n    3: function _() {\n      return pushTag(stack, 'i');\n    },\n    4: function _() {\n      return pushTag(stack, 'u');\n    },\n    8: function _() {\n      return pushStyle(stack, 'display:none');\n    },\n    9: function _() {\n      return pushTag(stack, 'strike');\n    },\n    22: function _() {\n      return pushStyle(stack, 'font-weight:normal;text-decoration:none;font-style:normal');\n    },\n    23: function _() {\n      return closeTag(stack, 'i');\n    },\n    24: function _() {\n      return closeTag(stack, 'u');\n    },\n    39: function _() {\n      return pushForegroundColor(stack, options.fg);\n    },\n    49: function _() {\n      return pushBackgroundColor(stack, options.bg);\n    },\n    53: function _() {\n      return pushStyle(stack, 'text-decoration:overline');\n    }\n  };\n  var result;\n\n  if (codeMap[code]) {\n    result = codeMap[code]();\n  } else if (4 < code && code < 7) {\n    result = pushTag(stack, 'blink');\n  } else if (29 < code && code < 38) {\n    result = pushForegroundColor(stack, options.colors[code - 30]);\n  } else if (39 < code && code < 48) {\n    result = pushBackgroundColor(stack, options.colors[code - 40]);\n  } else if (89 < code && code < 98) {\n    result = pushForegroundColor(stack, options.colors[8 + (code - 90)]);\n  } else if (99 < code && code < 108) {\n    result = pushBackgroundColor(stack, options.colors[8 + (code - 100)]);\n  }\n\n  return result;\n}\n/**\n * Clear all the styles\n * @returns {string}\n */\n\n\nfunction resetStyles(stack) {\n  var stackClone = stack.slice(0);\n  stack.length = 0;\n  return stackClone.reverse().map(function (tag) {\n    return '</' + tag + '>';\n  }).join('');\n}\n/**\n * Creates an array of numbers ranging from low to high\n * @param {number} low\n * @param {number} high\n * @returns {Array}\n * @example range(3, 7); // creates [3, 4, 5, 6, 7]\n */\n\n\nfunction range(low, high) {\n  var results = [];\n\n  for (var j = low; j <= high; j++) {\n    results.push(j);\n  }\n\n  return results;\n}\n/**\n * Returns a new function that is true if value is NOT the same category\n * @param {string} category\n * @returns {function}\n */\n\n\nfunction notCategory(category) {\n  return function (e) {\n    return (category === null || e.category !== category) && category !== 'all';\n  };\n}\n/**\n * Converts a code into an ansi token type\n * @param {number} code\n * @returns {string}\n */\n\n\nfunction categoryForCode(code) {\n  code = parseInt(code, 10);\n  var result = null;\n\n  if (code === 0) {\n    result = 'all';\n  } else if (code === 1) {\n    result = 'bold';\n  } else if (2 < code && code < 5) {\n    result = 'underline';\n  } else if (4 < code && code < 7) {\n    result = 'blink';\n  } else if (code === 8) {\n    result = 'hide';\n  } else if (code === 9) {\n    result = 'strike';\n  } else if (29 < code && code < 38 || code === 39 || 89 < code && code < 98) {\n    result = 'foreground-color';\n  } else if (39 < code && code < 48 || code === 49 || 99 < code && code < 108) {\n    result = 'background-color';\n  }\n\n  return result;\n}\n/**\n * @param {string} text\n * @param {object} options\n * @returns {string}\n */\n\n\nfunction pushText(text, options) {\n  if (options.escapeXML) {\n    return entities.encodeXML(text);\n  }\n\n  return text;\n}\n/**\n * @param {Array} stack\n * @param {string} tag\n * @param {string} [style='']\n * @returns {string}\n */\n\n\nfunction pushTag(stack, tag, style) {\n  if (!style) {\n    style = '';\n  }\n\n  stack.push(tag);\n  return ['<' + tag, style ? ' style=\"' + style + '\"' : void 0, '>'].join('');\n}\n/**\n * @param {Array} stack\n * @param {string} style\n * @returns {string}\n */\n\n\nfunction pushStyle(stack, style) {\n  return pushTag(stack, 'span', style);\n}\n\nfunction pushForegroundColor(stack, color) {\n  return pushTag(stack, 'span', 'color:' + color);\n}\n\nfunction pushBackgroundColor(stack, color) {\n  return pushTag(stack, 'span', 'background-color:' + color);\n}\n/**\n * @param {Array} stack\n * @param {string} style\n * @returns {string}\n */\n\n\nfunction closeTag(stack, style) {\n  var last;\n\n  if (stack.slice(-1)[0] === style) {\n    last = stack.pop();\n  }\n\n  if (last) {\n    return '</' + style + '>';\n  }\n}\n/**\n * @param {string} text\n * @param {object} options\n * @param {function} callback\n * @returns {Array}\n */\n\n\nfunction tokenize(text, options, callback) {\n  var ansiMatch = false;\n  var ansiHandler = 3;\n\n  function remove() {\n    return '';\n  }\n\n  function removeXterm256(m, g1) {\n    callback('xterm256', g1);\n    return '';\n  }\n\n  function newline(m) {\n    if (options.newline) {\n      callback('display', -1);\n    } else {\n      callback('text', m);\n    }\n\n    return '';\n  }\n\n  function ansiMess(m, g1) {\n    ansiMatch = true;\n\n    if (g1.trim().length === 0) {\n      g1 = '0';\n    }\n\n    g1 = g1.trimRight(';').split(';');\n    var _iteratorNormalCompletion2 = true;\n    var _didIteratorError2 = false;\n    var _iteratorError2 = undefined;\n\n    try {\n      for (var _iterator2 = g1[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n        var g = _step2.value;\n        callback('display', g);\n      }\n    } catch (err) {\n      _didIteratorError2 = true;\n      _iteratorError2 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion2 && _iterator2[\"return\"] != null) {\n          _iterator2[\"return\"]();\n        }\n      } finally {\n        if (_didIteratorError2) {\n          throw _iteratorError2;\n        }\n      }\n    }\n\n    return '';\n  }\n\n  function realText(m) {\n    callback('text', m);\n    return '';\n  }\n\n  function rgb(m) {\n    callback('rgb', m);\n    return '';\n  }\n  /* eslint no-control-regex:0 */\n\n\n  var tokens = [{\n    pattern: /^\\x08+/,\n    sub: remove\n  }, {\n    pattern: /^\\x1b\\[[012]?K/,\n    sub: remove\n  }, {\n    pattern: /^\\x1b\\[\\(B/,\n    sub: remove\n  }, {\n    pattern: /^\\x1b\\[[34]8;2;\\d+;\\d+;\\d+m/,\n    sub: rgb\n  }, {\n    pattern: /^\\x1b\\[38;5;(\\d+)m/,\n    sub: removeXterm256\n  }, {\n    pattern: /^\\n/,\n    sub: newline\n  }, {\n    pattern: /^\\r+\\n/,\n    sub: newline\n  }, {\n    pattern: /^\\x1b\\[((?:\\d{1,3};?)+|)m/,\n    sub: ansiMess\n  }, {\n    // CSI n J\n    // ED - Erase in Display Clears part of the screen.\n    // If n is 0 (or missing), clear from cursor to end of screen.\n    // If n is 1, clear from cursor to beginning of the screen.\n    // If n is 2, clear entire screen (and moves cursor to upper left on DOS ANSI.SYS).\n    // If n is 3, clear entire screen and delete all lines saved in the scrollback buffer\n    //   (this feature was added for xterm and is supported by other terminal applications).\n    pattern: /^\\x1b\\[\\d?J/,\n    sub: remove\n  }, {\n    // CSI n ; m f\n    // HVP - Horizontal Vertical Position Same as CUP\n    pattern: /^\\x1b\\[\\d{0,3};\\d{0,3}f/,\n    sub: remove\n  }, {\n    // catch-all for CSI sequences?\n    pattern: /^\\x1b\\[?[\\d;]{0,3}/,\n    sub: remove\n  }, {\n    /**\n     * extracts real text - not containing:\n     * - `\\x1b' - ESC - escape (Ascii 27)\n     * - '\\x08' - BS - backspace (Ascii 8)\n     * - `\\n` - Newline - linefeed (LF) (ascii 10)\n     * - `\\r` - Windows Carriage Return (CR)\n     */\n    pattern: /^(([^\\x1b\\x08\\r\\n])+)/,\n    sub: realText\n  }];\n\n  function process(handler, i) {\n    if (i > ansiHandler && ansiMatch) {\n      return;\n    }\n\n    ansiMatch = false;\n    text = text.replace(handler.pattern, handler.sub);\n  }\n\n  var results1 = [];\n  var _text = text,\n      length = _text.length;\n\n  outer: while (length > 0) {\n    for (var i = 0, o = 0, len = tokens.length; o < len; i = ++o) {\n      var handler = tokens[i];\n      process(handler, i);\n\n      if (text.length !== length) {\n        // We matched a token and removed it from the text. We need to\n        // start matching *all* tokens against the new text.\n        length = text.length;\n        continue outer;\n      }\n    }\n\n    if (text.length === length) {\n      break;\n    }\n\n    results1.push(0);\n    length = text.length;\n  }\n\n  return results1;\n}\n/**\n * If streaming, then the stack is \"sticky\"\n *\n * @param {Array} stickyStack\n * @param {string} token\n * @param {*} data\n * @returns {Array}\n */\n\n\nfunction updateStickyStack(stickyStack, token, data) {\n  if (token !== 'text') {\n    stickyStack = stickyStack.filter(notCategory(categoryForCode(data)));\n    stickyStack.push({\n      token: token,\n      data: data,\n      category: categoryForCode(data)\n    });\n  }\n\n  return stickyStack;\n}\n\nvar Filter =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param {object} options\n   * @param {string=} options.fg The default foreground color used when reset color codes are encountered.\n   * @param {string=} options.bg The default background color used when reset color codes are encountered.\n   * @param {boolean=} options.newline Convert newline characters to `<br/>`.\n   * @param {boolean=} options.escapeXML Generate HTML/XML entities.\n   * @param {boolean=} options.stream Save style state across invocations of `toHtml()`.\n   * @param {(string[] | {[code: number]: string})=} options.colors Can override specific colors or the entire ANSI palette.\n   */\n  function Filter(options) {\n    _classCallCheck(this, Filter);\n\n    options = options || {};\n\n    if (options.colors) {\n      options.colors = Object.assign({}, defaults.colors, options.colors);\n    }\n\n    this.options = Object.assign({}, defaults, options);\n    this.stack = [];\n    this.stickyStack = [];\n  }\n  /**\n   * @param {string | string[]} input\n   * @returns {string}\n   */\n\n\n  _createClass(Filter, [{\n    key: \"toHtml\",\n    value: function toHtml(input) {\n      var _this = this;\n\n      input = typeof input === 'string' ? [input] : input;\n      var stack = this.stack,\n          options = this.options;\n      var buf = [];\n      this.stickyStack.forEach(function (element) {\n        var output = generateOutput(stack, element.token, element.data, options);\n\n        if (output) {\n          buf.push(output);\n        }\n      });\n      tokenize(input.join(''), options, function (token, data) {\n        var output = generateOutput(stack, token, data, options);\n\n        if (output) {\n          buf.push(output);\n        }\n\n        if (options.stream) {\n          _this.stickyStack = updateStickyStack(_this.stickyStack, token, data);\n        }\n      });\n\n      if (stack.length) {\n        buf.push(resetStyles(stack));\n      }\n\n      return buf.join('');\n    }\n  }]);\n\n  return Filter;\n}();\n\nmodule.exports = Filter;","var encode = require(\"./lib/encode.js\"),\n    decode = require(\"./lib/decode.js\");\n\nexports.decode = function(data, level) {\n    return (!level || level <= 0 ? decode.XML : decode.HTML)(data);\n};\n\nexports.decodeStrict = function(data, level) {\n    return (!level || level <= 0 ? decode.XML : decode.HTMLStrict)(data);\n};\n\nexports.encode = function(data, level) {\n    return (!level || level <= 0 ? encode.XML : encode.HTML)(data);\n};\n\nexports.encodeXML = encode.XML;\n\nexports.encodeHTML4 = exports.encodeHTML5 = exports.encodeHTML = encode.HTML;\n\nexports.decodeXML = exports.decodeXMLStrict = decode.XML;\n\nexports.decodeHTML4 = exports.decodeHTML5 = exports.decodeHTML = decode.HTML;\n\nexports.decodeHTML4Strict = exports.decodeHTML5Strict = exports.decodeHTMLStrict = decode.HTMLStrict;\n\nexports.escape = encode.escape;\n","var inverseXML = getInverseObj(require(\"../maps/xml.json\")),\n    xmlReplacer = getInverseReplacer(inverseXML);\n\nexports.XML = getInverse(inverseXML, xmlReplacer);\n\nvar inverseHTML = getInverseObj(require(\"../maps/entities.json\")),\n    htmlReplacer = getInverseReplacer(inverseHTML);\n\nexports.HTML = getInverse(inverseHTML, htmlReplacer);\n\nfunction getInverseObj(obj) {\n    return Object.keys(obj)\n        .sort()\n        .reduce(function(inverse, name) {\n            inverse[obj[name]] = \"&\" + name + \";\";\n            return inverse;\n        }, {});\n}\n\nfunction getInverseReplacer(inverse) {\n    var single = [],\n        multiple = [];\n\n    Object.keys(inverse).forEach(function(k) {\n        if (k.length === 1) {\n            single.push(\"\\\\\" + k);\n        } else {\n            multiple.push(k);\n        }\n    });\n\n    //TODO add ranges\n    multiple.unshift(\"[\" + single.join(\"\") + \"]\");\n\n    return new RegExp(multiple.join(\"|\"), \"g\");\n}\n\nvar re_nonASCII = /[^\\0-\\x7F]/g,\n    re_astralSymbols = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n\nfunction singleCharReplacer(c) {\n    return (\n        \"&#x\" +\n        c\n            .charCodeAt(0)\n            .toString(16)\n            .toUpperCase() +\n        \";\"\n    );\n}\n\nfunction astralReplacer(c) {\n    // http://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n    var high = c.charCodeAt(0);\n    var low = c.charCodeAt(1);\n    var codePoint = (high - 0xd800) * 0x400 + low - 0xdc00 + 0x10000;\n    return \"&#x\" + codePoint.toString(16).toUpperCase() + \";\";\n}\n\nfunction getInverse(inverse, re) {\n    function func(name) {\n        return inverse[name];\n    }\n\n    return function(data) {\n        return data\n            .replace(re, func)\n            .replace(re_astralSymbols, astralReplacer)\n            .replace(re_nonASCII, singleCharReplacer);\n    };\n}\n\nvar re_xmlChars = getInverseReplacer(inverseXML);\n\nfunction escapeXML(data) {\n    return data\n        .replace(re_xmlChars, singleCharReplacer)\n        .replace(re_astralSymbols, astralReplacer)\n        .replace(re_nonASCII, singleCharReplacer);\n}\n\nexports.escape = escapeXML;\n","var entityMap = require(\"../maps/entities.json\"),\n    legacyMap = require(\"../maps/legacy.json\"),\n    xmlMap = require(\"../maps/xml.json\"),\n    decodeCodePoint = require(\"./decode_codepoint.js\");\n\nvar decodeXMLStrict = getStrictDecoder(xmlMap),\n    decodeHTMLStrict = getStrictDecoder(entityMap);\n\nfunction getStrictDecoder(map) {\n    var keys = Object.keys(map).join(\"|\"),\n        replace = getReplacer(map);\n\n    keys += \"|#[xX][\\\\da-fA-F]+|#\\\\d+\";\n\n    var re = new RegExp(\"&(?:\" + keys + \");\", \"g\");\n\n    return function(str) {\n        return String(str).replace(re, replace);\n    };\n}\n\nvar decodeHTML = (function() {\n    var legacy = Object.keys(legacyMap).sort(sorter);\n\n    var keys = Object.keys(entityMap).sort(sorter);\n\n    for (var i = 0, j = 0; i < keys.length; i++) {\n        if (legacy[j] === keys[i]) {\n            keys[i] += \";?\";\n            j++;\n        } else {\n            keys[i] += \";\";\n        }\n    }\n\n    var re = new RegExp(\"&(?:\" + keys.join(\"|\") + \"|#[xX][\\\\da-fA-F]+;?|#\\\\d+;?)\", \"g\"),\n        replace = getReplacer(entityMap);\n\n    function replacer(str) {\n        if (str.substr(-1) !== \";\") str += \";\";\n        return replace(str);\n    }\n\n    //TODO consider creating a merged map\n    return function(str) {\n        return String(str).replace(re, replacer);\n    };\n})();\n\nfunction sorter(a, b) {\n    return a < b ? 1 : -1;\n}\n\nfunction getReplacer(map) {\n    return function replace(str) {\n        if (str.charAt(1) === \"#\") {\n            if (str.charAt(2) === \"X\" || str.charAt(2) === \"x\") {\n                return decodeCodePoint(parseInt(str.substr(3), 16));\n            }\n            return decodeCodePoint(parseInt(str.substr(2), 10));\n        }\n        return map[str.slice(1, -1)];\n    };\n}\n\nmodule.exports = {\n    XML: decodeXMLStrict,\n    HTML: decodeHTML,\n    HTMLStrict: decodeHTMLStrict\n};\n","var decodeMap = require(\"../maps/decode.json\");\n\nmodule.exports = decodeCodePoint;\n\n// modified version of https://github.com/mathiasbynens/he/blob/master/src/he.js#L94-L119\nfunction decodeCodePoint(codePoint) {\n    if ((codePoint >= 0xd800 && codePoint <= 0xdfff) || codePoint > 0x10ffff) {\n        return \"\\uFFFD\";\n    }\n\n    if (codePoint in decodeMap) {\n        codePoint = decodeMap[codePoint];\n    }\n\n    var output = \"\";\n\n    if (codePoint > 0xffff) {\n        codePoint -= 0x10000;\n        output += String.fromCharCode(((codePoint >>> 10) & 0x3ff) | 0xd800);\n        codePoint = 0xdc00 | (codePoint & 0x3ff);\n    }\n\n    output += String.fromCharCode(codePoint);\n    return output;\n}\n","import { emitter } from '@amatiasq/emitter';\nconst DEFAULT_RECONNECTION_DELAY = 100;\nconst MAX_RECONNECT_ATTEMPTS = 14;\nexport class ResilientSocket {\n    constructor(uri, { reconnectionDelay = DEFAULT_RECONNECTION_DELAY, maxReconnectAttempts = MAX_RECONNECT_ATTEMPTS, } = {}) {\n        this.uri = uri;\n        this.reconnectionDelay = DEFAULT_RECONNECTION_DELAY;\n        this.reconnectAttempts = 0;\n        this.disconnectedAt = new Date();\n        this.isReconnecting = false;\n        this.isFirstConnection = true;\n        this.messageQueue = [];\n        this.emitOpen = emitter();\n        this.onOpen = this.emitOpen.subscribe;\n        this.emitError = emitter();\n        this.onError = this.emitError.subscribe;\n        this.emitClose = emitter();\n        this.onClose = this.emitClose.subscribe;\n        this.emitMessage = emitter();\n        this.onMessage = this.emitMessage.subscribe;\n        this.emitReconnect = emitter();\n        this.onReconnect = this.emitReconnect.subscribe;\n        this.connectionOpen = this.connectionOpen.bind(this);\n        this.processMessage = this.processMessage.bind(this);\n        this.connectionLost = this.connectionLost.bind(this);\n        this.ws = this.init();\n        this.RECONNECTION_DELAY = reconnectionDelay;\n        this.MAX_RECONNECT_ATTEMPTS = maxReconnectAttempts;\n    }\n    get isConnected() {\n        return !this.isFirstConnection && !this.isReconnecting;\n    }\n    send(data) {\n        if (this.isConnected)\n            this.ws.send(data);\n        else\n            this.messageQueue.push(data);\n    }\n    init() {\n        const socket = new WebSocket(this.uri);\n        socket.addEventListener('open', this.connectionOpen);\n        socket.addEventListener('message', this.processMessage);\n        socket.addEventListener('error', this.connectionLost);\n        socket.addEventListener('close', this.connectionLost);\n        return socket;\n    }\n    unbind() {\n        this.ws.removeEventListener('open', this.connectionOpen);\n        this.ws.removeEventListener('message', this.processMessage);\n        this.ws.removeEventListener('error', this.connectionLost);\n        this.ws.removeEventListener('close', this.connectionLost);\n    }\n    processMessage(event) {\n        this.emitMessage(event);\n    }\n    connectionOpen(event) {\n        this.resetReconnectionCounters();\n        if (this.isFirstConnection) {\n            this.isFirstConnection = false;\n            this.emitOpen(event);\n        }\n        else {\n            this.emitReconnect(Object.assign(event, { disconnectedTime: this.disconnectedAt }));\n        }\n        this.processMessageQueue();\n    }\n    connectionLost(event) {\n        if (this.isReconnecting) {\n            return;\n        }\n        if (this.reconnectAttempts > this.MAX_RECONNECT_ATTEMPTS) {\n            this.reconnectionFailed(event);\n        }\n        if (this.reconnectAttempts === 0) {\n            this.isReconnecting = true;\n            this.disconnectedAt = new Date();\n        }\n        this.unbind();\n        this.scheduleReconnection();\n    }\n    resetReconnectionCounters() {\n        this.reconnectionDelay = this.RECONNECTION_DELAY;\n        this.reconnectAttempts = 0;\n        this.isReconnecting = false;\n    }\n    processMessageQueue() {\n        for (const message in this.messageQueue) {\n            this.ws.send(message);\n        }\n        this.messageQueue.length = 0;\n    }\n    reconnectionFailed(event) {\n        this.emitError(event);\n        return console.error(`Websocket aborted after ${this.reconnectAttempts} attempts`);\n    }\n    scheduleReconnection() {\n        const message = `Socket closed. Waiting ${this.reconnectionDelay / 1000}s`;\n        const reconnecting = 'Reconnecting...';\n        const singleLine = this.reconnectAttempts < 1000;\n        console.debug(`${message} ${singleLine ? reconnecting : ''}`);\n        setTimeout(() => {\n            if (!singleLine) {\n                console.debug(reconnecting);\n            }\n            this.reconnectionDelay *= 2;\n            this.reconnectAttempts++;\n            this.ws = this.init();\n        }, this.reconnectionDelay);\n    }\n    close() {\n        this.unbind();\n        this.ws.onclose = this.emitClose;\n        this.ws.close();\n    }\n}\n//# sourceMappingURL=ResilientSocket.js.map","export var ICMType;\n(function (ICMType) {\n    ICMType[\"AMQ_CONNECT\"] = \"AMQ_CONNECT\";\n    ICMType[\"AMQ_RECONNECT\"] = \"AMQ_RECONNECT\";\n    ICMType[\"AMQ_DISCONNECT\"] = \"AMQ_DISCONNECT\";\n})(ICMType || (ICMType = {}));\nexport var ISMType;\n(function (ISMType) {\n    ISMType[\"AMQ_CONNECTED\"] = \"AMQ_CONNECTED\";\n})(ISMType || (ISMType = {}));\n//# sourceMappingURL=messaging.js.map","export function parseJson(text) {\n    try {\n        return JSON.parse(text);\n    }\n    catch (error) {\n        console.warn('Invalid JSON:', text);\n        throw error;\n    }\n}\n//# sourceMappingURL=parseJson.js.map","import { emitter, emitterWithChannels } from '@amatiasq/emitter';\nimport { ResilientSocket, } from '@amatiasq/resilient-socket';\nimport { ICMType, ISMType } from './messaging';\nimport { parseJson } from './parseJson';\nexport class ClientSocket {\n    constructor(uri, options = {}) {\n        this.uri = uri;\n        this.typeListeners = emitterWithChannels();\n        this.emitConnected = emitter();\n        this.onConnected = this.emitConnected.subscribe;\n        this.emitMessage = emitter();\n        this.onMessage = this.emitMessage.subscribe;\n        this.socket = new ResilientSocket(uri, options);\n        this.onError = this.socket.onError;\n        this.onClose = this.socket.onClose;\n        this.socket.onOpen((this._open = this._open.bind(this)));\n        this.socket.onReconnect((this._reconnect = this._reconnect.bind(this)));\n        this.socket.onMessage((this._message = this._message.bind(this)));\n    }\n    send(type, data) {\n        this.socket.send(JSON.stringify({ type, data }));\n    }\n    onMessageType(type, listener) {\n        this.typeListeners.subscribe(type, listener);\n    }\n    close() {\n        this._sendInternal(ICMType.AMQ_DISCONNECT, this.clientId);\n    }\n    _open() {\n        this._sendInternal(ICMType.AMQ_CONNECT, undefined);\n    }\n    _reconnect() {\n        if (this.clientId) {\n            this._sendInternal(ICMType.AMQ_RECONNECT, this.clientId);\n        }\n        else {\n            this._sendInternal(ICMType.AMQ_CONNECT, undefined);\n        }\n    }\n    _message(event) {\n        const message = parseJson(event.data);\n        if (message.type in ISMType) {\n            if (message.type === ISMType.AMQ_CONNECTED) {\n                this.clientId = message.data;\n                this.emitConnected(message.data);\n            }\n            return;\n        }\n        this.emitMessage(message);\n        this.typeListeners(message.type, message.data);\n    }\n    _sendInternal(type, data) {\n        this.socket.send(JSON.stringify({ type, data }));\n    }\n}\n//# sourceMappingURL=ClientSocket.js.map","import { emitter, emitterWithChannels } from '@amatiasq/emitter';\nimport { ICMType, ISMType } from './messaging';\nimport { parseJson } from './parseJson';\nexport class ServerSocket {\n    constructor(id) {\n        this.id = id;\n        this.typeListeners = emitterWithChannels();\n        this.emitMessage = emitter();\n        this.onMessage = this.emitMessage.subscribe;\n        this.emitDestroy = emitter();\n        this.onDestroy = this.emitDestroy.subscribe;\n        this._onClose = this._onClose.bind(this);\n        this._onMessage = this._onMessage.bind(this);\n    }\n    bindTo(ws) {\n        this._onClose();\n        this.ws = ws;\n        ws.on('close', this._onClose);\n        ws.on('message', this._onMessage);\n        ws.send(JSON.stringify({\n            type: ISMType.AMQ_CONNECTED,\n            data: this.id,\n        }));\n    }\n    send(type, data) {\n        this.ws.send(JSON.stringify({ type, data }));\n    }\n    onMessageType(type, listener) {\n        this.typeListeners.subscribe(type, listener);\n    }\n    destroy() {\n        this.emitDestroy();\n    }\n    _onMessage(payload) {\n        const msg = parseJson(payload);\n        if (msg.type === ICMType.AMQ_DISCONNECT) {\n            this._onClose();\n            this.destroy();\n            return;\n        }\n        this.emitMessage(msg);\n        this.typeListeners(msg.type, msg.data);\n    }\n    _onClose() {\n        if (this.ws) {\n            this.ws.off('close', this._onClose);\n            this.ws.off('message', this._onMessage);\n            this.ws = null;\n        }\n    }\n}\n//# sourceMappingURL=ServerSocket.js.map","import { ServerSocket } from './ServerSocket';\nexport class ServerClients {\n    constructor() {\n        this.lastId = 0;\n        this.clients = new Map();\n    }\n    get(id) {\n        return this.clients.get(id) || null;\n    }\n    add(id = this.getNextId()) {\n        const client = new ServerSocket(id);\n        this.remove(id);\n        this.clients.set(client.id, client);\n        return client;\n    }\n    remove(id) {\n        if (!this.clients.has(id)) {\n            return false;\n        }\n        const client = this.clients.get(id);\n        this.clients.delete(id);\n        client.destroy();\n        return true;\n    }\n    getNextId() {\n        return ++this.lastId;\n    }\n}\n//# sourceMappingURL=ServerClients.js.map","import { Server as WsServer } from 'ws';\nimport { emitter } from '@amatiasq/emitter';\nimport { ICMType } from './messaging';\nimport { parseJson } from './parseJson';\nimport { ServerClients } from './ServerClients';\nexport class WebSocketServer {\n    constructor(server) {\n        this.clients = new ServerClients();\n        this.emitConnection = emitter();\n        this.onConnection = this.emitConnection.subscribe;\n        this.ws = new WsServer({ server });\n        this.ws.on('connection', (this._onConnection = this._onConnection.bind(this)));\n    }\n    _onConnection(ws) {\n        const self = this;\n        ws.on('close', onClose);\n        ws.on('message', onMessage);\n        function onClose() {\n            ws.off('close', onClose);\n            ws.off('message', onMessage);\n        }\n        function onMessage(payload) {\n            const msg = parseJson(payload);\n            if (msg.type === ICMType.AMQ_CONNECT) {\n                self.onClientConnected(ws);\n            }\n            else if (msg.type === ICMType.AMQ_RECONNECT) {\n                self.onClientRecconect(ws, msg.data);\n            }\n            else {\n                console.error('Unexpected message', msg.type);\n            }\n            onClose();\n        }\n    }\n    onClientConnected(ws) {\n        const client = this.clients.add();\n        client.bindTo(ws);\n        this.emitConnection(client);\n    }\n    onClientRecconect(ws, id) {\n        const client = this.clients.get(id) || this.clients.add(id);\n        client.bindTo(ws);\n    }\n}\n//# sourceMappingURL=WebSocketServer.js.map"],"sourceRoot":""}
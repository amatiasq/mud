!function(e){function n(n){for(var t,i,s=n[0],l=n[1],c=n[2],d=0,m=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&m.push(o[i][0]),o[i]=0;for(t in l)Object.prototype.hasOwnProperty.call(l,t)&&(e[t]=l[t]);for(u&&u(n);m.length;)m.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,n=0;n<r.length;n++){for(var a=r[n],t=!0,s=1;s<a.length;s++){var l=a[s];0!==o[l]&&(t=!1)}t&&(r.splice(n--,1),e=i(i.s=a[0]))}return e}var t={},o={0:0},r=[];function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,n,a){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var t in e)i.d(a,t,function(n){return e[n]}.bind(null,t));return a},i.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=n,s=s.slice();for(var c=0;c<s.length;c++)n(s[c]);var u=l;r.push([25,1]),a()}([function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.concatRegexesUnescaped=n.concatRegexes=void 0;const t=e=>(...n)=>{const a=n.map(n=>n instanceof RegExp?n.toString().replace(/^\/|\/[gi]*$/g,""):e(n)).join(""),t=n.map(e=>e instanceof RegExp&&e.flags).filter(Boolean).join(""),o=[...new Set(t)].join("");return new RegExp(a,o)};function o(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\n/g,"\\n")}n.concatRegexes=t(o),n.concatRegexesUnescaped=t(String)},,,,,,function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.wait=void 0,n.wait=function(e){return new Promise(n=>setTimeout(n,1e3*e))}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.int=n.toInt=void 0;const t=a(0),o=/-?\d+(?:,\d{3})*/;n.toInt=function(e){return parseInt(e.replace(/,/g,""),10)},n.int=function(e){return e?t.concatRegexesUnescaped(`(?<${e}>`,o,")"):o}},function(e,n,a){"use strict";var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getSpell=n.getSpells=n.SPELL_LEARN_ORDER=n.SPELLS_BY_TYPE=n.SPELL_NOT_POSSIBLE=n.SPELL_ALREADY_APPLIED=n.SPELL_FAILED=n.weaponList=n.spellList=n.skillList=n.languageList=void 0;const o=a(0),r=a(7),i=t(a(34));n.languageList=i.default.filter(e=>"Idioma"===e.type),n.skillList=i.default.filter(e=>"Habilidad"===e.type),n.spellList=i.default.filter(e=>"Hechizo"===e.type),n.weaponList=i.default.filter(e=>"Arma"===e.type);const s=e=>o.concatRegexes(/Hechizo  : '/,e,/'  durante /,r.int("asaltos"),/ asaltos./),l=e=>n=>o.concatRegexes(/Hechizo  : '/,n,/' Afecta /,e,/ en /,r.int("cantidad"),/ durante /,r.int("asaltos"),/ asaltos./),c={armadura:{success:"Tu armadura brilla suavemente al ser mejorada por un conjuro.",target:/La armadura de (?<target>(?:\w+ )+)brilla suavemente al ser mejorada por un conjuro\./,end:"Tu armadura vuelve a su valor normal.",effect:l("armor class")},bendecir:{success:"Tu dios te otorga una poderosa bendicion.",end:"La bendicion desaparece.",effect:l("hit roll")},"causar critica":{target:/Tu conjuro [^\n]+ a(?<target>(?: \w+)+)!/},"causar grave":{target:/Tu conjuro [^\n]+ a(?<target>(?: \w+)+)!/},"causar leve":{target:/Tu conjuro [^\n]+ a(?<target>(?: \w+)+)!/},ceguera:{target:/Lanzas un conjuro de ceguera contra (?<target>[^.]+)./},"crear agua":{target:" esta lleno.\n"},"crear comida":{success:"Una seta magica aparece de repente."},"crear fuego":{success:"Una gran hoguera se enciende en el suelo delante tuyo."},"crear manantial":{success:"Trazas un circulo delante tuyo del cual emerge un manantial de agua cristalina.",end:"Un manantial magico se seca."},"curar criticas":{success:"Tus heridas mas graves se cierran y el dolor desaparece.",target:/Curas las heridas mas graves de (?<target>[^\.]+)\./},"curar graves":{success:"Tus heridas graves se cierran y el dolor desaparece.",target:/Curas las heridas graves de (?<target>[^\.]+)\./},"curar leves":{success:"Tus heridas leves se cierran y el dolor desaparece.",target:/Curas las heridas leves de (?<target>[^\.]+)\./},"detectar escondido":{success:"Tus sentidos cobran la viveza de los del mejor predador.",end:"Te sientes menos consciente de lo que te rodea.",effect:s},"detectar invisible":{success:"Tus ojos brillan, siendo capaces ahora de ver lo invisible.",end:"Ya no ves objetos invisibles.",effect:s},"detectar magia":{success:"Delgadas lineas azules reseguiran las siluetas de los objetos magicos que te encuentres.",end:"Las lineas azules desaparecen de tu vision",effect:s},"detectar maldad":{success:"Delgadas lineas rojas reseguiran las siluetas de los seres malvados que te encuentres.",effect:s,end:"Las lineas rojas desaparecen de tu vision."},"detectar trampas":{success:"De repente te sientes mas alerta de los peligros que te rodean.",end:"Te sientes menos alerta de los peligros que te rodean.",effect:s},flotar:{success:"Empiezas a flotar a unos centimetros del suelo...",target:/\n(?<target>[^\n]+) empieza a flotar a unos centimetros del suelo\.\.\./,end:"Tus pies aterrizan suavemente en el suelo."},identificar:{target:/El objeto '(?<name>[^']+)' es un\(a\) (?<type>\w+), propiedades especiales: (?<properties>[^\n]+)\n/},invisibilidad:{success:"Te desvaneces en el aire.",target:/\n(?<target>[^\n]+) se desvanece en el aire./,end:"Ya no eres invisible.",effect:s},"invocar armadillo":{success:"Agitas tus brazos a la vez que te concentras para invocar un pequenyo armadillo."},"luz eterna":{success:"Rayos de luz iridiscente colisionan para formar una bola de luz eterna..."},"piel robliza":{success:"Tu piel se oscurece a la vez que adquiere la dureza del roble.",end:"Tu piel vuelve a su estado normal...",effect:l("armor class")},refrescar:{success:"Nueva vitalidad fluye hacia ti."},"respiracion acuatica":{success:"Tus pulmones ahora son capaces de respirar bajo agua...",target:/Los pulmones de (?<target>[^\n]+) ahora son capaces de respirar bajo agua\.\.\./,end:"Tus pulmones vuelven a su estado original.",effect:s},terremoto:{success:"La tierra tiembla bajo tus pies!"},veneno:{success:/\n(?<target>[^\n]+)cobra un aspecto enfermizo cuando tu veneno se esparce por su cuerpo./},"vista distancia":{success:"Tienes una vision reveladora...",target:/Los ojos de (?<target>[^\n]+) parecen estar mirando un lugar lejano\.\.\./,effect:s},volar:{success:"Te elevas entre las corrientes de aire...",target:/\n(?<target>[^\n]+) se eleva entre las corrientes de aire.../,end:"Aterrizas suavemente en el suelo.",effect:s}},u=n.spellList.map(e=>({...e,...c[e.name]||{}}));n.SPELL_FAILED=["Algo te distrae y pierdes la concentracion.","Has perdido la concentracion.","Has tenido una laguna mental mientras invocabas el hechizo.","Pierdes la concentracion.","Un picor en la nariz te impide mantener la concentracion.","Un pinchazo en tu pierna te impide lanzar el conjuro adecuadamente.","Una mota de polvo en el ojo rompe tu concentracion por un momento."],n.SPELL_ALREADY_APPLIED=["Has fallado.","Eso no parece tener ningun efecto."],n.SPELL_NOT_POSSIBLE=["No esta aqui.","No tienes suficiente mana.","Sobre que quieres lanzar este conjuro?","No puedes encontrar ningun ","Este estilo de lucha pide demasiado atencion para hacer eso!","Este asalto del combate es demasiado febril para concentrarte adecuadamente.","No has tenido suficiente tiempo en este asalto para completar el conjuro.","Estas demasiado malherido para hacer eso.","Estas demasiado aturdido para hacer eso."],n.SPELLS_BY_TYPE={food:["crear baya","crear comida"],water:["crear manantial","crear agua"],levitate:["volar","flotar"],heal:["curar criticas","curar graves","curar leves"],attack:["terremoto","causar critica","causar grave","causar leve"],massAttack:["terremoto"],dedope:["ceguera","veneno"]},n.SPELL_LEARN_ORDER=[n.SPELLS_BY_TYPE.food,n.SPELLS_BY_TYPE.water,n.SPELLS_BY_TYPE.dedope,"luz eterna","invisibilidad","invocar armadillo","armadura","bendecir","detectar escondido","detectar invisible","detectar magia",n.SPELLS_BY_TYPE.levitate,"curar ceguera",n.SPELLS_BY_TYPE.heal,"refrescar",n.SPELLS_BY_TYPE.attack,"crear fuego"],n.getSpells=function(){return u},n.getSpell=function(e){const a=e.toLowerCase(),t=n.spellList.find(e=>e.name.startsWith(a));if(!t)throw new Error("Unknown spell "+e);const o=t&&c[t.name];return o?{...t,...o,effect:"function"==typeof o.effect?o.effect(t.name):o.effect}:t}},function(e,n,a){"use strict";function t(e){return e.cloneNode(!0)}Object.defineProperty(n,"__esModule",{value:!0}),n.render=void 0,n.render=function(e,n){"string"==typeof e&&(e=function(e){const n=document.createElement("template");return n.innerHTML=e,n}(e));const a=e instanceof HTMLTemplateElement?t(e.content):t(e);if(n)for(const[e,t]of Object.entries(n)){const n=a.querySelector(e);n?t(n):console.error(`Selector ${e} returned no results`)}return Object.assign(a,{$:e=>a.querySelector(e)})}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getMobIn=n.getMobFromPresence=n.getMobsPresence=n.MOB_LEAVES=n.MOB_ARRIVES=n.ATTACK_RECEIVED=void 0;const t=a(0),o=/(?:un|una|el|la|los|las|unos|unas)/,r=/(?<mob>(?: |\w|-)+)/,i=["armadillo","lince"],s=Object.entries({Kivon:"Kivon, el líder del culto, no está nada contento con intromisiones.",Nejane:"Nejane, la líder, parece estar en trance.",adorador:["Un adorador mira con cólera a su alrededor.","Un devoto adorador mira con cólera a su alrededor."],aguila:["Una enorme aguila esta aqui profundamente dormido.","Una gigantesca aguila vuela a tu alrededor."],buitre:"Un buitre carronyero esta aqui.",calamar:"Un calamar gigante esta aqui nadando.",caracol:"Un pequenyo caracol esta aqui haciendo trompos.",ciervo:null,conejo:null,criatura:["Una poderosa criatura del pantano esta aqui profundamente dormido."],cubo:"Un enorme cubo transparente de materia gelatinosa rezuma ante ti.",cultista:["Una joven cultista parece bastante serena, mientras no vea a nadie m"],dragon:null,empleado:null,espiritu:"Un espíritu se desliza por el aire.",esqueleto:["El esqueleto hace castanyetear sus dientes amenazadoramente y se acerca!","Un esqueleto con armadura avanza torpemente a traves de los arboles.","Un esqueleto huesudo esta aqui profundamente dormido.","Un esqueleto polvoriento esta aqui."],fanatico:"Un humano poseído por el fanatismo busca 'herejes'.",gusano:["Un gusano de roca esta aqui profundamente dormido.",/Un monstruoso gusano de hielo excava a traves del hielo y la nieve aqui\. Se yergue y\s+ataca!/],hobgoblin:["un guardia hobgoblin de elite esta aqui profundamente dormido.","Un hobgoblin armado esta aqui, interrogando a un prisionero.","Un macizo hobgoblin esta de guardia cerca del hueco de la escalera.","Un guardian de la montaña esta aquí, echando espuma por la boca."],gnoll:"un gnoll feo esta aqui profundamente dormido.",goblin:["un goblin negrero esta aqui profundamente dormido.","Un habitante del bosque merodea por aqui, protegiendo su montanya.","Un macizo chaman goblin esta aqui rugiendo a sus lacayos."],guardia:"Un Guardia Real está aquí velando por la seguridad del estadio",guerrero:"Un guerrero asqueroso grunye al verte.",jefe:["Un jefe esta aqui descansando.","Un jefe orco esta aqui mirandote desconfiado.","Un macizo chaman goblin esta aqui rugiendo a sus lacayos."],ladron:"Un ladron esta aqui profundamente dormido.",lobo:["Un gran lobo negro, te muestra los colmillos hambriento.","Un lobo feroz esta aqui y grunye muy enojado.","Un lobo hambriento te esta mirando"],mago:"Un mago viejo esta aqui profundamente dormido.",merodeador:null,murcielago:null,ogro:["el capitan ogro esta aqui profundamente dormido.","Un gigantesco ogro juega con una enorme roca lanzandola al aire."],orco:["El arquero orco esta aqui profundamente dormido.","El capitan orco te observa con sus ojos llenos de furia.","El chaman esta sentado detras de un escritorio, escribiendo una misiva.","El desagradable y malioliente espadachin orco esta aqui.","el jefe orco minero esta aqui profundamente dormido.","El orco espadachin llega desde el este.","Un asqueroso arquero orco esta aqui.","Un corpulento orco esta aqui de guardia.","Un jefe orco esta aqui profundamente dormido.","Un orco esta de pie al lado de la ballesta.","Un orco fuera de servicio esta sentado aqui jugando a las cartas.","Un orco fuera de servicio esta sentado aqui jugando a los dados.","un orco minero esta aqui profundamente dormido.","Un pequenyo orco se sienta en una de las sillas roncando.","Un sargento orco mantiene vigilada la chusma a la que comanda.","Un voluminoso cocinero orco sopesa un cuchillo de carnicero manchado de sangre.",/El orco espadachin esta aqui profundamente dormido\./i],pantera:null,piranya:["Una piranya te mira con su enorme boca.",/Una piranya esta aqui profundamente dormido\./i],rata:"Una rata gigante esta aqui profundamente dormido.",sapo:"un sapo gigante esta aqui profundamente dormido.",serpiente:"Una serpiente que parece venenosa te mira fijamente.","uruk-hai":["Un asqueroso arquero uruk-hai tensa su arco al verte.","Un superior uruk-hai esta aqui vigilando."],zombie:"Un zombie se acerca hacia ti con los brazos extendidos."}).map(([e,n])=>({name:e,presence:n}));n.ATTACK_RECEIVED=[t.concatRegexes(/El \w+ de /,o,/ /,r,/ te /),/Tu ataque \w+ a un (?<mob>ladron)./],n.MOB_ARRIVES=t.concatRegexes(o,/ /,r,/ llega desde el (?<direction>\w+)/),n.MOB_LEAVES=t.concatRegexes(o,/ /,r,/ (?:se va)|(?:vuela) hacia (?:el )?(?<direction>\w+)/),n.getMobsPresence=function(){return s.map(e=>e.presence).flat().filter(Boolean)},n.getMobFromPresence=function(e){return s.filter(e=>e.presence).find(({presence:n})=>Array.isArray(n)?e.some(e=>n.includes(e)):e.includes(n))},n.getMobIn=function(e){const n=e.toLowerCase();if(i.some(e=>n.includes(e)))return null;const a=s.find(e=>n.includes(e.name));return a||console.warn(`Unknown sustantive for "${e}"`),a}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getItemSustantive=n.ITEM_SUSTANTIVES=n.UNWEAR=n.WEAR=n.ITEM_ARTICLE=void 0;const t=a(0);n.ITEM_ARTICLE=/(?: (?:un|una|el|la|los|las|unos|unas))?/,n.WEAR=["Te colocas ","Te pones ","Metes las piernas ","Vistes "],n.UNWEAR=t.concatRegexes(/Dejas de usar/,n.ITEM_ARTICLE,/ (?<item>[^.]+?)\./),n.ITEM_SUSTANTIVES=["amuleto","anillo","anteojos","armadura","baculo","baston","bola","botas","brazal","brazalete","brazaletes","brigandina","capa","capote","casco","cetro","cinto","coderas","colgante","collar","coraza","cota","cubrepiernas","daga","escudo","espada","faja","faldones","grebas","guanteletes","guantes","hacha","lanza","luz","mangas","manoplas","martillo","maza","mocasines","pendiente","perneras","peto","pica","placa","polainas","pulsera","ropaje","sentido","sombrero","tobillera","vara","varita","visera","yelmo"],n.getItemSustantive=function(e){const a=e.toLowerCase(),t=n.ITEM_SUSTANTIVES.find(e=>a.includes(e));return t||(console.warn("Unknown item sustantive:",e),null)}},function(e,n,a){"use strict";var t=a(2),o=a.n(t),r=a(3),i=a.n(r)()(o.a);i.push([e.i,"body {\n  --background-color: #1c1c1c;\n  --border-color: #484848;\n  --color: white;\n  background-color: black;\n  color: white;\n}\n\n.container {\n  height: 100%;\n  display: grid;\n  grid-template-rows: 1fr;\n  grid-template-columns: 1fr;\n  grid-template-areas: 'terminal';\n}\n\n.container.show-controls {\n  grid-template-rows: 50px auto;\n  grid-template-columns: 9fr 3fr;\n  grid-template-areas:\n    'controls sidebar'\n    'terminal sidebar';\n}\n\n.terminal {\n  grid-area: terminal;\n}\n\n.sidebar {\n  grid-area: sidebar;\n  background-color: var(--background-color);\n  border-left: 1px solid var(--border-color);\n}\n\n.controls {\n  grid-area: controls;\n  background-color: var(--background-color);\n  border-bottom: 1px solid var(--border-color);\n}\n\n.container:not(.show-controls) .sidebar,\n.container:not(.show-controls) .controls {\n  display: none;\n}\n","",{version:3,sources:["webpack://src/ui/index.css"],names:[],mappings:"AAAA;EACE,2BAA2B;EAC3B,uBAAuB;EACvB,cAAc;EACd,uBAAuB;EACvB,YAAY;AACd;;AAEA;EACE,YAAY;EACZ,aAAa;EACb,uBAAuB;EACvB,0BAA0B;EAC1B,+BAA+B;AACjC;;AAEA;EACE,6BAA6B;EAC7B,8BAA8B;EAC9B;;sBAEoB;AACtB;;AAEA;EACE,mBAAmB;AACrB;;AAEA;EACE,kBAAkB;EAClB,yCAAyC;EACzC,0CAA0C;AAC5C;;AAEA;EACE,mBAAmB;EACnB,yCAAyC;EACzC,4CAA4C;AAC9C;;AAEA;;EAEE,aAAa;AACf",sourcesContent:["body {\n  --background-color: #1c1c1c;\n  --border-color: #484848;\n  --color: white;\n  background-color: black;\n  color: white;\n}\n\n.container {\n  height: 100%;\n  display: grid;\n  grid-template-rows: 1fr;\n  grid-template-columns: 1fr;\n  grid-template-areas: 'terminal';\n}\n\n.container.show-controls {\n  grid-template-rows: 50px auto;\n  grid-template-columns: 9fr 3fr;\n  grid-template-areas:\n    'controls sidebar'\n    'terminal sidebar';\n}\n\n.terminal {\n  grid-area: terminal;\n}\n\n.sidebar {\n  grid-area: sidebar;\n  background-color: var(--background-color);\n  border-left: 1px solid var(--border-color);\n}\n\n.controls {\n  grid-area: controls;\n  background-color: var(--background-color);\n  border-bottom: 1px solid var(--border-color);\n}\n\n.container:not(.show-controls) .sidebar,\n.container:not(.show-controls) .controls {\n  display: none;\n}\n"],sourceRoot:""}]),n.a=i},function(e,n,a){"use strict";var t=a(2),o=a.n(t),r=a(3),i=a.n(r)()(o.a);i.push([e.i,".controls {\n  display: flex;\n  align-items: stretch;\n}\n\n.controls .meter {\n  width: 100px;\n  margin: 8px;\n  margin-right: 0;\n  border: 1px solid var(--border-color);\n  --color: white;\n  --value: 100%;\n}\n\n.controls .meter .bar {\n  height: 100%;\n  width: var(--value);\n  background-color: var(--color);\n}\n","",{version:3,sources:["webpack://src/ui/Controls/Controls.css"],names:[],mappings:"AAAA;EACE,aAAa;EACb,oBAAoB;AACtB;;AAEA;EACE,YAAY;EACZ,WAAW;EACX,eAAe;EACf,qCAAqC;EACrC,cAAc;EACd,aAAa;AACf;;AAEA;EACE,YAAY;EACZ,mBAAmB;EACnB,8BAA8B;AAChC",sourcesContent:[".controls {\n  display: flex;\n  align-items: stretch;\n}\n\n.controls .meter {\n  width: 100px;\n  margin: 8px;\n  margin-right: 0;\n  border: 1px solid var(--border-color);\n  --color: white;\n  --value: 100%;\n}\n\n.controls .meter .bar {\n  height: 100%;\n  width: var(--value);\n  background-color: var(--color);\n}\n"],sourceRoot:""}]),n.a=i},function(e,n,a){"use strict";var t=a(2),o=a.n(t),r=a(3),i=a.n(r)()(o.a);i.push([e.i,".hamburger {\n  display: inline-block;\n  position: absolute;\n  top: 24px;\n  right: 40px;\n  z-index: 1;\n  -webkit-user-select: none;\n  user-select: none;\n}\n\n.hamburger input {\n  display: block;\n  width: 40px;\n  height: 32px;\n  position: absolute;\n  top: -7px;\n  left: -5px;\n  cursor: pointer;\n  opacity: 0; /* hide this */\n  z-index: 2; /* and place it over the hamburger */\n  -webkit-touch-callout: none;\n}\n\n.hamburger span {\n  display: block;\n  width: 33px;\n  height: 4px;\n  margin-bottom: 5px;\n  position: relative;\n  background: #cdcdcd;\n  border-radius: 3px;\n  z-index: 1;\n  transform-origin: center right;\n  transition: transform 0.5s cubic-bezier(0.77, 0.2, 0.05, 1),\n    background 0.5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity 0.55s ease;\n}\n\n/*\n * Transform all the slices of hamburger\n * into a crossmark.\n */\n.hamburger input:checked ~ span:nth-of-type(2) {\n  opacity: 0;\n  transform: rotate(0deg) scale(0.2, 0.2);\n}\n\n.hamburger input:checked ~ span:first-of-type {\n  transform: rotate(-45deg) translate(0, -4px);\n}\n\n.hamburger input:checked ~ span:last-of-type {\n  transform: rotate(45deg) translate(0, 4px);\n}\n","",{version:3,sources:["webpack://src/ui/Hamburger/Hamburger.css"],names:[],mappings:"AAAA;EACE,qBAAqB;EACrB,kBAAkB;EAClB,SAAS;EACT,WAAW;EACX,UAAU;EACV,yBAAyB;EACzB,iBAAiB;AACnB;;AAEA;EACE,cAAc;EACd,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,SAAS;EACT,UAAU;EACV,eAAe;EACf,UAAU,EAAE,cAAc;EAC1B,UAAU,EAAE,oCAAoC;EAChD,2BAA2B;AAC7B;;AAEA;EACE,cAAc;EACd,WAAW;EACX,WAAW;EACX,kBAAkB;EAClB,kBAAkB;EAClB,mBAAmB;EACnB,kBAAkB;EAClB,UAAU;EACV,8BAA8B;EAC9B;wEACsE;AACxE;;AAEA;;;EAGE;AACF;EACE,UAAU;EACV,uCAAuC;AACzC;;AAEA;EACE,4CAA4C;AAC9C;;AAEA;EACE,0CAA0C;AAC5C",sourcesContent:[".hamburger {\n  display: inline-block;\n  position: absolute;\n  top: 24px;\n  right: 40px;\n  z-index: 1;\n  -webkit-user-select: none;\n  user-select: none;\n}\n\n.hamburger input {\n  display: block;\n  width: 40px;\n  height: 32px;\n  position: absolute;\n  top: -7px;\n  left: -5px;\n  cursor: pointer;\n  opacity: 0; /* hide this */\n  z-index: 2; /* and place it over the hamburger */\n  -webkit-touch-callout: none;\n}\n\n.hamburger span {\n  display: block;\n  width: 33px;\n  height: 4px;\n  margin-bottom: 5px;\n  position: relative;\n  background: #cdcdcd;\n  border-radius: 3px;\n  z-index: 1;\n  transform-origin: center right;\n  transition: transform 0.5s cubic-bezier(0.77, 0.2, 0.05, 1),\n    background 0.5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity 0.55s ease;\n}\n\n/*\n * Transform all the slices of hamburger\n * into a crossmark.\n */\n.hamburger input:checked ~ span:nth-of-type(2) {\n  opacity: 0;\n  transform: rotate(0deg) scale(0.2, 0.2);\n}\n\n.hamburger input:checked ~ span:first-of-type {\n  transform: rotate(-45deg) translate(0, -4px);\n}\n\n.hamburger input:checked ~ span:last-of-type {\n  transform: rotate(45deg) translate(0, 4px);\n}\n"],sourceRoot:""}]),n.a=i},function(e,n,a){"use strict";var t=a(2),o=a.n(t),r=a(3),i=a.n(r)()(o.a);i.push([e.i,".sidebar {\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n}\n\n.sidebar .workflow-list {\n  list-style: none;\n  padding: 0;\n}\n\n.workflow {\n  border-bottom: 1px solid var(--border-color);\n}\n.workflow.running {\n  color: gray;\n}\n\n.workflow header {\n  display: flex;\n  align-items: center;\n  padding: 1rem;\n}\n\n.workflow .name {\n  flex: 1;\n  margin: 0 1rem;\n  font-size: 2rem;\n  font-family: monospace;\n  text-transform: uppercase;\n  font-weight: normal;\n}\n\n.workflow .runner {\n  /* appearance: none;\n  background-color: var(--border-color);\n  border: none;\n  padding: 3px;\n  color: var(--color); */\n  text-transform: uppercase;\n  font-size: 1rem;\n}\n\n.workflow:not(.expanded) .triggers {\n  display: none;\n}\n","",{version:3,sources:["webpack://src/ui/Sidebar/Sidebar.css"],names:[],mappings:"AAAA;EACE,aAAa;EACb,sBAAsB;EACtB,oBAAoB;AACtB;;AAEA;EACE,gBAAgB;EAChB,UAAU;AACZ;;AAEA;EACE,4CAA4C;AAC9C;AACA;EACE,WAAW;AACb;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,aAAa;AACf;;AAEA;EACE,OAAO;EACP,cAAc;EACd,eAAe;EACf,sBAAsB;EACtB,yBAAyB;EACzB,mBAAmB;AACrB;;AAEA;EACE;;;;wBAIsB;EACtB,yBAAyB;EACzB,eAAe;AACjB;;AAEA;EACE,aAAa;AACf",sourcesContent:[".sidebar {\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n}\n\n.sidebar .workflow-list {\n  list-style: none;\n  padding: 0;\n}\n\n.workflow {\n  border-bottom: 1px solid var(--border-color);\n}\n.workflow.running {\n  color: gray;\n}\n\n.workflow header {\n  display: flex;\n  align-items: center;\n  padding: 1rem;\n}\n\n.workflow .name {\n  flex: 1;\n  margin: 0 1rem;\n  font-size: 2rem;\n  font-family: monospace;\n  text-transform: uppercase;\n  font-weight: normal;\n}\n\n.workflow .runner {\n  /* appearance: none;\n  background-color: var(--border-color);\n  border: none;\n  padding: 3px;\n  color: var(--color); */\n  text-transform: uppercase;\n  font-size: 1rem;\n}\n\n.workflow:not(.expanded) .triggers {\n  display: none;\n}\n"],sourceRoot:""}]),n.a=i},function(e,n,a){"use strict";var t=a(2),o=a.n(t),r=a(3),i=a.n(r)()(o.a);i.push([e.i,".terminal {\n  grid-area: terminal;\n  overflow-x: hidden;\n  overflow-y: auto;\n  -ms-overflow-style: none; /* IE and Edge */\n  scrollbar-width: none; /* Firefox */\n}\n\n.terminal::-webkit-scrollbar {\n  display: none;\n}\n\n.terminal p {\n  margin: 1em 0;\n}\n\n.terminal input {\n  background-color: transparent;\n  border: none;\n  color: white;\n  display: inline-block;\n  font-family: monospace;\n  outline: none;\n}\n","",{version:3,sources:["webpack://src/ui/Terminal/Terminal.css"],names:[],mappings:"AAAA;EACE,mBAAmB;EACnB,kBAAkB;EAClB,gBAAgB;EAChB,wBAAwB,EAAE,gBAAgB;EAC1C,qBAAqB,EAAE,YAAY;AACrC;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,6BAA6B;EAC7B,YAAY;EACZ,YAAY;EACZ,qBAAqB;EACrB,sBAAsB;EACtB,aAAa;AACf",sourcesContent:[".terminal {\n  grid-area: terminal;\n  overflow-x: hidden;\n  overflow-y: auto;\n  -ms-overflow-style: none; /* IE and Edge */\n  scrollbar-width: none; /* Firefox */\n}\n\n.terminal::-webkit-scrollbar {\n  display: none;\n}\n\n.terminal p {\n  margin: 1em 0;\n}\n\n.terminal input {\n  background-color: transparent;\n  border: none;\n  color: white;\n  display: inline-block;\n  font-family: monospace;\n  outline: none;\n}\n"],sourceRoot:""}]),n.a=i},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.singleExecution=void 0,n.singleExecution=function(e){let n=null;return()=>n||(n=e().then(e=>(n=null,e)),n)}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PatternPromise=void 0;const t=a(6);n.PatternPromise=class extends Promise{constructor(e){let n;super((a,t)=>{n=t,e(a,t)}),this.forceReject=n}timeout(e){return super.catch(()=>{}),t.wait(e).then(()=>this.forceReject(new Error("Timeout: "+e))),this}wait(e){return Promise.race([this,t.wait(e)])}unsubscribe(){this.forceReject("aborted")}once(){return this}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.promptPlugin=n.PROMPT_DETECTOR=void 0;const t=a(4),o=a(0),r=a(7),i=["&W<","&R%h/%Hhp ","&C%m/%Mm ","&G%v/%Vmv ","&P%Xxp ","&Y%gg ","&W&0%d","&W> ","&W%A ","\n"].join(""),s=i.replace("&W>"," &R%E&W>"),l=e=>o.concatRegexes(r.int(e+"Curr"),"/",r.int(e+"Total"),e+" ");n.PROMPT_DETECTOR=o.concatRegexes(/</,l("hp"),l("m"),l("mv"),r.int("exp"),/xp /,r.int("gold"),/g /,r.int("favor"),/( \((?<enemy>\d+)%\))?/,/> (?<invis>I)?/);class c{constructor(){this.total=0,this.current=0}get percent(){const e=this.total?1/this.total*this.current:0;return Math.round(100*e)/100}}n.promptPlugin=async function({when:e,write:a}){let o=!1;const l={hp:new c,mana:new c,mv:new c,exp:0,gold:0,enemy:null,get isFighting(){return null!==l.enemy}},u=t.emitter();return e(n.PROMPT_DETECTOR).timeout(1).catch((function(){a("prompt "+i),a("fprompt "+s)})).finally(()=>{e(n.PROMPT_DETECTOR,({groups:e})=>{l.hp.current=r.toInt(e.hpCurr),l.hp.total=r.toInt(e.hpTotal),l.mana.current=r.toInt(e.mCurr),l.mana.total=r.toInt(e.mTotal),l.mv.current=r.toInt(e.mvCurr),l.mv.total=r.toInt(e.mvTotal),l.exp=r.toInt(e.exp),l.gold=r.toInt(e.gold),l.enemy=e.enemy?r.toInt(e.enemy):null,o=Boolean(e.invis),u(l)})}),{getPercent:function(e){return l[e].percent},until:d,whenFresh:function(){return d(e=>(console.log(e.hp.percent,e.mana.percent,e.mv.percent,1===e.hp.percent&&1===e.mana.percent&&1===e.mv.percent),1===e.hp.percent&&1===e.mana.percent&&1===e.mv.percent))},onUpdate:u.subscribe,get isFighting(){return l.isFighting},get isInvisible(){return o}};function d(a){return a?!!a(l)||new Promise(e=>{const n=u.subscribe(t=>{a(t)&&(n(),e(t))})}):e(n.PROMPT_DETECTOR)}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PluginContext=void 0;const t=a(21),o=a(6);class r{constructor(e,n,a,o){this.name=e,this.username=n,this.triggers=a,this.send=o,this.subscriptions=[],this.isPrintingLogs=!1,this.isAborted=!1,t.bindAll(this,r)}get printLogs(){return this.isPrintingLogs=!0,null}write(e,n){this.checkNotAborted(),this.log("[WRITE]",e),this.send(e,n)}when(e,n,a){this.checkNotAborted(),this.log("[WATCH]",e,a);const t=this.isPrintingLogs?({patterns:e,...n})=>this.log("[TRIGGERED]",...e,n):null;if("function"==typeof n){if(t){const e=n;n=n=>{t(n),e(n)}}const o=this.triggers.add(e,n,a);return this.subscriptions.push(o),o}a=n;const o=this.triggers.add(e,a);return t&&o.then(t),this.subscriptions.push(o),o}sleep(e){return this.checkNotAborted(),this.log("[SLEEP]",e),o.wait(e)}abort(){this.isAborted=!0}dispose(){this.log("DISPOSE"),this.subscriptions.forEach(e=>e.unsubscribe())}log(...e){this.checkNotAborted(),this.isPrintingLogs&&console.log(`[${this.name}]`,...e)}checkNotAborted(){if(this.isAborted)throw new Error(`[${this.name}] Workflow aborted.`)}}n.PluginContext=r},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bindAll=void 0,n.bindAll=function(e,n){const a=n.prototype;Object.getOwnPropertyNames(a).filter(e=>"function"==typeof Object.getOwnPropertyDescriptor(a,e).value).forEach(n=>{e[n]=e[n].bind(e)})}},function(e,n,a){"use strict";var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getAreaMetadata=n.getAreasForLevel=void 0;const o=t(a(61)),r={"Academia de Darkhaven":["Xse","Xne","Xse","Xne","Xs"],"El Gran Estadio":"j","El Imperio Orco":["4ne2wen","dse2wese2wese2wese2weXnu","uXs","une2wene2weXs","une2wene2wenXsejk2whlen","u3ne2we2nXs","Xnu2se2we2ndXs","une2wene2wene2wene2weXs","une2wene2weXs","uns","une2wene2we2n","u"],"El Pantano Orco":["wn2w","n3esje4n4sw","4nw3sw3nw3sw3nd","3es3w3es3w"],"La Mansion de Marmol":["e2n","n2d",["3n3s","3e3w","3w3e","3s3n","2us"].join(""),"2e2w","4w4e","2unu"],"La tumba de Damara":["nnwes","esn","2ln"]};function i(e){return e.name in r?{...e,arena:r[e.name]}:e}n.getAreasForLevel=function(e,n){return o.default.filter(a=>a.realm===e&&a.from<=n&&a.to>=n).sort((e,n)=>e.to-n.to).map(i)},n.getAreaMetadata=function(e){const n=e.toLowerCase(),[a,...t]=o.default.filter(e=>e.name.toLocaleLowerCase().includes(n));return t.length&&console.warn(`Many areas detected for ${e}:\n- ${[a,...t].map(e=>e.name).join("\n- ")}`),a&&i(a)}},,,function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const t=a(4),o=a(26),r=a(43),i=a(44),s=a(66),l=a(88),c=a(89),u=a(90);const d="https://amatiasq.github.io"===location.origin?"wss://mudOS.amatiasq.com":"ws://localhost:"+u.DEFAULT_PORT,{host:m,port:p,user:h,pass:f}=function(){const{user:e,server:n}=c.getQueryParams(),[a,t]=n.split(":"),o=l.getPassword(e);return{host:a,port:parseInt(t,10),user:e,pass:o}}(),{terminal:g,controls:v,sidebar:w}=s.renderUserInterface(document.body);!function(){const e=new WebSocket(d);e.addEventListener("open",()=>{const n=new r.RemoteTelnet(e);n.connect(m,p),g.write(`Connecting to ${m}:${p} as ${h}\n`),async function(e){const n=new o.Mud(e);function a(a){g.write(a+"\n"),n.userInput(a)&&e.send(a)}async function r(){const e=t.emitter();v.addMeter("red",e.subscribe);const a=t.emitter();v.addMeter("blue",a.subscribe);const o=t.emitter();v.addMeter("green",o.subscribe),n.getPlugin("prompt").onUpdate(n=>{e(n.hp.percent),a(n.mana.percent),o(n.mv.percent)})}function s(){v.addButton("Entrenar",()=>n.run("train")),n.onWorkflowsChange(e=>{w.setWorkflows(e,e=>n.isRunning(e.name),e=>n.run(e.name),async e=>n.stop(e.name))})}function l(e,a){const t=`"${e}" with "${a.join(" ")}"`;g.write(`-> Running ${t}\n`),n.run(e,a).then(e=>g.write(`\n<- Done ${t}: ${e}\n`),e=>g.write(`\n\n<! FAILED ${t}: ${e.message}\n\n`))}n.onCommand(e=>g.write(e+"\n")),e.onData(e=>g.write(e)),g.onSubmit(a),window.onbeforeunload=()=>{e.isConnected&&e.send("abandonar"),e.close()},n.registerHandler("!",e=>{const[n,...a]=e.split(/\s+/);l(n,a)}),n.registerHandler("#",e=>{const[t,o,r]=e.split(/#/).map(e=>e.trim()),i=`#${t}#`,s=()=>a(o);null!=r?n.daemon(i,({when:e,printLogs:n})=>e(t,s)):n.runOnce(i,({when:e,printLogs:n})=>e(t).then(s)),g.write(`WHEN: ${t}\nRUN: ${o}\n`)}),await n.login(h,f),s(),i.registerWorkflows(n),await r(),Object.assign(window,{mud:n})}(n)})}(),window.addEventListener("unhandledrejection",e=>{const n=e.reason;"aborted"===n&&e.preventDefault(),n&&n.message&&n.message.startsWith("Timeout: ")&&(e.preventDefault(),console.warn(n.message))})},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Mud=void 0;const t=a(4),o=a(27),r=a(36),i=a(20),s=a(37),l=a(41),c=a(42);n.Mud=class{constructor(e){this.telnet=e,this.triggers=new s.TriggerCollection,this.workflows={},this.runnning=new Set,this.handlers=[],this.emitCommand=t.emitter(),this.onCommand=this.emitCommand.subscribe,this.emitWorkflowsChange=t.emitter(),this.onWorkflowsChange=this.emitWorkflowsChange.subscribe,this.whenLoggedIn=new Promise(e=>this.emitLoggedIn=e),this.workflow=this.workflow.bind(this),this.send=this.send.bind(this),this.run=this.run.bind(this),this.telnet.onData(e=>this.triggers.process(function(e){u&&(e=`${u}${e}`,u="");const n=e.match(/\u001b[^m]*?$/);return n&&(u=n[0],e=e.substr(0,e.length-u.length)),e.replace(/\u001b\[[^m]*?m/g,"")}(e).replace(/\r/g,"")))}async login(e,n){const a=new i.PluginContext("login","N/A",this.triggers,this.send);await r.login(a,e,n,async()=>{this.plugins=await o.initializePlugins(n=>new i.PluginContext(n,e,this.triggers,this.send))}),a.dispose(),this.username=e,this.emitLoggedIn(e)}send(e,n={}){this.emitCommand(n.password?"*".repeat(e.length):e),this.telnet.send(e)}userInput(e){const n=this.handlers.find(n=>e.startsWith(n.id));return Boolean(!n||n.handler(e.substr(n.id.length)))}registerHandler(e,n){this.handlers.push({id:e,handler:n})}getPlugin(e){return this.plugins[e]}daemon(e,n,a,t){const o=new c.Workflow(e,async e=>(await n(e),e.runForever()));return this.executeWorkflow(o,a,t).promise}workflow(e,n){const a=new c.Workflow(e,n);return this.workflows[a.name]=a,this.emitWorkflowsChange(Object.values(this.workflows)),a}runOnce(e,n){return this.executeWorkflow(new c.Workflow(e,n))}run(e,n,a){if(!(e in this.workflows))throw new Error(`Workflow "${e}" is not registered.`);const t=this.workflows[e],o=this.executeWorkflow(t,n,a);return this.runnning.add(o),o.promise.finally(()=>{this.runnning.delete(o),this.emitWorkflowsChange(Object.values(this.workflows))}),this.emitWorkflowsChange(Object.values(this.workflows)),o.promise}stop(e){[...this.runnning].filter(n=>n.workflow.name===e).forEach(e=>e.context.abort()),this.emitWorkflowsChange(Object.values(this.workflows))}isRunning(e){return[...this.runnning].some(n=>n.workflow.name===e)}executeWorkflow(e,n=[],{logs:a}={}){const t=this.createWorkflowContext(e.name);a&&t.printLogs;const o=e.execute(t,...n).then(e=>(t.dispose(),e)),r=Object.assign(o,{abort(){t.abort()}});return{workflow:e,context:t,promise:r}}createWorkflowContext(e){return new l.Context(e,this.username,this.triggers,this.plugins,this)}};let u=""},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.initializePlugins=void 0;const t=a(28),o=a(31),r=a(32),i=a(19),s=a(33),l=a(35),c={chat:t.chatPlugin,inventory:o.inventoryPlugin,navigation:r.navigationPlugin,prompt:i.promptPlugin,skills:s.skillsPlugin,stats:l.statsPlugin};n.initializePlugins=async function(e){const n=Object.entries(c).map(async([n,a])=>[n,await a(e(n))]),a=await Promise.all(n);return Object.fromEntries(a)}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.chatPlugin=void 0;const t=a(5),o=a(29),r=a(30),i={version:2},s=e=>({groups:{name:n,message:a}})=>{console.log(`MESSAGE => ${n} =>`,a),u(e,{from:n,message:a}),n.startsWith("[Orden")||c(`${n}: ${a}`)},l=e=>({groups:{name:n,message:a}})=>u(e,{to:n,message:a});async function c(e){return await r.requestNotificationPermission(),new Notification(e)}function u(e,n){const a=[o.datetime(new Date),n.from||"me",n.to||"me",n.message];return e.set([...e.get()||[],a]),a}n.chatPlugin=function({when:e,write:n}){const a=new t.ClientStorage("chat:order",i),o=new t.ClientStorage("chat:tell",i),r=new t.ClientStorage("chat:whisper",i);window.chat=()=>({tell:o.get(),order:a.get(),whisper:r.get()}),e(/(?<name>\[Orden: [^\]]+\]): '(?<message>[^']+)'/,s(a)),e(/(?<name>\[Orden\]): '(?<message>[^']+)'/,l(a)),e(/(?<name>.+) te susurra '(?<message>[^']+)'/,s(r)),e(/Susurras a (?<name>.+) '(?<message>[^']+)'/,l(r));const u=s(o);e([/(?<name>.+) te cuenta '(?<message>[^']+)'/,/(?<name>.+) te responde '(?<message>[^']+)'/],e=>{u(e);const a="porfa dime ",{name:t,message:o}=e.groups;o.startsWith(a)&&n("re "+o.substr(a.length))}),e([/Cuentas a (?<name>.+) '(?<message>[^']+)'/,/Respondes a (?<name>.+) '(?<message>[^']+)'/],l(o)),e(/(?<name>\w+) te ha desafiado a un combate en la arena!/,({groups:e})=>c("[ARENA] w/ "+e.name))}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.datetime=void 0;const t=e=>e<10?"0"+e:e;n.datetime=function(e){return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}`}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.requestNotificationPermission=void 0,n.requestNotificationPermission=function(){if("Notification"in window){if("granted"===Notification.permission)return Promise.resolve(!0);if("denied"!==Notification.permission)return Notification.requestPermission().then(e=>"granted"===e)}else console.warn("This browser does not support desktop notification")}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.inventoryPlugin=void 0;const t=a(0),o=a(17),r=a(7),i=/\n(?<content>(?:.|\n)*)\n[^ ]/,s=t.concatRegexes(/Estas llevando:/,i),l=t.concatRegexesUnescaped("(?: \\(",r.int("amount"),"\\))?"),c=t.concatRegexes(/^/,/(?<effects>(?:\(\w[^\)]+\w\) )*)/,/(?<name>\w[^\(\)]*\w)/,l,/$/);n.inventoryPlugin=function({when:e,write:n}){let a=!1,l={};const u=o.singleExecution(async()=>{n("inventario"),await e(s)});return e("No tienes ese objeto.",u),e(s,({groups:e})=>{a=!0,l=m(e.content),console.log("INVENTORY",l)},{captureLength:1e3}),{refresh:u,has:async function(e){a||await u();return p(l,e)},hasIn:d,hasInBackpack:d.bind(null,"mochila")};async function d(a,o){n("examinar "+a);const r=await Promise.any([e("No ves eso aqui.").then(()=>null),e(t.concatRegexes(/Cuando miras dentro ves:\n.+ contiene:/,i),{captureLength:1e3})]);if(!r)return!1;const s=m(r.groups.content);return console.log("IN",a,s),p(s,o)}function m(e){const n=e.split("\n").map(e=>e.trim()).filter(Boolean),a={};for(const e of n){if("Nada."===e)return{};const n=e.match(c);if(!n){console.error(`Can't match item "${e}"`);continue}const{effects:t,name:o,amount:i}=n.groups;a[o]={amount:i?r.toInt(i):1,effects:t.replace(/^\s*\(|\)\s*$/g,"").split(") (").filter(Boolean)}}return a}function p(e,n){if("string"==typeof n)return e[n]?n:null;if(Array.isArray(n))return n.find(n=>e[n])||null;const a=Object.keys(n).find(n=>e[n]);return a?n[a]:null}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.navigationPlugin=void 0;const t=a(4),o=a(18),r=a(19),i="(cerrada)",s={s:"sur",n:"norte",e:"este",w:"oeste",o:"oeste",u:"arriba",d:"abajo",l:"sureste",k:"suroeste",j:"noreste",h:"noroeste"},l=[/Plaza de Darkhaven\s+/,/Templo de la Justicia\s+/,/Templo de las Tinieblas\s+/];n.navigationPlugin=function({log:e,when:n,write:a}){let c=!1,u=!1,d=!1,m=[];const p=()=>n(r.PROMPT_DETECTOR),h=t.emitter();return n(l,()=>u=!0),n([/Puerta \w+ esta cerrada./,/Puertas? esta cerrada\./],async()=>{const e=m.find(e=>e.includes(i));if(e){const t=e.replace(i,"");a("abrir "+t);await Promise.any([n("Esta cerrada con llave.").then(()=>!1),n("Abres ").then(()=>!0)])&&a(t)}}),n(/\nSalidas: ([^\.]+)/,async({captured:e})=>{m=e[1].split(" "),c=!1,d=u,u=!1,await p(),h(m)}),{canGo:g,go:v,execute:async function(e,n){"r"===e[0]&&(await f(),e=e.substr(1));let a=!1,t="";for(const n of(o=e,o.replace(/(\d+)(\w)/g,(e,n,a)=>a.repeat(n))))if("X"!==n.toUpperCase()){if(a){for(;g(n);)if(await r(n))return!1;a=!1}else if(await r(n))return!1}else a=!0,t+="(X)";var o;return!0;async function r(a){try{if(!await v(a))return!0;t+=a}catch(n){throw new Error(`${n.message} - on ${e} - ${t}`)}if("function"==typeof n){return!1===await n()}}},getRealm:async function(){a("donde");return(await n(/Jugadores cerca de ti en (?: |\w)+, Reino de (?<realm>\w+):/)).groups.realm},recall:f,waitForRecall:function(){if(d)return new o.PatternPromise(e=>e());return n("Plaza de Darkhaven")},onRoomChange:h.subscribe,get isNavigating(){return c},get isAtRecall(){return d}};async function f(){if(d)return!0;a("recall"),await n("Plaza de Darkhaven"),await p()}function g(e){return Boolean(w(e))}async function v(t){if(c)throw new Error("WTF DUDE");const o=w(t);if(!o)throw new Error(`Unknown direction '${t}'`);if(function(e){const n=w(e);return n&&n.includes(i)}(t)){a("abrir "+t);if(!await Promise.any([n([/Abres la puertas?\./,/Abres la puerta \w+\./]).then(()=>!0),n("Esta cerrada con llave.").then(()=>!1)]))return e("Can\t open door"),!1}return a(o.replace(i,"").trim()),c=!0,await n("\nSalidas:"),await p(),c=!1,!0}function w(e){return e in s&&(e=s[e]),m.find(n=>n.startsWith(e))}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.skillsPlugin=void 0;const t=a(8),o=a(0),r=a(17),i=void 0,s=null,l=!1,c=!0,u=/((?:\w+ )+)\s+(\d+)%/g,d=o.concatRegexes(/-+\[(\w+)\]-+\n/,/(.|\n)+/,/Te quedan \d+ practicas.\n/,/Tienes \d+ entrenamientos.\n/);n.skillsPlugin=function({when:e,write:n}){let a=!1,o=!1,m=!1,p={};const h=r.singleExecution(()=>(n("practicar"),e(d)));return e(d,({captured:[e]})=>{for(const n of e.matchAll(u))p[n[1].trim()]=parseInt(n[2],10);a=!0},{captureLength:5e3}),{can:f,canLearn:async function(e){return await v(),e in p},castSpell:async function(a,r=""){const u=(Array.isArray(a)?a:[a]).map(t.getSpell).filter(Boolean),d=await f(u.map(e=>e.name));if(!d)return i;const p=u.find(e=>e.name===d),h=r?p.target:p.success;if(!h)throw new Error(`Unknown response for spell "${a}" (${p.name}).`+(r?` With target "${r}"`:""));if(o||m)return s;o=!0,n(`conjurar "${p.name}" ${r}`);const g=[e(h).then(()=>c),e(t.SPELL_NOT_POSSIBLE).then(()=>i),e(t.SPELL_ALREADY_APPLIED).then(()=>1),e(t.SPELL_FAILED).wait(4).then(()=>l)];p.target&&g.push(e(p.target).then(()=>c));const v=await Promise.any(g);return o=!1,v},meditate:async function(){return await f("meditar")?o?s:m?a():(m=!0,n("meditar"),a().finally(()=>m=!1)):i;function a(){return Promise.any([e("Meditas con total paz interior, recolectando mana del cosmos.").then(()=>c),e("Te pasas varios minutos en profunda concentracion, pero fallas en el intento de recolectar mana.").then(()=>l)]).finally()}},NOT_AVAILABLE:i,BUSY:s,FAILED:l,CASTED:c,ALREADY_APPLIED:1};async function f(e){return await v(),"string"==typeof e?g(e)?e:null:e.find(g)||null}function g(e){return p[e]}function v(){if(!a)return h()}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=[{level:1,type:"Hechizo",name:"armadura",minPos:"luchando (evasivo)"},{level:1,type:"Hechizo",name:"causar leve",minPos:"luchando (defensivo)"},{level:1,type:"Habilidad",name:"carpinteria",minPos:"de pie"},{level:1,type:"Habilidad",name:"cocinar",minPos:"luchando (defensivo)"},{level:1,type:"Habilidad",name:"despellejar",minPos:"luchando (defensivo)"},{level:1,type:"Habilidad",name:"estilo estandar"},{level:1,type:"Habilidad",name:"estilo evasivo"},{level:1,type:"Habilidad",name:"forjar",minPos:"de pie"},{level:1,type:"Habilidad",name:"minar",minPos:"de pie"},{level:1,type:"Habilidad",name:"pescar",minPos:"de pie"},{level:1,type:"Habilidad",name:"talar",minPos:"de pie"},{level:1,type:"Habilidad",name:"tallar",minPos:"de pie"},{level:1,type:"Habilidad",name:"tejer",minPos:"de pie"},{level:1,type:"Arma",name:"armas cortas"},{level:1,type:"Arma",name:"armas flexibles"},{level:1,type:"Arma",name:"armas impacto"},{level:1,type:"Arma",name:"armas largas"},{level:1,type:"Arma",name:"garras"},{level:1,type:"Arma",name:"pugilismo"},{level:1,type:"Idioma",name:"comun"},{level:1,type:"Idioma",name:"elfico"},{level:1,type:"Idioma",name:"enano"},{level:1,type:"Idioma",name:"goblin"},{level:1,type:"Idioma",name:"ogro"},{level:1,type:"Idioma",name:"orco"},{level:1,type:"Idioma",name:"troll"},{level:2,type:"Hechizo",name:"crear agua",minPos:"luchando (evasivo)"},{level:2,type:"Hechizo",name:"curar leves",minPos:"luchando (defensivo)"},{level:2,type:"Hechizo",name:"luz eterna",minPos:"luchando (evasivo)"},{level:2,type:"Habilidad",name:"cartografia",minPos:"luchando (agresivo)"},{level:2,type:"Habilidad",name:"cavar",minPos:"de pie"},{level:3,type:"Hechizo",name:"crear comida",minPos:"luchando (evasivo)"},{level:3,type:"Hechizo",name:"detectar magia",minPos:"luchando (evasivo)"},{level:4,type:"Hechizo",name:"detectar invisible",minPos:"luchando (berserk)"},{level:4,type:"Hechizo",name:"fuego espectral",minPos:"luchando"},{level:4,type:"Habilidad",name:"montar",minPos:"de pie"},{level:5,type:"Hechizo",name:"bendecir",minPos:"luchando"},{level:5,type:"Hechizo",name:"causar grave",minPos:"luchando (agresivo)"},{level:5,type:"Hechizo",name:"ceguera",minPos:"luchando (berserk)"},{level:5,type:"Hechizo",name:"curar ceguera",minPos:"luchando"},{level:5,type:"Hechizo",name:"detectar maldad",minPos:"luchando (defensivo)"},{level:6,type:"Hechizo",name:"crear fuego",minPos:"luchando (evasivo)"},{level:6,type:"Hechizo",name:"flotar",minPos:"luchando"},{level:6,type:"Habilidad",name:"buscar",minPos:"de pie"},{level:6,type:"Habilidad",name:"escalar",minPos:"de pie"},{level:6,type:"Habilidad",name:"patada",minPos:"luchando (berserk)"},{level:6,type:"Habilidad",name:"primeros auxilios",minPos:"luchando (agresivo)"},{level:7,type:"Hechizo",name:"refrescar",minPos:"luchando"},{level:7,type:"Habilidad",name:"danyo incrementado",minPos:"luchando (berserk)"},{level:7,type:"Habilidad",name:"estilo agresivo"},{level:8,type:"Hechizo",name:"curar veneno",minPos:"luchando (defensivo)"},{level:8,type:"Hechizo",name:"detectar escondido",minPos:"de pie"},{level:8,type:"Hechizo",name:"detectar trampas",minPos:"de pie"},{level:8,type:"Hechizo",name:"terremoto",minPos:"luchando"},{level:9,type:"Hechizo",name:"causar critica",minPos:"luchando"},{level:9,type:"Hechizo",name:"conocer alineamiento",minPos:"luchando (defensivo)"},{level:9,type:"Hechizo",name:"misil magico",minPos:"luchando"},{level:9,type:"Hechizo",name:"volar",minPos:"luchando"},{level:10,type:"Hechizo",name:"crear baya",minPos:"ninguna"},{level:10,type:"Hechizo",name:"crear manantial",minPos:"luchando"},{level:10,type:"Hechizo",name:"curar graves",minPos:"luchando (defensivo)"},{level:10,type:"Hechizo",name:"invisibilidad",minPos:"de pie"},{level:10,type:"Hechizo",name:"invocar armadillo",minPos:"de pie"},{level:10,type:"Hechizo",name:"veneno",minPos:"luchando (evasivo)"},{level:11,type:"Hechizo",name:"niebla espectral",minPos:"de pie"},{level:11,type:"Hechizo",name:"proteccion",minPos:"luchando (evasivo)"},{level:12,type:"Hechizo",name:"curar criticas",minPos:"luchando"},{level:12,type:"Hechizo",name:"disipar maldad",minPos:"luchando (agresivo)"},{level:12,type:"Hechizo",name:"llamar rayo",minPos:"luchando"},{level:12,type:"Hechizo",name:"maldecir",minPos:"luchando (agresivo)"},{level:13,type:"Hechizo",name:"bola fuego",minPos:"luchando"},{level:13,type:"Hechizo",name:"control climatico",minPos:"de pie"},{level:13,type:"Hechizo",name:"detectar veneno",minPos:"de pie"},{level:13,type:"Hechizo",name:"identificar",minPos:"luchando (evasivo)"},{level:13,type:"Hechizo",name:"localizar objeto",minPos:"luchando (evasivo)"},{level:14,type:"Hechizo",name:"disipar magia",minPos:"luchando"},{level:14,type:"Hechizo",name:"piel robliza",minPos:"de pie"},{level:14,type:"Hechizo",name:"retirar invisibilidad",minPos:"de pie"},{level:14,type:"Hechizo",name:"saciar hambre",minPos:"luchando (evasivo)"},{level:15,type:"Hechizo",name:"debilitar",minPos:"luchando (agresivo)"},{level:15,type:"Hechizo",name:"relampago",minPos:"luchando (defensivo)"},{level:15,type:"Habilidad",name:"manotazo",minPos:"luchando"},{level:15,type:"Habilidad",name:"otear",minPos:"de pie"},{level:15,type:"Habilidad",name:"pisoton",minPos:"luchando (berserk)"},{level:15,type:"Habilidad",name:"segundo ataque",minPos:"luchando (berserk)"},{level:16,type:"Hechizo",name:"golpe flamigero",minPos:"luchando (defensivo)"},{level:16,type:"Habilidad",name:"meditar",minPos:"descansando"},{level:17,type:"Hechizo",name:"causar fatales",minPos:"luchando (agresivo)"},{level:17,type:"Hechizo",name:"retirar maldicion",minPos:"luchando (evasivo)"},{level:17,type:"Hechizo",name:"sonyar",minPos:"de pie"},{level:17,type:"Hechizo",name:"vista distancia",minPos:"luchando"},{level:17,type:"Habilidad",name:"estilo defensivo"},{level:17,type:"Habilidad",name:"sigilo",minPos:"de pie"},{level:18,type:"Hechizo",name:"agarron impactante",minPos:"luchando (berserk)"},{level:18,type:"Hechizo",name:"respiracion acuatica",minPos:"de pie"},{level:18,type:"Hechizo",name:"retirar trampa",minPos:"de pie"},{level:19,type:"Hechizo",name:"sanar",minPos:"luchando (agresivo)"},{level:20,type:"Hechizo",name:"fuerza vampirica",minPos:"luchando"},{level:20,type:"Hechizo",name:"invisibilidad grupo",minPos:"de pie"},{level:20,type:"Hechizo",name:"invocar lince",minPos:"de pie"},{level:20,type:"Hechizo",name:"invocar regreso",minPos:"descansando"},{level:20,type:"Hechizo",name:"polimorfar",minPos:"luchando (evasivo)"},{level:20,type:"Habilidad",name:"rescatar",minPos:"luchando (berserk)"},{level:21,type:"Habilidad",name:"desarmar",minPos:"luchando (agresivo)"},{level:22,type:"Hechizo",name:"rayo solar",minPos:"luchando (berserk)"},{level:24,type:"Hechizo",name:"atravesar puerta",minPos:"luchando (evasivo)"},{level:24,type:"Hechizo",name:"furia naturaleza",minPos:"ninguna"},{level:25,type:"Hechizo",name:"escudo hielo",minPos:"de pie"},{level:26,type:"Habilidad",name:"esquivar",minPos:"luchando (agresivo)"},{level:28,type:"Habilidad",name:"estilo berserk",minPos:"luchando (defensivo)"},{level:30,type:"Hechizo",name:"encantar arma",minPos:"de pie"},{level:30,type:"Hechizo",name:"invocar aguila",minPos:"de pie"},{level:30,type:"Hechizo",name:"santuario",minPos:"de pie"},{level:30,type:"Habilidad",name:"tercer ataque",minPos:"luchando (berserk)"},{level:31,type:"Hechizo",name:"viajar",minPos:"de pie"},{level:32,type:"Hechizo",name:"relentizar",minPos:"luchando"},{level:34,type:"Hechizo",name:"dormir",minPos:"de pie"},{level:35,type:"Hechizo",name:"atravesar vegetacion",minPos:"de pie"},{level:35,type:"Hechizo",name:"drenar energia",minPos:"luchando"},{level:35,type:"Hechizo",name:"escudo flamigero",minPos:"luchando (evasivo)"},{level:35,type:"Hechizo",name:"metal ardiente",minPos:"luchando"},{level:35,type:"Hechizo",name:"piel petrea",minPos:"luchando"},{level:35,type:"Habilidad",name:"rastrear",minPos:"de pie"},{level:40,type:"Hechizo",name:"escudo",minPos:"luchando"},{level:40,type:"Hechizo",name:"invocar lobo",minPos:"de pie"},{level:40,type:"Habilidad",name:"parada",minPos:"luchando (agresivo)"},{level:42,type:"Hechizo",name:"enredo vegetal",minPos:"ninguna"},{level:43,type:"Hechizo",name:"transporte arboreo",minPos:"ninguna"},{level:45,type:"Hechizo",name:"escudo electrico",minPos:"luchando (evasivo)"},{level:45,type:"Hechizo",name:"nube aturdidora",minPos:"de pie"},{level:45,type:"Habilidad",name:"cuarto ataque",minPos:"luchando (berserk)"},{level:45,type:"Habilidad",name:"esconderse",minPos:"de pie"},{level:48,type:"Hechizo",name:"vision verdadera",minPos:"de pie"},{level:50,type:"Hechizo",name:"invocar jaguar",minPos:"de pie"},{level:50,type:"Hechizo",name:"teleportar",minPos:"luchando (defensivo)"},{level:51,type:"Hechizo",name:"cantico",minPos:"luchando (evasivo)"},{level:51,type:"Habilidad",name:"punyo_helado",minPos:"luchando (agresivo)"},{level:52,type:"Hechizo",name:"crear arbol",minPos:"ninguna"},{level:52,type:"Hechizo",name:"destruir maldad",minPos:"luchando (defensivo)"},{level:52,type:"Habilidad",name:"punyo_electrico",minPos:"luchando (agresivo)"},{level:54,type:"Hechizo",name:"maremoto",minPos:"luchando"},{level:57,type:"Hechizo",name:"vara robliza",minPos:"ninguna"},{level:60,type:"Hechizo",name:"delirio caotico",minPos:"luchando"},{level:60,type:"Hechizo",name:"invocar oso",minPos:"de pie"},{level:60,type:"Hechizo",name:"rafaga viento",minPos:"luchando"},{level:62,type:"Hechizo",name:"relampago helado",minPos:"luchando (defensivo)"},{level:63,type:"Hechizo",name:"clonacion",minPos:"luchando (defensivo)"},{level:67,type:"Hechizo",name:"tormenta hielo",minPos:"luchando (berserk)"}]},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.statsPlugin=void 0;const t=a(0),o=a(7),r=3e3,i=(()=>{const e=t.concatRegexes,n=e=>e.toLowerCase(),a=/\-{78}/,r=/\s+/,i=/\s+\|\s+/,s=(...n)=>e(/\|\|\s*/,...n,/\s*\|\|\n/),l=a=>e(a,/\s+: /,o.int(n(a)),/\(/,o.int(n(a)+"Base"),/\)/),c=a=>e(a,/\s+: /,o.int(n(a)),/\s+\//,o.int(n(a)+"Base"),/\s+\(\s*/,o.int(n(a)+"Regen"),/%\) (?:Regen)?/);return e(a,/\n ?\/\s{78}\\\n/,s(/Ficha de (?<name>\w+)(?<principal> \(Personaje Principal\))\./),s(a),s(l("FUE"),r,l("DES"),i,c("Vida")),s(l("INT"),r,l("SAB"),i,c("Mana")),s(l("CON"),r,l("CAR"),i,c("Mov")),s(l("SUE"),r,i,r),/\|\|-{36}\+-{41}\|\|\n/,e(/\|\|\s*Nivel\s+: /,o.int("level"),/(?:.|\n)+?/))})();n.statsPlugin=function({when:e,write:n}){let a=!1,t="",s=!1;const l={fue:0,fueBase:0,des:0,desBase:0,vida:0,vidaBase:0,vidaRegen:0,int:0,intBase:0,sab:0,sabBase:0,mana:0,manaBase:0,manaRegen:0,con:0,conBase:0,car:0,carBase:0,mov:0,movBase:0,movRegen:0,sue:0,sueBase:0,level:0};return e(i,({groups:e})=>{for(const n of Object.keys(l))l[n]=o.toInt(e[n]);t=e.name,s=Boolean(e.principal),console.log(l),a=!0},{captureLength:3e3}),{getLevel:async()=>(await async function(){a||(n("estado"),await e(i,{captureLength:r}))}(),l.level)}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.login=void 0,n.login=async function({when:e,write:n,log:a},t,o,r){await e("Entra el nombre de tu personaje o escribe Nuevo:"),n(t),a("Username sent, waiting for password request"),await e("Password:"),n(o,{password:!0}),a("Logged in as "+t),await Promise.any([(async()=>{await e("Reconectando."),await r()})(),(async()=>{await e("Pulsa [ENTER]"),n(""),await e("Pulsa [ENTER]"),n(""),await e("Bienvenido a Balzhur...",r,{await:!0}).once()})()])}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TriggerCollection=void 0;const t=a(38),o=a(18);n.TriggerCollection=class{constructor(){this.patterns=new Set,this.queue=[],this.isProcessing=!1}add(e,n,a){return 1===arguments.length?this.once(e):3===arguments.length?this.watch(e,n,a):"function"==typeof n?this.watch(e,n):this.once(e,n)}watch(e,n,a){const r=new t.PatternMatcher(e,e=>n(e),a);this.patterns.add(r);const i=()=>this.patterns.delete(r);return{unsubscribe:i,once:()=>new o.PatternPromise(e=>{const t=n;n=async n=>{i(),t&&(a&&a.await?await t(n):t(n)),e(n)}})}}once(e,n){return new o.PatternPromise(a=>{const t=this.add(e,(function(e){t.unsubscribe(),a(e)}),n)})}async process(e){if(this.isProcessing)return void this.queue.push(e);this.isProcessing=!0;const n=e.split("\n"),a=n.pop(),t=[...n.map(e=>e+"\n"),a];for(const e of t)for(const n of this.patterns)await n.process(e);return this.isProcessing=!1,this.queue.length?this.process(this.queue.pop()):void 0}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PatternMatcher=void 0;const t=a(39),o=a(40);n.PatternMatcher=class{constructor(e,n,a={}){this.handler=n,this.options=a,this.patterns=Array.isArray(e)?e:[e],this.length=a.captureLength||10*Math.max(...this.patterns.map(e=>String(e).length)),this.buffer=function(e){let n="";const a=()=>n="",o=a=>n=t.trimEnd(`${n}${a}`,e);return Object.assign(o,{clear:a})}(this.length)}process(e){const n=this.buffer(e),a=this.patterns.filter(e=>this.testPattern(n,e));if(!a.length)return;this.buffer.clear();const t=new o.PatternResult(a,n),r=this.handler(t);return this.options.await?r:null}testPattern(e,n){return"string"==typeof n?e.indexOf(n)>-1:n.test(e)}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.trimEnd=void 0,n.trimEnd=function(e,n){return e.length>n?e.substr(e.length-n):e}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PatternResult=void 0;function t(e){return e instanceof RegExp}function o(e,n){return{...e,...n}}n.PatternResult=class{constructor(e,n){this.patterns=e,this.haystack=n}get regexes(){return this.patterns.filter(t)}get stringPatterns(){return this.patterns.filter(e=>!t(e))}get fullMatch(){return this.stringPatterns[0]}get captured(){return this.regexes.map(e=>this.haystack.match(e)).filter(Boolean).map(e=>Array.from(e))[0]}get groups(){return this.regexes.map(e=>this.haystack.match(e)).filter(Boolean).map(e=>e.groups).filter(Boolean).reduce(o,{})}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Context=void 0;const t=a(20),o=a(21);class r extends t.PluginContext{constructor(e,n,a,t,i){var s,l;super(e,n,a,i.send),this.mud=i,this.finish=null,this.plugins=(s=t,l=this.log.bind(this),new Proxy(s,{get(e,n){if(!(n in e))throw l("Failed to get plugin "+n),new Error(`Plugin ${n} is not registered.`);return l("Requires plugin "+n),e[n]}})),o.bindAll(this,r)}register(e,n){return this.mud.workflow(e,n)}isRunning(e){return this.mud.isRunning(e)}run(e,n=[]){this.checkNotAborted(),this.log(`Invoke workflow "${e}" with`,...n);const a=this.mud.run(e,n,{logs:this.isPrintingLogs});return a.then(n=>this.log(`Invocation "${e}" returned `,n),n=>this.log(`Invocation "${e}" failed `,n)),a}runForever(){return this.checkNotAborted(),new Promise(e=>this.finish=e)}abort(){super.abort(),this.finish&&this.finish(new Error("Workflow aborted"))}}n.Context=r},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Workflow=void 0;n.Workflow=class{constructor(e,n){this.name=e,this.run=n,this.executionCount=0,this.currentExecutions=0}get isRunning(){return this.currentExecutions>0}get instancesRunning(){return this.currentExecutions}get timesExecuted(){return this.executionCount}async execute(e,...n){this.currentExecutions++;const a=this.executionCount++;e.log(`[Exe(${a})]`,...n);try{const t=await this.run(e,...n);return e.log(`[Res(${a})]`,t),t}catch(n){throw e.log(`[ERR(${a})]`,n),n}finally{this.currentExecutions--}}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteTelnet=void 0;const t=a(4);n.RemoteTelnet=class{constructor(e){this.socket=e,this._isConnected=!1,this.emitClose=t.emitter(),this.onClose=this.emitClose.subscribe,this.emitData=t.emitter(),this.onData=this.emitData.subscribe,e.addEventListener("close",this.emitClose),e.addEventListener("message",this.onMessage.bind(this)),this.onData(()=>this._isConnected=!0),this.onClose(()=>this._isConnected=!1)}get isConnected(){return this._isConnected}connect(e,n){this.proxy("OPEN",{host:e,port:n})}send(e){this.proxy("INPUT",unescape(encodeURIComponent(e)))}close(){this.socket.close()}proxy(e,n){this.socket.send(JSON.stringify({type:e,payload:n}))}async onMessage(e){const n=new FileReader;n.onloadend=e=>this.emitData(n.result),n.readAsText(e.data,"ISO-8859-1")}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.registerWorkflows=void 0;const t=a(45),o=a(46),r=a(47),i=a(49),s=a(50),l=a(51),c=a(52),u=a(53),d=a(54),m=a(55),p=a(56),h=a(57),f=a(58),g=a(59),v=a(60),w=a(62),b=a(63),A=a(64),y=a(65);n.registerWorkflows=function(e){e.daemon("code",t.code),e.daemon("defend",o.defend),e.daemon("dope",r.dope),e.daemon("drink",i.drink),e.daemon("eat",s.eat),e.daemon("idle",l.idle),e.daemon("quest",c.quest),e.daemon("repair",u.repair),e.daemon("rest",d.rest),e.daemon("shop",m.shop),e.workflow("afk",p.afk),e.workflow("bank",h.bank),e.workflow("cast",f.cast),e.workflow("donations",g.donations),e.workflow("kill",w.kill),e.workflow("go",v.go),e.workflow("recover",b.recover),e.workflow("train",A.train),e.workflow("wear",y.wear)}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.code=void 0;const t=new(a(5).ClientStorage)("things-in-rooms");n.code=function({when:e}){console.log("running"),e(/Salidas: [^\.]+\.\n\n([^<]+)\n<\d+/,({captured:e})=>{if(e[1].includes("Solo puedes leer mails de ese buzon."))return;const n=e[1].split(/\n/).map(e=>e.trim()),a=t.get()||{};n.forEach(e=>a[e]=(a[e]||0)+1),t.set(a)},{captureLength:5e3})}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.defend=void 0;const t=a(10),o=a(8);n.defend=async function({isRunning:e,run:n,when:a,write:r,plugins:{prompt:i,skills:s,navigation:l}}){a("Estas demasiado exhausto para huir del combate!",()=>l.recall()),a(t.ATTACK_RECEIVED,async({groups:n})=>{if(console.log("Attack received",e("kill")),e("kill"))return;const a=i.getPercent("mana"),r=n.mob;if(r&&a>.1){const e=t.getMobIn(r);await s.castSpell(o.SPELLS_BY_TYPE.attack,e?e.name:r)}}),a(".. Todo empieza a volverse negro.\n",async()=>{const e="Tu cuerpo aparece de repente, rodeado por una divina presencia...";let n=0;const t=a(e,()=>n++);for(await r("suplicar cuerpo"),await a(e).timeout(5),t.unsubscribe(),a("El cadaver de May pasa a convertirse en polvo",()=>n--);n;)r("coger todo may"),await i.until(),r("vestir todo"),await i.until(),await i.until()}),a("Esta completamente oscuro ...",async()=>{await s.can("luz eterna")&&(await n("cast",["luz eterna"]),r("vestir luz"),r("mirar"))}),a(/El cadaver de.* contiene:(?<items>(?:.|\n)+)\n[^ ]/,({groups:e})=>{e.items.toLowerCase().split(/\n/).map(e=>e.trim()).filter(e=>e&&"nada."!==e).some(e=>e.includes("llave"))&&r("coger llave cuerpo")}),a("Tragas agua al intentar respirar!",async()=>{await s.can("respiracion acuatica")&&s.castSpell("respiracion acuatica")})}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.dope=void 0;const t=a(5),o=a(8),r=a(48),i=new t.ClientStorage("dope:casting"),s=Object.values(o.SPELLS_BY_TYPE);n.dope=async function({when:e,register:n,run:a,plugins:{prompt:t,skills:l}}){const c=h(.2),u=h(.1,.8),d=(e,...n)=>a("cast",[e,...n]).catch(()=>null),m=new Set(i.get()),p=o.getSpells();function h(e,n=1){const a=1/(n-e);return(t,o)=>{if(0===t||o>n)return!1;if(o<e)return!0;const r=(o-e)*a;return Math.hypot(t,1-r)>1}}function f(e){const n=s.find(n=>n.includes(e));return n||[e]}p.filter(e=>e.end).forEach((async function(n){const a=f(n.name);e(n.end,async()=>{m.add(a),i.set([...m]);await d(a)&&(m.delete(a),i.set([...m]))})})),t.onUpdate(async({isFighting:e,mana:{percent:n},hp:{percent:a},mv:{percent:t}})=>{if(e)return;const r=await l.can("meditar");return n<.1&&!r?void 0:n<.7&&r?l.meditate():a>0&&c(n,a)?l.castSpell(o.SPELLS_BY_TYPE.heal):a>0&&u(n,t)?l.castSpell("refrescar"):void 0}),n("dope",async(e,n)=>{const a=p.filter(e=>e.effect&&(!n||e.target)).map(e=>f(e.name)),t=r.uniq(a.map(e=>e.join("|"))).map(e=>e.split("|"));for(const e of t)await d(e,n)})}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.uniq=void 0,n.uniq=function(e){return[...new Set(e)]}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drink=void 0,n.drink=async function({run:e,when:n,write:a,plugins:{inventory:t,navigation:o,skills:r}}){let i=!1,s=!1;async function l(){return t.has({"un odre de cuero":"odre","una cantimplora":"cantimplora"})}o.onRoomChange(()=>i=!1),n(["Un manantial magico esta aqui.","Una hermosa fuente de marmol blanco esta aqui.","Trazas un circulo delante tuyo del cual emerge un manantial de agua cristalina."],async()=>{if(i=!0,!s){const e=await l();e&&(a("llenar "+e),s=!0)}}),n(["Te apetece dar un sorbo a algo refrescante.","Tienes sed.","Estas realmente sediento.","Estas MUERTO de SED!","Estas en peligro de deshidratacion."],async()=>{if(i||await async function(){if(await r.can("crear manantial"))return e("cast",["crear manantial"])}())return void a("beber");const n=await l();n?(a("beber "+n),await r.castSpell("crear agua",n)):console.log("No hay fuente de agua")})}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.eat=void 0,n.eat=async function({run:e,when:n,write:a,plugins:{inventory:t,navigation:o,skills:r}}){async function i(){const o=await async function(){return await s(),await t.has({"un chorizo":"chorizo","pavo cocinado":"pavo","una chuleta de cordero":"chuleta","loncha de salami":"salami","pierna de cordero":"pierna","ricas longanizas":"longanizas","un extranyo hongo":"hongo"})}();return o?(a("comer "+o),t.refresh(),!0):await async function(){if(!await r.can("crear comida")||!await e("cast",["crear comida"]))return!1;a("coger seta");try{return await n("Coges una seta magica.").timeout(3),a("comer seta"),!0}catch(e){return!1}}()}async function s(){if(await t.has("una bolsa")){a("coger todo bolsa"),a("examinar bolsa");const{captured:e}=await n(/Una bolsa contiene:\n\s+(Nada)?/);e[1]&&a("tirar bolsa")}}n(["Tienes hambre.","Estas realmente hambriento."],i),n(["Estas terriblemente hambriento.","Estas HAMBRIENTO!"],async()=>{await i()||o.isAtRecall&&(await async function(){await o.execute("2sen"),a("comprar 1 chuleta"),await Promise.any([n("Compras una chuleta de cordero."),n("El carnicero pone todo en una bolsa y te la da.").then(s)]),await o.execute("sw2n")}(),await i())})}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.idle=void 0,n.idle=async function({when:e,write:n,run:a,plugins:{navigation:t,skills:o}}){e("Desapareces en la nada.",async()=>{console.log("IDLE"),t.isAtRecall?(await a("train"),o.can("invisibilidad")&&await a("cast",["invisibilidad"])):n("estado")})}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.quest=void 0,n.quest=async function({when:e,write:n,plugins:{navigation:a}}){e(/El tesoro parece estar(?: al) (?<dir>\w+) de aqui.../,async({groups:e})=>{await a.go(e.dir),n("carto mapa")}),e("No has desenterrado nada a pesar de haber cavado bien hondo.",()=>n("cavar"))}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.repair=void 0;const t=a(11),o=a(6);n.repair=async function({when:e,write:n,register:a,plugins:{navigation:r,prompt:i}}){async function s(a){for(const o of a)n("guardar "+o),await e(t.UNWEAR);return await c(),r.execute("nw2n")}async function l(){const a=[];n("equipo");const o=e(/>\s+\[\+*[^+]+\] (?<item>.*)/,({groups:e})=>{const n=t.getItemSustantive(e.item);n&&a.push(n)});return await e("Estas usando:"),await i.until(),o.unsubscribe(),a.length?a:null}async function c(){n("reparar todo"),await Promise.any([e("El herrero te cobra").then(()=>!0),e("El herrero te cuenta").then(()=>!1),o.wait(5).then(()=>null)]),n("vestir todo")}a("repair",async()=>{const e=await l();if(e)return await r.execute("r2ses"),s(e)}),e("No puedes vestir eso, necesita repararse.",async()=>{await r.execute("r2ses"),await c();const e=await l();if(e)return s(e)})}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.rest=void 0,n.rest=async function({when:e,write:n}){e(["Nah... Estas demasiado relajado...","En tus suenyos o que?","Estas demasiado relajado para lanzar ese conjuro.","Estas demasiado relajado para lanzar ese conjuro."],()=>n("despertar"))}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shop=void 0;const t={viajar:{path:{Calimhar:"r2s3wn"},amount:5}};n.shop=async function({when:e,write:n,register:a}){e(/pone todo en una bolsa y te la da\./,async()=>{n("coger todo bolsa"),n("examinar bolsa"),await e(/Una bolsa contiene:\n\s+Nada\./),n("tirar bolsa")}),a("buy",async({when:e,write:n,plugins:{navigation:a}},o,r)=>{if(!(o in t))throw new Error(`Unknown item type "${o}"`);const i=await a.getRealm(),s=t[o],l=s.path[i],c=s.name||o;if(r||(r=s.amount||1),!l)throw new Error(`Can't find shop for ${o} on realm ${i}`);return await a.execute(l),n(`comprar ${r} ${c}`),Promise.any([e("Lo siento, esta cerrado, vuelve mas tarde.").then(()=>!1),e(["Compras ","pone todo en una bolsa y te la da"]).then(()=>!0)])})}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.afk=void 0,n.afk=async function({abort:e,run:n,when:a,printLogs:t,plugins:{navigation:o}},...r){let i=!1;for(a(".. Todo empieza a volverse negro.\n",()=>{i=!0,e()});!i;)await s();async function s(){try{await n("recover"),await n("repair"),await n("dope"),await n("recover")}catch(e){console.log("Preparation error",e)}console.log("Stats 100%. Start train...");try{await n("train",[(e=r||[],e[Math.floor(Math.random()*e.length)])]),console.log("workflow completed")}catch(e){console.log("workflow failed")}var e;try{o.isAtRecall&&await n("bank")}catch(e){console.log("Bank error",e)}}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bank=void 0;const t=a(0),o=a(7);n.bank=async function({when:e,write:n,plugins:{navigation:a}},r){const i=t.concatRegexes(/Ingresas /,o.int(),/ monedas? de oro en tu cuenta bancaria./),s=t.concatRegexes(/Retiras /,o.int(),/ monedas? de oro de tu cuenta bancaria./);await a.execute("r4s2en"),n("banco saldo");const{groups:l}=await e(t.concatRegexes(/Estas llevando /,o.int("carring"),/ monedas de oro.\n/,/Tienes /,o.int("balance"),/ monedas de oro en el banco.\n/,/Lo que hace un total de /,o.int("total"),/ monedas de oro.\n/)),c=o.toInt(l.carring),u=(o.toInt(l.balance),o.toInt(l.total)),d=null==r?Math.ceil(.01*u):r;c<d?(n("banco retirar "+(d-c)),await e(s)):c>d&&(n("banco ingresar "+(c-d)),await e(i)),await a.execute("s2w4n")}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.cast=void 0;const t=a(6);n.cast=async function({plugins:{prompt:e,skills:n}},a,...o){const r=await async function r(){e.isFighting&&await e.until(e=>!e.isFighting);switch(await n.castSpell(a,o.join(" "))){case n.CASTED:case n.ALREADY_APPLIED:return!0;case n.NOT_AVAILABLE:return!1;case n.BUSY:await t.wait(3);case n.FAILED:return r()}throw new Error("WTF DUDE")}();return!1===r&&console.warn(`Unable to cast "${a}"`),r}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.donations=void 0;const t=a(11),o=[{from:31,to:40,path:"4wn"},{from:21,to:30,path:"3wn"},{from:11,to:20,path:"2wn"},{from:1,to:10,path:"wn"},{from:41,to:50,path:"en"},{from:51,to:60,path:"2en"},{from:61,to:70,path:"3en"},{from:71,to:80,path:"4en"}];n.donations=async function({when:e,write:n,run:a,plugins:{navigation:r,stats:i}}){n("estado");const s=await i.getLevel(),l=o.find(e=>e.from<=s&&e.to<=s);if(!l)throw new Error(`No room for level "${s}"`);await r.execute("rh2w4n");const c=e(/Salidas: sur\.\n\n((?:.|\n)*)\n\n/,{captureLength:Number.MAX_VALUE});await r.execute(l.path);const{captured:u}=await c,d=u[1].split("\n").map(e=>e.trim());for(const e of Object.values(t.ITEM_SUSTANTIVES)){d.some(n=>n.includes(e)&&!n.includes("mallas"))&&await a("wear",[e])}await r.recall()}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.go=void 0;const t=a(22),o=/^r?((?:x|\d+)?[nsewudohjkl])+$/,r="un pergamino de viajar",i={Calimhar:"DarkHaven",Earand:"Justicia",Valmorag:"Tinieblas",Niruk:null};n.go=async function({run:e,when:n,write:a,plugins:{navigation:s,inventory:l,skills:c}},u){if(o.test(u))return s.execute(u);const d=t.getAreaMetadata(u);if(!d)throw new Error(`Can't resolve path or area "${u}"`);if(!d.path)throw new Error(`Area ${d.name} doesn't have a path`);const m=await s.getRealm();if(d.realm===m)return s.execute(d.path);const p=i[d.realm];if(!p)throw new Error(`Realm ${d.realm} doesn't have recall.`);if(await c.can("viajar")&&await e("cast",["viajar",d.realm]))return s.execute(d.path);let h=!1;if(await l.has(r)?h=!0:await l.hasInBackpack(r)&&(a("coger viajar mochila"),h=await Promise.any([n("Coges un pergamino de viajar de").then(()=>!0),n("No hay nada parecido a eso en").then(()=>!1)])),h)return a("recitar viajar "+p),await n("Recitas un pergamino de viajar.").timeout(3),s.execute(d.path);throw new Error(`No way to travel to ${d.name} in ${d.realm}`)}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=[{realm:"Calimhar",name:"Academia de Darkhaven",path:"rd",from:1,to:5,min:0,max:95},{realm:"Calimhar",name:"Bosque de las Hadas",path:"r6w2nwk2wh",from:1,to:5,min:0,max:95},{realm:"Calimhar",name:"Catacumbas de la Capilla",path:"r6w8se7s",from:15,to:25,min:0,max:95},{realm:"Calimhar",name:"Cementerio Oscuro",path:"r4s4ws",clan:"Legends",from:5,to:15,min:0,max:95},{realm:"Calimhar",name:"Ciudad Imperial",path:"r8e2n4el3e2sj",from:0,to:95,min:0,max:95},{realm:"Calimhar",name:"DarkHaven",path:"rd",from:0,to:95,min:0,max:95},{realm:"Calimhar",name:"El Campamento Goblin",path:"r10s4en3e2n",from:1,to:10,min:0,max:95},{realm:"Calimhar",name:"El Cementerio",path:"r6w8ses",from:5,to:10,min:0,max:95},{realm:"Calimhar",name:"El Centinela",path:"r7ws",from:5,to:10,min:0,max:95},{realm:"Calimhar",name:"El Gran Estadio",path:"r8e2n4el3e2s2jn",from:10,to:20,min:0,max:95},{realm:"Calimhar",name:"El Imperio Orco",path:"r13s2wn",clan:"Legends",from:10,to:20,min:0,max:95},{realm:"Calimhar",name:"El Jardin de los Heroes",path:"r8e2n4el3e2s2j8l8e5j4els",from:75,to:80,min:0,max:95},{realm:"Calimhar",name:"El Pantano Orco",path:"r13s2en",clan:"DarkAngels",from:5,to:30,min:0,max:95},{realm:"Calimhar",name:"El Refugio Destruido",path:"r8e2ne",from:5,to:20,min:0,max:95},{realm:"Calimhar",name:"Exportaciones de Dragones",path:"r4sen",clan:"Legends",from:5,to:25,min:0,max:95},{realm:"Calimhar",name:"Foire de Reves",path:"r8n3ene",from:0,to:50,min:0,max:95},{realm:"Calimhar",name:"Galeria de arte",path:"r4swn",from:10,to:50,min:0,max:95},{realm:"Calimhar",name:"Guarderia Enana",path:"r8ejs",from:1,to:5,min:0,max:95},{realm:"Calimhar",name:"Haon Dor",path:"r7w",from:5,to:10,min:0,max:95},{realm:"Calimhar",name:"Holy Grove",path:"r9e",from:5,to:20,min:0,max:95},{realm:"Calimhar",name:"Kharadest, Baluarte de Platino",from:78,to:80,min:77,max:95},{realm:"Calimhar",name:"La Fortaleza de Valor",path:"r11n2en",clan:"DragonSlayers",from:5,to:30,min:0,max:95},{realm:"Calimhar",name:"La Mansion de Marmol",path:"r9w3s",from:5,to:15,min:0,max:95},{realm:"Calimhar",name:"La Mansion de Tullfuhrzky",path:"r6w2nwk2wh4nj",from:1,to:10,min:0,max:95},{realm:"Calimhar",name:"La Torre del Brujo",path:"r9w2sese2s",clan:"Legends",from:10,to:20,min:0,max:95},{realm:"Calimhar",name:"Las Alcantarillas",path:"r4sd",from:5,to:20,min:0,max:95},{realm:"Calimhar",name:"Las Llanuras del Norte",path:"r7n",from:1,to:20,min:0,max:95},{realm:"Calimhar",name:"Miden'nir",path:"r7s",from:5,to:15,min:0,max:95},{realm:"Calimhar",name:"Residencias de Mortales",from:0,to:95,min:0,max:95},{realm:"Calimhar",name:"Sindaliore",clan:"Legends",from:75,to:80,min:77,max:95},{realm:"Earand",name:"Armageddon",path:"r3s7w6n2wsl2sejls",clan:"Conclave",from:50,to:80,min:0,max:95},{realm:"Earand",name:"Asgard",path:"r3s7w11ne2n2enhjn;entrar;.s",clan:"El Santuario",from:40,to:60,min:0,max:95},{realm:"Earand",name:"Asoinwan, ciudad de las hadas",path:"r3s7w11ne2n",clan:"DragonSlayers",from:5,to:30,min:0,max:95},{realm:"Earand",name:"Camelot",path:"r3s7w11ne2n2ej",from:65,to:80,min:50,max:95},{realm:"Earand",name:"Dregoria",path:"r3s5e10n3wn",clan:"Cantico",from:40,to:65,min:0,max:95},{realm:"Earand",name:"El Calabozo de la Muerte",path:"ruse7n",from:10,to:35,min:0,max:95},{realm:"Earand",name:"El Campo de Batalla Desolado",path:"r3s7w6n2wsl2se",from:15,to:25,min:0,max:95},{realm:"Earand",name:"El Plano Astral",path:"r2su",clan:"DarkAngels",from:15,to:35,min:0,max:95},{realm:"Earand",name:"El Pueblo Fantasma",path:"r3s5e2j",clan:"DragonSlayers",from:35,to:50,min:0,max:95},{realm:"Earand",name:"El Reino de Yggdrasil",path:"r3s7w11ne2n2enhjn;entrar",from:15,to:50,min:0,max:95},{realm:"Earand",name:"El Yunque del Sol",path:"r3s7w6n2wsl2sejl2s5e4n3w2n4w",clan:"Legends",from:60,to:80,min:0,max:95},{realm:"Earand",name:"Estroglia, coraz�n del Yunque",clan:"DarkAngels",from:75,to:80,min:75,max:95},{realm:"Earand",name:"Ghotiamir",path:"r",from:0,to:95,min:0,max:95},{realm:"Earand",name:"La Ciudad de Velas",path:"r3s7wn",from:45,to:55,min:0,max:95},{realm:"Earand",name:"La Fortaleza de Lord Krothgar",path:"r3s5e3n",from:35,to:60,min:0,max:95},{realm:"Earand",name:"La Fortaleza Enana",path:"r3s5el2nj",clan:"El Santuario",from:35,to:65,min:0,max:95},{realm:"Earand",name:"La Guarida de Kotegaesi",path:"r3s7w6n2wslsk",from:30,to:45,min:0,max:95},{realm:"Earand",name:"La tumba de Damara",path:"r3s5w3n",clan:"Shinsent",from:15,to:25,min:0,max:95},{realm:"Earand",name:"Las Ruinas de los Antiguos",from:78,to:80,min:77,max:95},{realm:"Earand",name:"Observatorio del Ojo Celeste",path:"r3s3e2s",clan:"Cantico",from:25,to:65,min:0,max:95},{realm:"Earand",name:"Valle de Rivendel",path:"r3s7w11ne2n2e2n",from:60,to:80,min:0,max:95},{realm:"Earand",name:"Villa Enana",path:"r3s5el",from:10,to:35,min:0,max:95},{realm:"Niruk",name:"La casa de Anarion",from:75,to:80,min:75,max:95},{realm:"Niruk",name:"Las Tierras Desoladas",clan:"DarkAngels",from:10,to:80,min:0,max:95},{realm:"Niruk",name:"Residencia de Inmortales",from:81,to:95,min:0,max:95},{realm:"Niruk",name:"Tiempo de L'Hopital",from:75,to:80,min:75,max:95},{realm:"Valmorag",name:"Bosque de los Muertos",path:"r3s5e2n2e2ses2en",from:20,to:40,min:0,max:95},{realm:"Valmorag",name:"Dhusebark",path:"r",from:0,to:95,min:0,max:95},{realm:"Valmorag",name:"El Devorador de Mundos",path:"r3s5e2n2e2ses2e3n2wkwnwhne6nunj",from:30,to:50,min:0,max:95},{realm:"Valmorag",name:"El Legado de Xchantharus",path:"r3s5e2n2e3swse3sd9sh",clan:"El Santuario",from:30,to:50,min:0,max:95},{realm:"Valmorag",name:"El Mausoleo del Minotauro",path:"r3s5e2n2en",from:40,to:65,min:0,max:95},{realm:"Valmorag",name:"Guarida de Gigantes de Fuego",path:"r3s5wh2w",from:40,to:50,min:0,max:95},{realm:"Valmorag",name:"Infierno",path:"r4sd",from:30,to:80,min:0,max:95},{realm:"Valmorag",name:"La Ciudad Maldita",path:"r9sk3esek",clan:"Sindicato",from:40,to:80,min:0,max:95},{realm:"Valmorag",name:"La Fortaleza de Lilith",path:"r9sk2w3usw",clan:"Torre Arcana",from:65,to:80,min:55,max:95},{realm:"Valmorag",name:"La Fortaleza de Mahn-Tor",path:"r3s5e2n2e",from:5,to:35,min:0,max:95},{realm:"Valmorag",name:"La Gran Torre de la Hechiceria",path:"r3s5e2nj",from:10,to:30,min:0,max:95},{realm:"Valmorag",name:"La Maldicion del Nigromante",path:"r3s5e2n2e2s2e",clan:"Cantico",from:30,to:55,min:0,max:95},{realm:"Valmorag",name:"La Residencia de Redferne",path:"r9sk2w",from:20,to:30,min:0,max:95},{realm:"Valmorag",name:"Los Pozos de la Reina Aranya",from:40,to:55,min:0,max:95},{realm:"Valmorag",name:"Los Usurpadores de Hochenyana",path:"r3s6ele",clan:"Shinsent",from:20,to:35,min:0,max:95},{realm:"Valmorag",name:"Profundidades Umbrias",path:"r3s5e2n2e3swse3sd9sd",from:20,to:50,min:0,max:95},{realm:"Valmorag",name:"Puerto Libre",path:"r9ske",from:10,to:55,min:0,max:95},{realm:"Valmorag",name:"Valle de Morgul",path:"r9sk2w3us",clan:"Shinsent",from:30,to:55,min:0,max:95}]},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.kill=void 0;const t=a(10),o=a(8),r=a(0),i=a(6);n.kill=async function({when:e,write:n,plugins:{prompt:a,navigation:s,skills:l}},c){const{dedope:u}=o.SPELLS_BY_TYPE,d=c.startsWith("!");d&&(c=c.substr(1)),await async function e(n,a){switch(await l.castSpell(n,a)){case l.CASTED:case l.ALREADY_APPLIED:return!0;case l.NOT_AVAILABLE:return!1;case l.BUSY:await i.wait(3);case l.FAILED:return e(n,a)}throw new Error("WTF DUDE")}(u,c)||n("matar "+c),e(t.ATTACK_RECEIVED,async({groups:e})=>{const n=e.mob,a=t.getMobIn(n),r=a?a.name:n||c,i=d?o.SPELLS_BY_TYPE.attack:[...o.SPELLS_BY_TYPE.massAttack,...o.SPELLS_BY_TYPE.attack];await l.castSpell(i,r)});const m=await Promise.any([s.waitForRecall().then(()=>"flee"),e(r.concatRegexes(c,/(?:\w|�| )* (ha)|(cae al suelo) MUERTO!!/i)).then(()=>"win"),e("No esta aqui.").timeout(3).then(()=>"missing"),e(["Huyes como un cobarde del combate.","Estas demasiado malherido para hacer eso.","Estas demasiado aturdido para hacer eso."]).then(()=>"flee")]);return"win"===m&&async function(a){n("sacrificar cuerpo"),await e("te da una moneda de oro por tu sacrificio.")}(),m}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.recover=void 0;const t=a(6),o=a(8);n.recover=async function({run:e,plugins:{skills:n,prompt:a}}){const r=o.SPELLS_BY_TYPE.heal,i="refrescar",s="invisibilidad",l=await n.can(r),c=await n.can(i),u=await n.can("meditar"),d=await n.can(s),m=()=>a.getPercent("mana"),p=()=>a.getPercent("hp")<1,h=()=>m()<.8,f=()=>a.getPercent("mv")<1,g=()=>u?m()>.5:m()>.1;for(;l&&p()||u&&h()||c&&f();){for(d&&!a.isInvisible&&await e("cast",[s]);l&&p()&&g();)await e("cast",[r]);for(;c&&f()&&g();)await e("cast",[i]);for(;u&&h();){await n.meditate()===n.BUSY&&await t.wait(2)}}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.train=void 0;const t=a(22),o=a(10);n.train=async function({log:e,run:n,when:a,write:r,plugins:{navigation:i,prompt:s,stats:l}},c){if("test"===c){const e=await f();return void console.log(e.name,e)}const u=await async function(e){const n=e?t.getAreaMetadata(e):await f();if(!n)throw new Error(`NO AREA "${e}"`);if(!n.arena)throw new Error(`"${n.name}" training path is unknown`);const a=n.path.split(""),o=a.pop(),r=Array.isArray(n.arena)?n.arena.join(""):n.arena;return{path:a.join(""),arena:`${o}${r}`}}(c),d=[];a(o.getMobsPresence(),({patterns:e,fullMatch:n,captured:a})=>p(o.getMobFromPresence(e)||o.getMobIn(n||a[0]))),a(o.MOB_ARRIVES,({groups:e})=>p(o.getMobIn(e.mob))),a(o.MOB_LEAVES,e=>{const{mob:n}=e.groups;n&&function(e=null){if(e){const n=d.indexOf(e);n>-1&&d.splice(n,1)}}(o.getMobIn(e.groups.mob))});const m=`${u.path}${u.arena}`;return r("visible"),r("huida"),await i.execute(m,(async function(){e("ENTER_ROOM"),await s.until(({mv:{current:e}})=>e>50);for(;d.length;){if(await h())return!1;const t=n("recover");await Promise.any([t,a(o.MOB_ARRIVES).then(()=>t.abort())]),e("READY_TO_FIGHT!!!")}})),i.recall();function p(e=null){e&&d.push(e)}async function h(){for(e("CHECK_ENEMIES",d.length);d.length;){const a=await n("kill",[d.pop().name]);if("flee"===a)return console.log("Had to run. Train over."),await i.recall(),!0;e("Fight result: "+a)}}async function f(){const[e,n]=await Promise.all([i.getRealm(),l.getLevel()]),a=t.getAreasForLevel(e,n),[o,...r]=a.filter(e=>e.arena);return r.length&&console.warn("Multiple arenas available"),console.log("Selected",o.name),o}}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.wear=void 0;const t=a(11),o=a(0);n.wear=async function({run:e,when:n,write:a},...r){const i=r.length?r:t.ITEM_SUSTANTIVES;for(const e of i)for(let n=0;n<5&&!await s(e);n++);async function s(r){a(`coger "${r}"`);if(!await Promise.any([n(`No hay ningun ${r} aqui.`).wait(8).then(()=>!1),n(o.concatRegexes(/Coges/,t.ITEM_ARTICLE,/(?: (?:\\w|�)+)* /i,r)).then(()=>!0)]))throw new Error(`Couldn't pick up "${r}"`);let i=!1;const s=n(" es un(a) armadura_metalica,",()=>i=!0),c=await e("cast",["identificar",r]);if(s.unsubscribe(),!c)throw new Error(`Couldn't identifiy "${r}"`);if(i)return await l(r),!1;a(`vestir "${r}"`);const u=await Promise.any([n(t.WEAR).then(()=>!0),n(t.UNWEAR).then(({groups:e})=>e.item),n([/Debes ser nivel \w+ para usar este objeto./,"No puedes vestir eso, necesita repararse."]).then(()=>!1)]);if(!1===u)return await l(r),!1;if("string"==typeof u){const o=t.getItemSustantive(u);o&&(await e("cast",["identificar",o]),a(`poner ${o} mochila`),await n("Pones "))}return!0}function l(e){return a(`tirar "${e}"`),n("Tiras ")}}},function(e,n,a){"use strict";var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.renderUserInterface=void 0;const o=a(5);a(67);const r=a(68),i=a(71),s=t(a(74)),l=a(9),c=a(75),u=a(78);n.renderUserInterface=function(e){const n=function(){const e=new o.ClientStorage("ui:state");e.get()||e.set({showControls:!1});return e}(),a=n.get(),t=l.render(s.default),d=t.$(".container"),m=new c.Sidebar;m.render(d);const p=new r.Controls;p.render(d);const h=new u.Terminal;h.render(d),e.appendChild(t);const f=new i.Hamburger(a.showControls);return f.render(e),f.onChange(g),g(a.showControls),{controls:p,sidebar:m,terminal:h};function g(e){e?(d.classList.add("show-controls"),a.showControls=!0):(d.classList.remove("show-controls"),a.showControls=!1),n.set(a)}}},function(e,n,a){"use strict";a.r(n);var t=a(1),o=a.n(t),r=a(12),i={insert:"head",singleton:!1};o()(r.a,i);n.default=r.a.locals||{}},function(e,n,a){"use strict";var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Controls=void 0,a(69);const o=a(9),r=t(a(70));n.Controls=class{constructor(){this.dom=o.render(r.default),this.meterTpl=this.dom.$(".meter-template"),this.buttonTpl=this.dom.$(".button-template")}render(e){e.appendChild(this.dom)}addMeter(e,n){const a=o.render(this.meterTpl,{".meter":a=>{a.style.setProperty("--color",e),a.style.setProperty("--value","100%"),n(e=>{const n=Math.round(100*e);a.style.setProperty("--value",n+"%")})}});this.dom.appendChild(a)}addButton(e,n){const a=o.render(this.buttonTpl,{button:a=>{a.textContent=e,a.addEventListener("click",n)}});this.dom.appendChild(a)}}},function(e,n,a){"use strict";a.r(n);var t=a(1),o=a.n(t),r=a(13),i={insert:"head",singleton:!1};o()(r.a,i);n.default=r.a.locals||{}},function(e,n){e.exports='<header class="controls"></header> <template class="meter-template"> <div class="meter" data-color="white" data-value="100%"> <div class="bar"></div> </div> </template> <template class="button-template"> <button class="ui-button"></button> </template> '},function(e,n,a){"use strict";var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Hamburger=void 0,a(72);const o=a(4),r=a(9),i=t(a(73));n.Hamburger=class{constructor(e=!1){this.dom=r.render(i.default),this.checkbox=this.dom.$("input"),this.emitChange=o.emitter(),this.onChange=this.emitChange.subscribe,this.toggle=this.toggle.bind(this),this.checkbox.checked=e}render(e){this.checkbox.addEventListener("change",this.toggle),e.appendChild(this.dom),this.checkbox.checked&&this.toggle()}toggle(){this.emitChange(this.checkbox.checked)}}},function(e,n,a){"use strict";a.r(n);var t=a(1),o=a.n(t),r=a(14),i={insert:"head",singleton:!1};o()(r.a,i);n.default=r.a.locals||{}},function(e,n){e.exports='<div class="hamburger"> <input type="checkbox"/> <span></span> <span></span> <span></span> </div> '},function(e,n){e.exports='<div class="container"></div> '},function(e,n,a){"use strict";var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Sidebar=void 0,a(76);const o=a(9),r=t(a(77));n.Sidebar=class{constructor(){this.dom=o.render(r.default),this.workflowTpl=this.dom.$(".workflow-template"),this.workflows=this.dom.$(".workflow-list")}render(e){e.appendChild(this.dom)}setWorkflows(e,n,a,t){this.workflows.innerHTML="";for(const r of e){const e=o.render(this.workflowTpl,{".name":e=>e.textContent=r.name,".workflow":e=>e.classList.toggle("running",n(r)),".triggers":e=>e.textContent="To be implemented...",".expand":n=>{n.addEventListener("click",()=>e.$(".workflow").classList.toggle("expanded"))},".runner":e=>{n(r)?(e.textContent=`stop (${r.instancesRunning})`,e.addEventListener("click",()=>t(r))):(e.textContent="run",e.addEventListener("click",()=>a(r)))}});this.workflows.appendChild(e)}}}},function(e,n,a){"use strict";a.r(n);var t=a(1),o=a.n(t),r=a(15),i={insert:"head",singleton:!1};o()(r.a,i);n.default=r.a.locals||{}},function(e,n){e.exports='<aside class="sidebar"> <h1>Workflows</h1> <ul class="workflow-list"></ul> </aside> <template class="workflow-template"> <li class="workflow"> <header> <i class="expand">V</i> <h3 class="name"></h3> <button class="runner"></button> </header> <ul class="triggers"></ul> </li> </template> '},function(e,n,a){"use strict";var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Terminal=void 0;const o=a(5);a(79);const r=t(a(80)),i=a(4),s=a(9),l=t(a(87)),c=new r.default,u=new o.ClientStorage("mud:command-history");function d(e){const n=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/  +/g,e=>"&nbsp;".repeat(e.length));return c.toHtml(n).replace(/\n/g,"<br>")}n.Terminal=class{constructor(){this.dom=s.render(l.default),this.$log=this.dom.$(".log"),this.$input=this.dom.$("input"),this.log=[],this.history=u.get()||[],this.histPos=0,this.emitSubmit=i.emitter(),this.onSubmit=this.emitSubmit.subscribe,this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this)}focus(){this.$input.focus()}render(e){this.dom.$(".terminal").addEventListener("click",()=>setTimeout(()=>!function(){const e=getSelection();return e&&"Range"===e.type}()&&this.$input.focus(),80)),this.$input.addEventListener("keydown",this.onKeyDown),this.$input.addEventListener("keyup",this.onKeyUp),e.appendChild(this.dom)}write(e){const n=this.$log.parentElement,a=`${this.log.length?this.log.pop():""}${t=e,t.replace(/\r/g,"")}`.split(/\n\n+/);var t;const o=a.pop();for(const e of a){this.log.push(e);const a=document.createElement("p");a.innerHTML=d(e),n.insertBefore(a,this.$log)}this.log.push(o),this.$log.innerHTML=d(o),this.autoScroll(n)}autoScroll(e){const{scrollTop:n,scrollHeight:a,clientHeight:t}=e;a-(n+t)<t/2&&(e.scrollTop=a)}onKeyDown(e){"Enter"===e.code&&this.submit(),"ArrowUp"===e.code&&this.loadHistory(1),"ArrowDown"===e.code&&this.loadHistory(-1),this.onKeyUp(e)}onKeyUp(e){this.$input.size=this.$input.value.length+3}submit(){const{value:e}=this.$input;this.$input.value="",this.histPos=0,e&&(this.history.shift(),this.history.unshift(e),this.history.unshift(""),u.set(this.history));for(const n of e.split(/;/))this.emitSubmit(n)}loadHistory(e){var n,a,t;this.history.length&&(this.history[this.histPos]=this.$input.value,this.histPos=(n=this.histPos+e,a=0,t=this.history.length-1,n<a?a:n>t?t:n),this.$input.value=this.history[this.histPos])}}},function(e,n,a){"use strict";a.r(n);var t=a(1),o=a.n(t),r=a(16),i={insert:"head",singleton:!1};o()(r.a,i);n.default=r.a.locals||{}},,,,,,,,function(e,n){e.exports='<main class="terminal"> <span class="log"></span> <input type="text" size="1" autofocus> </main>'},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getPassword=void 0;const t=a(5);n.getPassword=function(e){const n=new t.ClientStorage("pass:"+e),a=n.get();if(a)return a;const o=prompt("Password for "+e);if(!o)throw new Error("Password required");return n.set(o),o}},function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getQueryParams=void 0,n.getQueryParams=function(){const e={};return window.location.search.substr(1).split("&").map(e=>e.split("=").map(decodeURIComponent)).forEach(([n,a])=>e[n]=a),e}},function(e){e.exports=JSON.parse('{"DEFAULT_PORT":53472}')}]);
//# sourceMappingURL=main.js.map